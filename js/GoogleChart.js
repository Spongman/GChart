"use strict";var Events,MouseEvents,KeyboardEvents,TimerEvents,IOErrorEvents,SecurityErrorEvents,com,flash,mx,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function __(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}();function addGetter(t,e,i){Object.defineProperty(t.prototype,e,{get:i,enumerable:!0,configurable:!0})}function cssColor(t,e){void 0===e&&(e=1);var i=Math.floor(t).toString(16);if(e>=1)return"#"+"000000".substr(i.length)+i;var n=Math.floor(255*e).toString(16);return"#"+"00".substr(n.length)+"000000".substr(i.length)+i}function assert(t){}function getDefinitionByName(t){for(var e=window,i=0,n=t.split(".");i<n.length;i++){e=e[n[i]]}return e}function getClassName(t){return t.constructor.name}function getTimer(){return Date.now()}function notnull(t){if(!t)throw new Error;return t}function parseQueryString(t){for(var e={},i=0,n=t.split("&");i<n.length;i++){var a=n[i].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}function offsetOf(t){var e=0,i=0;do{e+=t.offsetLeft,i+=t.offsetTop,t=t.offsetParent}while(t);return{left:e,top:i}}addGetter(Date,"dateUTC",Date.prototype.getUTCDate),addGetter(Date,"monthUTC",Date.prototype.getUTCMonth),addGetter(Date,"fullYearUTC",Date.prototype.getUTCFullYear),addGetter(Date,"date",Date.prototype.getDate),addGetter(Date,"month",Date.prototype.getMonth),addGetter(Date,"fullYear",Date.prototype.getFullYear),function(t){t.COMPLETE="complete",t.RESIZE="resize"}(Events||(Events={})),function(t){t.CLICK="click",t.MOUSE_DOWN="mousedown",t.MOUSE_MOVE="mousemove",t.MOUSE_OUT="mouseout",t.MOUSE_OVER="mouseover",t.MOUSE_UP="mouseup",t.ROLL_OUT="rollout",t.ROLL_OVER="rollover",t.MOUSE_WHEEL="wheel",t.MOUSE_LEAVE="mouseleave"}(MouseEvents||(MouseEvents={})),function(t){t.KEY_DOWN="keydown",t.KEY_UP="keyup"}(KeyboardEvents||(KeyboardEvents={})),function(t){t.TIMER="timer"}(TimerEvents||(TimerEvents={})),function(t){t.IO_ERROR="io-error"}(IOErrorEvents||(IOErrorEvents={})),function(t){t.SECURITY_ERROR="security-error"}(SecurityErrorEvents||(SecurityErrorEvents={})),function(t){!function(t){var e=function(){function DisplayObject(t,e){this.element=t,this._x=0,this._y=0,assert(!t.displayObject),t.displayObject=this,assert(!!t),t.parentElement||(t.classList.add("pending"),document.body.appendChild(t)),this.name=(e?e+":":"")+getClassName(this),t.setAttribute("name",this.name)}return Object.defineProperty(DisplayObject.prototype,"graphics",{get:function(){return this._graphics||(this._graphics=new t.Graphics(this.element))},enumerable:!0,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"stage",{get:function(){return this._stage},set:function(t){this._stage=t},enumerable:!0,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this.element.style.left=t+"px"},enumerable:!0,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this.element.style.top=t+"px"},enumerable:!0,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"width",{get:function(){return this.element.offsetWidth},enumerable:!0,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"height",{get:function(){return this.element.offsetHeight},enumerable:!0,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"visible",{get:function(){return"hidden"!==this.element.style.visibility},set:function(t){this.element.style.visibility=t?"":"hidden"},enumerable:!0,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"mouseX",{get:function(){return this._x+this.parent.mouseX},enumerable:!0,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"mouseY",{get:function(){return this._y+this.parent.mouseY},enumerable:!0,configurable:!0}),DisplayObject.prototype.addEventListener=function(t,e){this.element.addEventListener(t,e)},DisplayObject.prototype.removeEventListener=function(t,e,i){this.element.removeEventListener(t,e)},DisplayObject.prototype.hitTestPoint=function(e,i,n){void 0===n&&(n=!1);var a=this.globalToLocal(new t.Point(e,i));return a.x>=0&&a.x<this.width&&a.y>=0&&a.y<this.height},DisplayObject.prototype.globalToLocal=function(t){var e=this;do{t.x-=e._x,t.y-=e._y,e=e.parent}while(e);return t},DisplayObject}();t.DisplayObject=e;var i=function(t){function Shape(){return null!==t&&t.apply(this,arguments)||this}return __extends(Shape,t),Shape}(e);t.Shape=i}(t.display||(t.display={}))}(flash||(flash={})),function(t){!function(t){var e=function(t){function InteractiveObject(e,i){var n=t.call(this,e,i)||this;return n.element=e,e.classList.add("mouseEnabled"),n}return __extends(InteractiveObject,t),Object.defineProperty(InteractiveObject.prototype,"mouseEnabled",{get:function(){return this.element.classList.contains("mouseEnabled")},set:function(t){this.element.classList.toggle("mouseEnabled",t)},enumerable:!0,configurable:!0}),InteractiveObject}(t.DisplayObject);t.InteractiveObject=e}(t.display||(t.display={}))}(flash||(flash={})),function(t){!function(t){var e=function(t){function DisplayObjectContainer(){var e=null!==t&&t.apply(this,arguments)||this;return e.children=[],e}return __extends(DisplayObjectContainer,t),Object.defineProperty(DisplayObjectContainer.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0}),Object.defineProperty(DisplayObjectContainer.prototype,"stage",{get:function(){return this._stage},set:function(t){if(this._stage!==t){this._stage=t;for(var e=0,i=this.children;e<i.length;e++){i[e].stage=t}}},enumerable:!0,configurable:!0}),DisplayObjectContainer.prototype.prepareChild=function(t){assert(t&&!!t.element),t.parent&&t.parent.removeChild(t);var e=t.element;e.parentElement&&(assert(e.parentElement===document.body),e.remove(),e.classList.remove("pending")),t.parent=this,t.stage=this.stage},DisplayObjectContainer.prototype.addChild=function(t){return assert(!!this.element),this.prepareChild(t),this.children.push(t),this.element.appendChild(t.element),t},DisplayObjectContainer.prototype.addChildAt=function(t,e){assert(!!this.element),this.prepareChild(t);var i=this.children[e];return this.children.splice(e,0,t),this.element.insertBefore(t.element,i&&i.element)},DisplayObjectContainer.prototype.removeChild=function(t){this.removeChildAt(this.getChildIndex(t))},DisplayObjectContainer.prototype.removeChildAt=function(t){var e=this.getChildAt(t);e.element.remove(),this.children.splice(t,1),delete e.parent,delete e.stage},DisplayObjectContainer.prototype.getChildAt=function(t){return assert(t>=0&&t<this.children.length),this.children[t]},DisplayObjectContainer.prototype.getChildIndex=function(t){return assert(t&&t.parent===this),this.children.indexOf(t)},DisplayObjectContainer.prototype.swapChildrenAt=function(t,e){assert(t>=0&&t<this.children.length),assert(e>=0&&e<this.children.length);var i=this.children[t],n=this.children[e];this.children[t]=n,this.children[e]=i},DisplayObjectContainer.prototype.contains=function(t){return t.parent===this},Object.defineProperty(DisplayObjectContainer.prototype,"width",{get:function(){if(null!=this._width)return this._width;for(var t=0,e=0,i=this.children;e<i.length;e++){var n=i[e];if(!n.element.classList.contains("pending")){var a=n.x+n.width;t<a&&(t=a)}}return this._graphics&&t<this._graphics.width&&(t=this._graphics.width),t},set:function(t){this._width=t,this.element.style.width=t+"px"},enumerable:!0,configurable:!0}),Object.defineProperty(DisplayObjectContainer.prototype,"height",{get:function(){if(null!=this._height)return this._height;for(var t=0,e=0,i=this.children;e<i.length;e++){var n=i[e];if(!n.element.classList.contains("pending")){var a=n.y+n.height;t<a&&(t=a)}}return this._graphics&&t<this._graphics.height&&(t=this._graphics.height),t},set:function(t){this._height=t,this.element.style.height=t+"px"},enumerable:!0,configurable:!0}),DisplayObjectContainer}(t.InteractiveObject);t.DisplayObjectContainer=e}(t.display||(t.display={}))}(flash||(flash={})),function(t){!function(t){var e=function(){return function Point(t,e){this.x=t,this.y=e}}();t.Point=e;var i=function(){return function Rectangle(){}}();t.Rectangle=i;var n=function(t){function Sprite(e){return t.call(this,document.createElement("div"),e)||this}return __extends(Sprite,t),Sprite}(t.DisplayObjectContainer);t.Sprite=n}(t.display||(t.display={}))}(flash||(flash={})),function(t){!function(t){!function(t){var e=function(e){function AbstractLayer(t,i){var n=e.call(this)||this;return n.viewPoint=t,n.dataSource=i,n}return __extends(AbstractLayer,e),AbstractLayer.drawVerticalLine=function(e,i,n,a,r,o,s,l,h){void 0===h&&(h=!0),i=Math.floor(i)+.5;var c=e.graphics;switch(c.moveTo(i,r+1),l){case t.TickPositions.BOTTOM:c.lineStyle(0,n,a),c.lineTo(i,o-s),c.lineStyle(0,t.Const.BOTTOM_TICK_COLOR,1),c.lineTo(i,o);break;case t.TickPositions.TOP:c.lineStyle(0,t.Const.TOP_TICK_COLOR,1),c.lineTo(i,r+1+s),h&&(c.lineStyle(0,n,a),c.lineTo(i,o))}},AbstractLayer.prototype.renderLayer=function(t){},AbstractLayer.prototype.getDataSeries=function(t){return this.dataSource.data},AbstractLayer}(flash.display.Sprite);t.AbstractLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function AbstractDrawingLayer(){return null!==e&&e.apply(this,arguments)||this}return __extends(AbstractDrawingLayer,e),AbstractDrawingLayer.prototype.getContext=function(t,e){return void 0===e&&(e=!1),t},AbstractDrawingLayer.prototype.getBarWidth=function(e,i){var n=0;if(n=e===t.Intervals.WEEKLY?5*i.marketDayLength:e===t.Intervals.DAILY?i.marketDayLength:t.Const.getDetailLevelInterval(e)/60,0===this.viewPoint.count)return 0;var a=t.Const.BAR_WIDTH_RATIO*n*this.viewPoint.minutePix;return a%2==1&&a--,a},AbstractDrawingLayer.prototype.clearHighlight=function(){},AbstractDrawingLayer.prototype.getWeeklyBarXPos=function(t,e){var i=this.viewPoint.getXPos(t),n=this.dataSource.data.marketDayLength,a=this.viewPoint.minutePix*n*4;return e<i+a&&(i=e-a),t.weeklyXPos=i,i},AbstractDrawingLayer.prototype.getOldestMinute=function(){var t=this.getDataSeries();return t?t.getFirstRelativeMinute():0},AbstractDrawingLayer.prototype.getLastRealPointIndex=function(e){return Boolean(t.MainManager.paramsObj.hasExtendedHours)&&0!==e[e.length-1].relativeMinutes?e.length-1:t.Utils.getLastRealPointIndex(e)},AbstractDrawingLayer.prototype.highlightPoint=function(t,e,i){},AbstractDrawingLayer.prototype.getNewestMinute=function(){var t=this.getDataSeries();return t?t.getLastRelativeMinute():0},AbstractDrawingLayer}(t.AbstractLayer);t.AbstractDrawingLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function LineChartLayer(t,i){var n=e.call(this,t,i)||this;return n.localYOffset=0,n.localYScale=0,n.highlightCanvas=new flash.display.Sprite("highlightCanvas"),n.addChild(n.highlightCanvas),n}return __extends(LineChartLayer,e),LineChartLayer.prototype.drawWeeklyLine=function(t,e,i,n,a){for(var r=n.getSkipInterval(),o=this.getDataSeries(),s=o.getNextDayStart(i),l=o.fridays.length-1;o.fridays[l]>o.days[s];)l--;l+=(o.fridays.length-1-l)%r.skip,l=Math.min(l,o.fridays.length-1);for(var h=null;l>=0&&o.fridays[l]>=e;)h=o.units[o.fridays[l]],this.drawLineToDataUnit(n,t,a,h),l-=r.skip;return h?Number(n.getXPos(h)):-1},LineChartLayer.prototype.getAvg_=function(e,i,n,a){var r=0,o=0,s=0,l=e-i,h=n.getRelativeMinuteIndex(l-Math.floor(i/3)),c=n.getRelativeMinuteIndex(e+Math.floor(i/3));c-h<=0&&(c=h+1),this.realLIndex=n.getRelativeMinuteIndex(l)+1,this.realRIndex=n.getRelativeMinuteIndex(e);var u=this.viewPoint;u.getXPos(n.units[this.realLIndex])>this.viewPoint.maxx&&this.realLIndex--,u.getXPos(n.units[this.realRIndex])<this.viewPoint.minx&&this.realRIndex++;var d=n.getNextDayStart(c),g=u.getDetailLevel(i,e);t:switch(g){case t.Intervals.INTRADAY:for(r=n.days[d];;){if(r<h)break t;var p=this.getDayAvg(r,h,c,e,i,n,a);o=Number(o+p.sum),s+=p.cnt;var v=n.getPrevDayStart(r);if(-1===v)break t;r=n.days[v]}case t.Intervals.DAILY:case t.Intervals.WEEKLY:r=d;var y=i/n.marketDayLength,f=Math.floor(y/80);for(f<=0&&(f=1);n.days[r]>=h&&r>=0;){o=Number(o+n.units[n.days[r]].getCloseLogValue(a));for(var T=0;T<f;T++){var I=r-T;if(I<0)break;n.days[I]>=this.realLIndex&&n.days[I]<=this.realRIndex&&this.checkMinMax(n.units[n.days[I]].getCloseLogValue(a))}s++,r-=f}}return o/s},LineChartLayer.prototype.getDayAvg=function(e,i,n,a,r,o,s){var l=this.viewPoint,h=o.units,c={cnt:0,sum:0},u=o.marketDayLength*(l.maxx-l.minx)/r;if(e>0&&h[e-1].dayMinute===o.marketCloseMinute){var d=h[e].getCloseLogValue(s);return e>=this.realLIndex&&e<=this.realRIndex&&this.checkMinMax(d),{sum:d,cnt:1}}for(var g=1,p=o.marketDayLength/(t.Const.INTRADAY_INTERVAL/60),v=u/p;v*g<l.POINTS_DISTANCE;)g*=2;for(var y=e-p+1;e>y&&e>i;){if(e<y&&(e=i),e>i&&e<n){d=h[e].getCloseLogValue(s);e>=this.realLIndex-1&&e<=this.realRIndex+1&&(d<this.minPrice?this.minPrice=d:d>this.maxPrice&&(this.maxPrice=d)),c.sum+=d,c.cnt++}e-=g}return c},LineChartLayer.prototype.computeMaxRange2=function(t,e,i,n){return void 0===n&&(n=!1),this.computeMaximizedMaxRange(t,e)},LineChartLayer.prototype.normalizeMedPrice=function(t,e){if(0!==t.medPrice){if(t.maxPrice-t.medPrice>e/2)return(t.maxPrice+t.minPrice)/2;if(t.medPrice-t.minPrice>e/2)return(t.maxPrice+t.minPrice)/2;if(t.medPrice<e/2)return e/2}return t.medPrice},LineChartLayer.prototype.getPrevOrNextClosestToX=function(t,e,i,n,a){if(i>=a){var r=this.viewPoint.getMinuteXPos(t[e[i-a]].relativeMinutes),o=this.viewPoint.getMinuteXPos(t[e[i]].relativeMinutes);if(Math.abs(r-n)<Math.abs(o-n))return e[i-1]}return e[i]},LineChartLayer.prototype.drawDayLine=function(e,i,n,a,r,o){var s=this.getDataSeries(),l=s.units,h=t.Const.INTRADAY_INTERVAL/60,c=Math.floor(s.marketDayLength/h);if(l[i].dayMinute!==s.marketCloseMinute)return-1;if(0===i)return 0;var u=e.graphics;if(l[i-1].dayMinute===s.marketCloseMinute){var d=n.getXPos(l[i-1]);return u.lineTo(d,this.getYPos(o,l[i-1])),d}for(var g=1;n.minutePix*h*g<n.POINTS_DISTANCE;)g*=2;var p=s.getSessionIndex(l[i].dayMinute),v=i-c-Math.max(p,0),y=i;if(0===l[y].relativeMinutes&&l[y].fake){for(;l[y].fake;)y--;var f=new flash.display.Point(n.getXPos(l[y]),this.viewPoint.maxy);u.lineStyle(0,0,0),u.moveTo(f.x,f.y),u.lineTo(f.x,this.getYPos(o,l[i])),u.lineStyle(this.lineThickness,this.lineColor,this.lineVisibility)}for(;i>y;)i-=g;for(;i>r&&i>a;)i-=g;for(var T=n.getXPos(l[i]),I=g*(n.minutePix*h),L=g*h,m=l[i].relativeMinutes;i>=v&&i>=a;)u.lineTo(T,this.getYPos(o,l[i])),(i-=g)>v&&i>a&&m-l[i-1].relativeMinutes===L&&i--,i>=v&&i>=a&&(m=l[i].relativeMinutes),T-=I;var M=n.getXPos(l[v]),C=this.getYPos(o,l[v]);return u.lineTo(M,C),M},LineChartLayer.prototype.highlightPoint=function(e,i,n){n[t.SpaceText.SETTER_STR]&&n[t.SpaceText.SETTER_STR].clearHighlight();var a=this.getDataSeries(),r=this.getPoint(a,i),o=this.viewPoint.getMinuteXPos(r.relativeMinutes),s=this.getYPos(e,r);if(this.lastHighlightX!==o||this.lastHighlightY!==s){this.clearHighlight();var l=this.highlightCanvas.graphics;l.lineStyle(5,t.Const.DOT_COLOR,1),l.moveTo(o,s-.2),l.lineTo(o,s+.2),n[t.SpaceText.POINT_STR]=r,n[t.SpaceText.EXTRA_TEXT_STR]="",n[t.SpaceText.SETTER_STR]=this,this.lastHighlightX=o,this.lastHighlightY=s}},LineChartLayer.prototype.getMediumPrice=function(t,e,i,n){var a=i.getRelativeMinuteIndex(t),r=i.units[a].getCloseLogValue(n);return this.minPrice=r,this.maxPrice=r,{medPrice:Number(this.getAvg_(t,e,i,n)),minPrice:this.minPrice,maxPrice:this.maxPrice}},LineChartLayer.prototype.drawLine=function(e,i,n,a,r){var o=this.getDataSeries(),s=o.units,l=e.graphics;l.lineStyle(this.lineThickness,this.lineColor,this.lineVisibility);for(var h=o.getNextDayStart(n),c=1,u=a.minutePix*o.marketDayLength;u*c<a.POINTS_DISTANCE;)c++;var d=s[o.days[h]],g=a.getXPos(d)+1,p=this.getYPos(r,d);switch(l.moveTo(g,this.viewPoint.maxy),l.lineStyle(0,0,0),l.lineTo(g,p),l.lineStyle(this.lineThickness,this.lineColor,this.lineVisibility),a.getDetailLevel()){case t.Intervals.INTRADAY:for(;h>=0&&o.days[h]>=i;)l.lineStyle(0,0,0),d=s[o.days[h]],l.lineTo(g,a.maxy),l.lineTo(a.getXPos(d),a.maxy),this.drawLineToDataUnit(a,e,r,d),l.lineStyle(this.lineThickness,this.lineColor,this.lineVisibility),g=this.drawDayLine(e,o.days[h],a,i,n,r),h--;return d=s[i],a.getXPos(d);case t.Intervals.DAILY:for(;h>=0&&o.days[h]>=i;)d=s[o.days[h]],this.drawLineToDataUnit(a,e,r,d),h--;return a.getXPos(d);case t.Intervals.WEEKLY:return this.drawWeeklyLine(e,i,n,a,r);default:return-1}},LineChartLayer.prototype.getYPos=function(t,e){return this.localYOffset-(e.getCloseLogValue(t.verticalScaling)-t.medPrice)*this.localYScale},LineChartLayer.prototype.checkMinMax=function(t){t<this.minPrice?this.minPrice=t:t>this.maxPrice&&(this.maxPrice=t)},LineChartLayer.prototype.renderLayer=function(e){var i=this.viewPoint,n=this.getDataSeries();if(0!==n.points.length){var a=this.graphics;a.clear();var r=n.getRelativeMinuteIndex(i.getLastMinute());r<n.points.length-1&&r++;var o=n.getRelativeMinuteIndex(i.getFirstMinute())-1;o<0&&(o=0),this.lineThickness=t.Const.LINE_CHART_LINE_THICKNESS,this.lineColor=t.Const.LINE_CHART_LINE_COLOR,this.lineVisibility=t.Const.LINE_CHART_LINE_VISIBILITY,a.beginFill(t.Const.LINE_CHART_FILL_COLOR,t.Const.LINE_CHART_FILL_VISIBILITY),this.localYOffset=i.miny+i.medPriceY+i.V_OFFSET,this.localYScale=i.maxPriceRangeViewSize/e.maxPriceRange;var s=this.drawLine(this,o,r,i,e);a.lineStyle(0,0,0);var l=new flash.display.Point(s,i.maxy);a.lineTo(l.x,l.y),a.endFill()}},LineChartLayer.prototype.getPointIndex=function(e,i){for(var n=this.viewPoint.getMinuteOfX(i),a=e.getRelativeMinuteIndex(n);e.units[a].fake&&a>0;)a--;var r=this.viewPoint.getSkipInterval(),o=r.skip,s=r.interval;if(s<t.Const.DAILY_INTERVAL){var l=e.getNextDayStart(a);return a+(e.days[l]-a)%o}if(s===t.Const.DAILY_INTERVAL){l=e.getNextDayStart(a+1);return this.getPrevOrNextClosestToX(e.units,e.days,l,i,1)}var h=e.getNextWeekEnd(a);return h-=(e.fridays.length-1-h)%o,h=Math.min(h,e.fridays.length-1),this.getPrevOrNextClosestToX(e.units,e.fridays,h,i,o)},LineChartLayer.prototype.drawLineToDataUnit=function(t,e,i,n){var a=t.getXPos(n),r=this.getYPos(i,n);e.graphics.lineTo(a,r)},LineChartLayer.prototype.getPoint=function(t,e){return t.units[this.getPointIndex(t,e)]},LineChartLayer.prototype.getDataSeries=function(t){return this.dataSource.data},LineChartLayer.prototype.getContext=function(e,i){void 0===i&&(i=!1);var n=this.dataSource.data;if(0===n.units.length)return e;var a=this.computeMaxRange2(e.lastMinute,e.count,e.verticalScaling,i);if(!a)return e;var r=t.Utils.getLogScaledValue(a.lowerBound,e.verticalScaling);e.maxRangeLowerBound=t.Utils.extendedMin(r,e.maxRangeLowerBound);var o=t.Utils.getLogScaledValue(a.upperBound,e.verticalScaling);e.maxRangeUpperBound=t.Utils.extendedMax(o,e.maxRangeUpperBound);var s=e.verticalScaling!==t.Const.LOG_VSCALE&&e.verticalScaling!==t.Const.NEW_LOG_VSCALE?Number(a.range):o-r;e.maxPriceRange=t.Utils.extendedMax(s,e.maxPriceRange);var l=this.getMediumPrice(e.lastMinute,e.count,n,e.verticalScaling),h=this.normalizeMedPrice(l,e.maxPriceRange);e.medPrice=(t.Utils.extendedMax(h,e.medPrice)+t.Utils.extendedMin(h,e.medPrice))/2,e.minPrice=t.Utils.extendedMin(this.minPrice,e.minPrice),e.maxPrice=t.Utils.extendedMax(this.maxPrice,e.maxPrice);var c=e.maxPrice-e.minPrice;return e.maxPriceRange=t.Utils.extendedMax(c,e.maxPriceRange),e.medPrice=this.normalizeMedPrice(e,e.maxPriceRange),e},LineChartLayer.prototype.computeMaximizedMaxRange=function(e,i){var n=this.dataSource.data,a=n.units,r=this.viewPoint.getDetailLevel(i,e),o=n.getRelativeMinuteIndex(e),s=a[o],l=s.close,h=s.close,c=e-i;if(r<=t.Intervals.INTRADAY){if(s.relativeMinutes<=c)return null;for(;o>=0&&!((s=a[o]).relativeMinutes<c);){(g=s.low?s.low:s.close)<l&&(l=g),(p=s.high?s.high:s.close)>h&&(h=p),o--}o>=0&&(l=t.Utils.extendedMin(l,s.low?s.low:s.close),h=t.Utils.extendedMax(h,s.high?s.high:s.close))}else{var u=void 0,d=void 0;for(r<=t.Intervals.DAILY?(u=n.getNextDayStart(o),d=n.days):(u=n.getNextWeekEnd(o),d=n.fridays),u=Math.min(u+1,d.length-1);u>=0&&!((s=a[d[u]]).relativeMinutes<c);){var g,p;(g=s.low?s.low:s.close)<l&&(l=g),(p=s.high?s.high:s.close)>h&&(h=p),u--}u>=0&&(l=t.Utils.extendedMin(l,s.low?s.low:s.close),h=t.Utils.extendedMax(h,s.high?s.high:s.close))}if(h===l){var v=Math.min(2*h,t.Const.DEFAULT_MAX_RANGE);return{upperBound:v,lowerBound:0,range:v}}return{upperBound:h,lowerBound:l,range:h-l}},LineChartLayer.prototype.clearHighlight=function(){this.highlightCanvas.graphics.clear()},LineChartLayer}(t.AbstractDrawingLayer);t.LineChartLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function AHLineChartLayer(){return null!==e&&e.apply(this,arguments)||this}return __extends(AHLineChartLayer,e),AHLineChartLayer.prototype.getPoint=function(e,i){var n=this.viewPoint.getMinuteOfX(i),a=e.getRelativeMinuteIndex(n),r=e.units[a].time,o=notnull(this.visibleSessionsTimes.getIntervalForValue(r));for(a-=(a-t.DataSource.getTimeIndex(o.end,e.units))%this.viewPoint.getSkipInterval().skip;e.units[a].fake&&e.units[a].time>o.start;)a--;return e.units[a]},AHLineChartLayer.prototype.getDataSeries=function(t){return this.dataSource.afterHoursData},AHLineChartLayer.prototype.getVisibleSessionsTimes=function(e){for(var i=new t.IntervalSet,n=this.dataSource.visibleExtendedHours,a=n.length()-1;a>=0;a--){var r=n.getIntervalAt(a),o=this.dataSource.afterHoursData.units[r.start],s=this.dataSource.afterHoursData.units[r.end];t.ViewPoint.sessionVisible(o,s,e)&&i.addInterval(o.time,s.time)}return i},AHLineChartLayer.prototype.computeMaxRange=function(t,e){void 0===e&&(e=!1),this.minPrice=Number.POSITIVE_INFINITY,this.maxPrice=0;for(var i=this.getVisibleSessionsTimes(t),n=0;n<i.length();n++){var a=i.getIntervalAt(n);this.computeSessionMinMaxPrice(t,a.start,a.end)}return 0!==this.maxPrice?this.maxPrice-this.minPrice:0},AHLineChartLayer.prototype.computeSessionMinMaxPrice=function(e,i,n){for(var a=this.getDataSeries(),r=t.DataSource.getTimeIndex(i,a.units),o=t.DataSource.getTimeIndex(n,a.units),s=r;s<o;s++){var l=a.units[s];l.close<this.minPrice?this.minPrice=l.close:l.close>this.maxPrice&&(this.maxPrice=l.close)}},AHLineChartLayer.prototype.getContext=function(e,i){void 0===i&&(i=!1);var n=this.getDataSeries();if(0===n.points.length)return e;var a=n.getFirstRelativeMinute();if(e.lastMinute<a)return e;if(this.viewPoint.getDetailLevel()>t.Intervals.INTRADAY)return e;this.computeMaxRange(e,i);var r=this.getMediumPrice(e.lastMinute,e.count,n,e.verticalScaling),o=0,s=0;r.maxPrice!==r.minPrice||e.maxPrice||e.minPrice||(o=Math.min(r.minPrice,t.Const.DEFAULT_MAX_RANGE/2),s=t.Const.DEFAULT_MAX_RANGE-o);var l=t.Utils.getLogScaledValue(r.minPrice-o,e.verticalScaling);e.maxRangeLowerBound=t.Utils.extendedMin(l,e.maxRangeLowerBound);var h=t.Utils.getLogScaledValue(r.maxPrice+s,e.verticalScaling);e.maxRangeUpperBound=t.Utils.extendedMax(h,e.maxRangeUpperBound);var c=t.Utils.getLogScaledValue(r.minPrice,e.verticalScaling),u=t.Utils.getLogScaledValue(r.maxPrice,e.verticalScaling);e.minPrice=t.Utils.extendedMin(c,e.minPrice),e.maxPrice=t.Utils.extendedMax(u,e.maxPrice),e.medPrice=(e.minPrice+e.maxPrice)/2;var d=e.maxPrice-e.minPrice;return e.maxPriceRange=t.Utils.extendedMax(d,e.maxPriceRange),e},AHLineChartLayer.prototype.renderLayer=function(e){if(0!==this.getDataSeries().points.length){this.visibleSessionsTimes=this.getVisibleSessionsTimes(e),this.graphics.clear(),this.regionsXLimits=new t.IntervalSet;var i=this.viewPoint;this.localYOffset=this.viewPoint.miny+i.medPriceY+i.V_OFFSET,this.localYScale=i.maxPriceRangeViewSize/e.maxPriceRange;for(var n=0;n<this.visibleSessionsTimes.length();n++){var a=this.visibleSessionsTimes.getIntervalAt(n);this.drawAfterHoursSession(this,a.start,a.end,e)}}},AHLineChartLayer.prototype.highlightPoint=function(e,i,n){if((this.clearHighlight(),this.regionsXLimits&&0!==this.regionsXLimits.length())&&this.regionsXLimits.getIntervalForValue(i)){n.setter&&n.setter.clearHighlight();var a=this.getDataSeries();if(a){var r=this.getPoint(a,i),o=this.viewPoint.getXPos(r),s=this.getYPos(e,r),l=this.highlightCanvas.graphics;l.lineStyle(5,t.Const.AH_DOT_COLOR,1),l.moveTo(o,s-.2),l.lineTo(o,s+.2),n.point=r,n.setter=this,n.extraText=a.getSessionDisplayNameForMinute(r.dayMinute)+": "}}},AHLineChartLayer.prototype.getMediumPrice=function(t,e,i,n){return{medPrice:0,minPrice:this.minPrice,maxPrice:this.maxPrice}},AHLineChartLayer.prototype.drawAfterHoursSession=function(e,i,n,a){for(var r=t.Const.INTRADAY_INTERVAL/60,o=this.dataSource.afterHoursData.units,s=t.DataSource.getTimeIndex(n,o),l=t.DataSource.getTimeIndex(i,o),h=this.viewPoint,c=h.getXPos(o[s]),u=1;this.viewPoint.minutePix*r*u<h.POINTS_DISTANCE;)u*=2;var d=s;if(0===o[d].relativeMinutes)for(;o[d].time>i&&o[d].fake;)d--;d+=(s-d)%u;var g=h.getXPos(o[d]),p=this.getYPos(a,o[d]),v=e.graphics;v.lineStyle(0,0,0),v.beginFill(t.Const.ECN_LINE_CHART_FILL_COLOR,t.Const.ECN_LINE_CHART_FILL_VISIBILITY),v.moveTo(g,this.viewPoint.maxy-15),v.lineTo(g,p),v.lineStyle(t.Const.ECN_LINE_CHART_LINE_THICKNESS,t.Const.ECN_LINE_CHART_LINE_COLOR,t.Const.ECN_LINE_CHART_LINE_VISIBILITY);for(var y=u*(this.viewPoint.minutePix*r),f=d;f>l;f-=u)p=this.getYPos(a,o[f]),v.lineTo(g,p),g-=y;v.lineTo(g,p),v.lineStyle(0,0,0),v.lineTo(g,this.viewPoint.maxy-15),v.endFill(),this.regionsXLimits.addInterval(g,c)},AHLineChartLayer}(t.LineChartLayer);t.AHLineChartLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function VolumeLinesChartLayer(t,i){var n=e.call(this,t,i)||this;return n.highlightCanvas=new flash.display.Sprite,n.maxVolume={},n.verticalScale=0,n.addChild(n.highlightCanvas),n}return __extends(VolumeLinesChartLayer,e),VolumeLinesChartLayer.prototype.drawDayLine=function(e,i,n,a,r,o,s,l,h){var c=a.points,u=a.days;if(u[i-1]===u[i]-1)return i;var d=u[i];d>l&&(d=l);for(var g=a.points[d],p=n.getXPos(c[d].point),v=n.getIntervalLength(o/60),y=t.Utils.extendedMax(s,u[i-1]),f=e.graphics;d>y;){var T=n.maxy-g.volume*this.verticalScale;n.maxy-T<1&&n.maxy-T>0?T=n.maxy-1:T<n.miny&&(T=n.miny),f.moveTo(p,T),f.lineTo(p,n.maxy),d--,p-=v}return i},VolumeLinesChartLayer.prototype.setIndicator=function(e,i,n){this.dataSource.indicators[e]=new t.Indicator,this.indicator=this.dataSource.indicators[e],this.indicator.clearAllOnAddData=!0,this.computer=i,this.originalDataSeries=n},VolumeLinesChartLayer.prototype.getNewestMinute=function(){return this.originalDataSeries.getLastRelativeMinute()},VolumeLinesChartLayer.prototype.getYPos=function(t,e){return isNaN(e.volume)?t.maxy:t.maxy-e.volume*this.verticalScale},VolumeLinesChartLayer.prototype.getPoint=function(t,e){for(var i=this.getPointIndex(t,e);i>0&&0===t.points[i].volume;)i--;return t.points[i]},VolumeLinesChartLayer.prototype.renderLayer=function(t){var e=this.viewPoint.getSkipInterval(t.count,t.lastMinute),i=this.indicator.getDataSeries(e.interval);if(i&&0!==i.points.length){var n=this.viewPoint.getLastMinute(),a=this.viewPoint.getFirstMinute(),r=i.getReferencePointIndex(n),o=Number(i.getReferencePointIndex(a)-1);o<0&&(o=0),this.drawLines(this,i,o,r,this.viewPoint,t)}},VolumeLinesChartLayer.prototype.drawOneLine=function(t,e,i,n){n.maxy-e<1&&n.maxy-e>0?e=n.maxy-1:e<n.miny&&(e=n.miny),i.graphics.moveTo(t,e),i.graphics.lineTo(t,n.maxy)},VolumeLinesChartLayer.prototype.getPointIndex=function(t,e){for(var i=this.viewPoint.getMinuteOfX(e),n=t.getReferencePointIndex(i);t.units[n].fake&&n>=0;)n--;if(n<t.points.length-1){var a=t.points[n].point,r=t.points[n+1].point,o=this.viewPoint.getMinuteXPos(r.relativeMinutes),s=this.viewPoint.getMinuteXPos(a.relativeMinutes);if(Math.abs(o-e)<Math.abs(s-e))return n+1}return n},VolumeLinesChartLayer.prototype.clearHighlight=function(){this.highlightCanvas.graphics.clear()},VolumeLinesChartLayer.prototype.getOldestMinute=function(){return this.originalDataSeries.getFirstRelativeMinute()},VolumeLinesChartLayer.prototype.drawLines=function(e,i,n,a,r,o){var s=i.points,l=i.getNextDayStart(a),h=r.getDetailLevel(),c=r.getSkipInterval().interval;this.verticalScale=(r.maxy-r.miny-6)/o.maxVolume;var u=e.graphics;switch(u.clear(),u.lineStyle(0,this.lineColor,1),h){case t.Intervals.INTRADAY:for(;i.days[l]>n&&l>=0;)this.drawDayLine(e,l,r,i,h,c,n,a,o),l--;break;case t.Intervals.DAILY:for(var d=a;d>n&&d>=0;d--){var g=this.getYPos(r,s[d]),p=r.getXPos(s[d].point);r.maxy-g<1&&r.maxy-g>0?g=r.maxy-1:g<r.miny&&(g=r.miny),u.moveTo(p,g),u.lineTo(p,r.maxy)}break;case t.Intervals.WEEKLY:for(d=a;d>n&&d>=0;d--){p=r.getXPos(s[d].point),g=this.getYPos(r,s[d]);r.maxy-g<1&&r.maxy-g>0?g=r.maxy-1:g<r.miny&&(g=r.miny),u.moveTo(p,g),u.lineTo(p,r.maxy)}}},VolumeLinesChartLayer.prototype.getMaxVolume=function(e,i,n){var a=NaN,r=this.viewPoint,o=r.getSkipInterval(i,e).interval,s=notnull(this.indicator.getDataSeries(o)),l="c"+i+"-"+r.getDetailLevel(i,e)+"-"+s.units.length;if(void 0!==this.maxVolume[l])return this.maxVolume[l];for(var h=0,c=0,u=s.points;c<u.length;c++){var d=u[c];d.volume>h&&(h=Number(d.volume))}this.maxVolume[l]=h;for(var g=1;g<t.Const.VOLUME_SCALES.length&&(a=t.Const.VOLUME_SCALES[g],!(Math.floor(this.maxVolume[l]/a)<10));g++);var p=(Math.floor(this.maxVolume[l]/a)+1)*a;return this.maxVolume[l]=p,this.maxVolume[l]},VolumeLinesChartLayer.prototype.getDataSeries=function(t){var e=this.viewPoint;t||(t=e.layersContext);var i=e.getSkipInterval(t.count,t.lastMinute);return this.computer(i.interval,this.indicator,this.originalDataSeries),notnull(this.indicator.getDataSeries(i.interval))},VolumeLinesChartLayer.prototype.getContext=function(e,i){if(void 0===i&&(i=!1),0===this.getDataSeries(e).points.length)return void 0===e.maxVolume&&(e.maxVolume=0),e;var n=this.getMaxVolume(e.lastMinute,e.count,i);return e.maxVolume=t.Utils.extendedMax(e.maxVolume,n),e},VolumeLinesChartLayer.prototype.highlightPoint=function(e,i,n){this.clearHighlight();var a=this.viewPoint.getSkipInterval(e.count,e.lastMinute),r=this.indicator.getDataSeries(a.interval);if(r){var o=r.getFirstReferencePoint(),s=r.getLastReferencePoint();if(o&&s){var l=this.viewPoint.getMinuteXPos(o.relativeMinutes),h=this.viewPoint.getMinuteXPos(s.relativeMinutes);if(!(i<l||i>h)&&void 0===n.ahsetter){var c=this.getPoint(r,i),u=this.viewPoint.getXPos(c.point),d=this.getYPos(this.viewPoint,c);this.highlightCanvas.graphics.lineStyle(2,t.Const.VOLUME_HIGHLIGHT_COLOR,1),this.drawOneLine(u,d,this.highlightCanvas,this.viewPoint),n[t.SpaceText.VOLUME_STR]=c.volume,n.volumesetter=this}}}},VolumeLinesChartLayer}(t.AbstractDrawingLayer);t.VolumeLinesChartLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function AHVolumeLayer(){var t=null!==e&&e.apply(this,arguments)||this;return t.maxVolumeCache={},t}return __extends(AHVolumeLayer,e),AHVolumeLayer.prototype.drawAfterHoursSession=function(e,i,n,a,r,o){for(var s=t.DataSource.getTimeIndex(a,i.units),l=t.DataSource.getTimeIndex(n,i.units),h=this.viewPoint,c=i.points,u=h.getXPos(c[s].point),d=u,g=h.getIntervalLength(o/60),p=e.graphics,v=s;v>l;v--){var y=h.maxy-c[v].volume*this.verticalScale;h.maxy-y<1&&h.maxy-y>0?y=h.maxy-1:y<h.miny&&(y=h.miny),p.moveTo(d,y),p.lineTo(d,h.maxy),d-=g}this.regionsXLimits.addInterval(d,u)},AHVolumeLayer.prototype.getMaxVolumeHashKey=function(t,e){return t+"-"+e},AHVolumeLayer.prototype.drawLines=function(e,i,n,a,r,o){var s=r.getSkipInterval().interval;this.verticalScale=(r.maxy-r.miny-6)/o.maxVolume,this.graphics.clear(),this.graphics.lineStyle(0,this.lineColor,1);var l=this.dataSource.visibleExtendedHours;this.regionsXLimits=new t.IntervalSet;for(var h=0;h<l.length();h++){var c=l.getIntervalAt(h),u=this.dataSource.afterHoursData.units[c.start],d=this.dataSource.afterHoursData.units[c.end];t.ViewPoint.sessionVisible(u,d,o)&&this.drawAfterHoursSession(this,i,u.time,d.time,o,s)}},AHVolumeLayer.prototype.highlightPoint=function(e,i,n){this.clearHighlight();var a=this.viewPoint,r=a.getSkipInterval(e.count,e.lastMinute),o=this.indicator.getDataSeries(r.interval);if(o&&this.regionsXLimits&&this.regionsXLimits.containsValue(i)){n.volumesetter&&n.volumesetter.clearHighlight();var s=this.getPoint(o,i),l=a.getXPos(s.point),h=this.getYPos(this.viewPoint,s);this.highlightCanvas.graphics.lineStyle(2,t.Const.VOLUME_HIGHLIGHT_COLOR,1),this.drawOneLine(l,h,this.highlightCanvas,this.viewPoint),n.volume=s.volume,n.ahsetter=this}},AHVolumeLayer.prototype.getMaxVolume=function(e,i,n){var a=this.viewPoint.getSkipInterval(i,e).interval;if(a>=t.Const.DAILY_INTERVAL)return 0;for(var r=this.dataSource.visibleExtendedHours,o=0,s=notnull(this.indicator.getDataSeries(a)),l=0;l<r.length();l++){var h=r.getIntervalAt(l),c=this.dataSource.afterHoursData.units[h.start],u=this.dataSource.afterHoursData.units[h.end],d=this.getMaxVolumeHashKey(c.time,a);if(void 0===this.maxVolumeCache[d]){for(var g=t.DataSource.getTimeIndex(u.time,s.units),p=t.DataSource.getTimeIndex(c.time,s.units),v=0,y=p;y<g;y++)v=Math.max(s.points[y].volume,v);g>p&&(this.maxVolumeCache[d]=v)}o=t.Utils.extendedMax(o,this.maxVolumeCache[d])}return o},AHVolumeLayer}(t.VolumeLinesChartLayer);t.AHVolumeLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function AnimationManager(){var e=null!==t&&t.apply(this,arguments)||this;return e.stepCount=0,e.amount=0,e}return __extends(AnimationManager,t),AnimationManager.prototype.animate=function(t,e,i,n){var a=this;void 0===i&&(i=NaN),void 0===n&&(n=!1);var r=e,o=i,s=n;if(this.stepCount=isNaN(o)?AnimationManager.MAX_STEPS:o,this.amount=1,this.stopAnimation(),1!==this.stepCount)this.intervalId=setInterval(function(){a.stepCount--;for(var e=0;e<t.length;e++)t[e](r[e],a.amount,s);if(a.stepCount<=0){for(e=0;e<t.length;e++)t[e](r[e],0,s);a.stopAnimation()}a.amount=a.amount/3},AnimationManager.ANIMATION_FRAME_LENGTH_MS);else for(var l=0;l<t.length;l++)t[l](r[l],0,s)},AnimationManager.prototype.stopAnimation=function(){clearInterval(this.intervalId),this.intervalId=NaN},AnimationManager.prototype.isAnimating=function(){return!isNaN(this.intervalId)},AnimationManager.ANIMATION_FRAME_LENGTH_MS=40,AnimationManager.MAX_STEPS=10,AnimationManager}(flash.display.Sprite);t.AnimationManager=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function BorderLayer(t,i){var n=e.call(this,document.createElement("div"))||this;return n.displayManager=t,n.topViewPoint=i,n}return __extends(BorderLayer,e),BorderLayer.prototype.update=function(e,i,n){if(void 0===i&&(i=0),void 0===n&&(n=!1),e?this.topViewPoint=e.topViewPoint:e=this,this.topViewPoint.windowLayer){var a=this.topViewPoint.windowLayer,r=a.leftHandle,o=a.rightHandle,s=Math.floor(this.topViewPoint.getHandleLeftX()),l=Math.floor(this.topViewPoint.getHandleRightX()),h=t.Const.MOVIE_HEIGHT;if(!(s<=0||l<=0)){s===l&&(s-=3,l+=3);var c=a.scrollSlider,u=e.graphics;u.clear();var d=Math.floor(c.x),g=Math.floor(c.x+c.width);s===d-1&&(s=d),l===g+1&&(l=g);var p=h-t.Const.SPARKLINE_HEIGHT-t.Const.SPARK_PADDING;if(u.lineStyle(0,t.Const.BORDER_LINE_COLOR,t.Const.BORDER_LINE_OPACITY),u.moveTo(d,h-1),u.lineTo(g,h-1),u.lineTo(g,h-t.Const.SCROLL_HEIGHT-2),u.lineTo(l,h-t.Const.SCROLL_HEIGHT-2),a.contains(r)&&(u.lineTo(l,o.y+o.height-1),u.moveTo(l,o.y+1)),u.lineTo(l,p),u.lineTo(t.Const.MOVIE_WIDTH-1-1,p),u.lineTo(t.Const.MOVIE_WIDTH-1-1,1),u.lineTo(1,1),u.lineTo(1,p),u.lineTo(s,p),a.contains(r)&&(u.lineTo(s,r.y+1),u.moveTo(s,r.y+r.height-1)),u.lineTo(s,h-t.Const.SCROLL_HEIGHT-2),u.lineTo(d,h-t.Const.SCROLL_HEIGHT-2),u.lineTo(d,h),u.lineStyle(0,t.Const.BORDER_SHADOW_COLOR,1),u.moveTo(l+1,h-t.Const.SCROLL_HEIGHT-2-.5),a.contains(o)&&(u.lineTo(l+1,o.y+o.height-1),u.moveTo(l+1,o.y+1)),u.lineTo(l+1,p+1),u.lineTo(t.Const.MOVIE_WIDTH-1,p+1),u.lineTo(t.Const.MOVIE_WIDTH-1,0),u.lineTo(0,0),u.lineTo(0,p+1),u.lineTo(s-1,p+1),a.contains(r)&&(u.lineTo(s-1,r.y+1),u.moveTo(s-1,r.y+r.height-1)),u.lineTo(s-1,h-t.Const.SCROLL_HEIGHT-2),t.Const.INDICATOR_ENABLED){u.lineStyle(0,t.Const.HORIZONTAL_LINE_COLOR,1);for(var v=1,y=0,f=this.displayManager.getViewPoints();y<f.length;y++){var T=f[y];if(-1!==t.Const.INDEPENDENT_INDICATOR_NAMES.indexOf(T.name)||T.name===t.Const.BOTTOM_VIEW_POINT_NAME){var I=p-t.Const.TECHNICAL_INDICATOR_HEIGHT*v;u.moveTo(1,I),u.lineTo(t.Const.MOVIE_WIDTH-1-1,I),v++}}}}}},BorderLayer}(flash.display.Shape);t.BorderLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function BottomBarLayer(t,i){var n=e.call(this,t,i)||this;return n.bottomTextHeight=15,t.bottomTextHeight=n.bottomTextHeight,n}return __extends(BottomBarLayer,e),BottomBarLayer.prototype.drawRectangle=function(t,e,i,n,a,r){var o=this.graphics;o.lineStyle(0,0,0),o.beginFill(t,e),o.drawRect(i,n,a-i,r-n),o.endFill()},BottomBarLayer.prototype.renderLayer=function(e){this.graphics.clear(),this.drawRectangle(t.Const.TEXT_BACKGROUND_COLOR,80,this.viewPoint.minx,this.viewPoint.maxy-this.bottomTextHeight,this.viewPoint.maxx,this.viewPoint.maxy)},BottomBarLayer}(t.AbstractLayer);t.BottomBarLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){function Bounds(t,e,i,n){this.minx=t,this.miny=e,this.maxx=i,this.maxy=n}return Bounds.prototype.toString=function(){return"["+this.minx+","+this.miny+"]["+this.maxx+","+this.maxy+"]"},Bounds.prototype.containsPoint=function(t,e){return t>this.minx&&t<this.maxx&&e>this.miny&&e<this.maxy},Bounds.prototype.append=function(t){this.minx=Math.min(this.minx,t.minx),this.miny=Math.min(this.miny,t.miny),this.maxx=Math.max(this.maxx,t.maxx),this.maxy=Math.max(this.maxy,t.maxy)},Bounds.prototype.equals=function(t){var e=t;return!!e&&(e.minx===this.minx&&e.miny===this.miny&&e.maxx===this.maxx&&e.maxy===this.maxy)},Bounds}();t.Bounds=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(e){var i=function(i){function IntervalBasedChartLayer(t,e){var n=i.call(this,t,e)||this;return n.highlightCanvas=new flash.display.Sprite("highlightCanvas"),n.addChild(n.highlightCanvas),n.setEnabled(!1),n}return __extends(IntervalBasedChartLayer,i),IntervalBasedChartLayer.prototype.getCloseYPos=function(t,e){return this.getYPos(t,e.getCloseLogValue(t.verticalScaling))},IntervalBasedChartLayer.prototype.getLayerName=function(){return this.layerName},IntervalBasedChartLayer.prototype.getPointsForCurrentDetailLevel=function(t,i){var n;void 0===t&&(t=NaN),void 0===i&&(i=NaN);var a=this.viewPoint;n=isNaN(t)||isNaN(i)?a.getDetailLevelForTechnicalStyle():a.getDetailLevelForTechnicalStyle(t,i);var r=e.Const.getDetailLevelInterval(n);return notnull(this.getDataSeries()).getPointsInIntervalArray(r)},IntervalBasedChartLayer.prototype.shouldDisplayOhlcText=function(t){var i=this.viewPoint.getDisplayManager().getEnabledChartLayer();return(i===e.Const.CANDLE_STICK||i===e.Const.OHLC_CHART)&&!(isNaN(t.open)||isNaN(t.high)||isNaN(t.low))},IntervalBasedChartLayer.prototype.getOhlcYPos=function(t,e){return{closeY:this.getYPos(t,e.getCloseLogValue(t.verticalScaling)),openY:this.getYPos(t,e.getOpenLogValue(t.verticalScaling)),highY:this.getYPos(t,e.getHighLogValue(t.verticalScaling)),lowY:this.getYPos(t,e.getLowLogValue(t.verticalScaling))}},IntervalBasedChartLayer.prototype.getYPos=function(t,e){return assert(!isNaN(e)),this.localYOffset-this.localYScale*(e-t.medPrice)},IntervalBasedChartLayer.prototype.getOhlcBasePrice=function(i,n){return e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale())?n?n.close:Number(i.open):-1},IntervalBasedChartLayer.prototype.getCandleStickColor=function(i){return e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale())?i.close>=i.open?Number(e.Const.POSITIVE_DIFFERENCE_COLOR):e.Const.NEGATIVE_DIFFERENCE_COLOR:e.Const.LINE_CHART_LINE_COLOR},IntervalBasedChartLayer.prototype.clearHighlight=function(){this.highlightCanvas.graphics.clear()},IntervalBasedChartLayer.prototype.isEnabled=function(){return this.enabled},IntervalBasedChartLayer.prototype.getContext=function(t,i){if(void 0===i&&(i=!1),!this.isEnabled())return t;var n=this.viewPoint,a=n.getDisplayManager().getEnabledChartLayer()===e.Const.LINE_CHART,r=n.getDetailLevelForTechnicalStyle(t.lastMinute,t.count),o=notnull(this.getDataSeries(t)),s=NaN,l=NaN,h=t.lastMinute-t.count,c=t.lastMinute,u=0;do{var d=o.getPointsInIntervalArray(e.Const.getDetailLevelInterval(r)),g=e.Const.getDetailLevelInterval(r)/60;if(d&&d.length>0&&d[0].relativeMinutes<=c){(u=o.getRelativeMinuteIndex(h,d)-1)<0&&(u=0);var p=o.getRelativeMinuteIndex(t.lastMinute,d)+1;if(p>=d.length&&(p=d.length-1),r<e.Intervals.DAILY){for(;u<d.length&&(isNaN(d[u].relativeMinutes)||h-d[u].relativeMinutes>=g);)u++;for(;p>=0&&(isNaN(d[p].relativeMinutes)||d[p].relativeMinutes-c>=g);)p--}for(var v=p;v>=u;v--){var y=d[v],f=!a&&y.low?y.low:y.close;l=e.Utils.extendedMin(l,f);var T=!a&&y.high?y.high:y.close;s=e.Utils.extendedMax(s,T)}if(d[0].relativeMinutes-1<=h)break}r++}while(a&&r<=e.Intervals.WEEKLY&&0===u);if(isNaN(s)||isNaN(l))return t;var I=0,L=0;s!==l||t.maxPrice||t.minPrice||(I=Number(Math.min(l,e.Const.DEFAULT_MAX_RANGE/2)),L=Number(e.Const.DEFAULT_MAX_RANGE-I));var m=e.Utils.getLogScaledValue(l-I,t.verticalScaling),M=e.Utils.getLogScaledValue(s+L,t.verticalScaling);return t.maxRangeUpperBound=e.Utils.extendedMax(M,t.maxRangeUpperBound),t.maxRangeLowerBound=e.Utils.extendedMin(m,t.maxRangeLowerBound),t.maxPriceRange=e.Utils.extendedMax(t.maxRangeUpperBound-t.maxRangeLowerBound,t.maxPriceRange),l=e.Utils.getLogScaledValue(l,t.verticalScaling),s=e.Utils.getLogScaledValue(s,t.verticalScaling),t.maxPrice=e.Utils.extendedMax(t.maxPrice,s),t.minPrice=e.Utils.extendedMin(t.minPrice,l),t.medPrice=(t.maxPrice+t.minPrice)/2,t},IntervalBasedChartLayer.prototype.setLayerName=function(t){this.layerName=t},IntervalBasedChartLayer.prototype.findPointIndex=function(t){var i=notnull(this.getDataSeries()),n=this.getPointsForCurrentDetailLevel();if(!n)return-1;var a=this.viewPoint.getMinuteOfX(t),r=i.getRelativeMinuteIndex(a,n);if(r===n.length-2&&Math.abs(a-n[r].relativeMinutes)>Math.abs(a-n[r+1].relativeMinutes)&&r++,this.viewPoint.getDetailLevelForTechnicalStyle()===e.Intervals.WEEKLY)for(;r+1<n.length&&n[r+1].weeklyXPos<=t;)r++;for(;r>0&&(n[r].fake||n[r].duplicate);)r--;return r},IntervalBasedChartLayer.prototype.highlightPoint=function(t,i,n){if(this.isEnabled()){var a=this.findPointIndex(i),r=this.getPointsForCurrentDetailLevel();if(r&&-1!==a){var o=r[a],s=isNaN(o.weeklyXPos)?this.viewPoint.getXPos(o):Number(o.weeklyXPos),l=this.getCloseYPos(t,o);n[e.SpaceText.SETTER_STR]&&n[e.SpaceText.SETTER_STR].clearHighlight();var h=this.highlightCanvas.graphics;h.clear();var c=this.getDataSeries()===this.dataSource.afterHoursData?Number(e.Const.AH_DOT_COLOR):e.Const.DOT_COLOR;h.lineStyle(5,c,1),h.moveTo(s,l-.2),h.lineTo(s,l+.2),n[e.SpaceText.POINT_STR]=o,n[e.SpaceText.EXTRA_TEXT_STR]="",n[e.SpaceText.SETTER_STR]=this,n[e.SpaceText.OHLC_INFO_FLAG_STR]=this.shouldDisplayOhlcText(o),n[e.SpaceText.OHLC_BASE_PRICE_STR]=this.getOhlcBasePrice(o,0===a?null:r[a-1])}}},IntervalBasedChartLayer.prototype.getOhlcColor=function(i,n){return e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale())?i.close>=i.open?Number(e.Const.POSITIVE_DIFFERENCE_COLOR):e.Const.NEGATIVE_DIFFERENCE_COLOR:i.close>=n.close?Number(e.Const.POSITIVE_DIFFERENCE_COLOR):e.Const.NEGATIVE_DIFFERENCE_COLOR},IntervalBasedChartLayer.prototype.setEnabled=function(t){void 0===t&&(t=!0),this.enabled=t,this.visible=t,this.highlightCanvas.visible=t},IntervalBasedChartLayer}(e.AbstractDrawingLayer);e.IntervalBasedChartLayer=i}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function IntervalBasedBarChartLayer(){return null!==e&&e.apply(this,arguments)||this}return __extends(IntervalBasedBarChartLayer,e),IntervalBasedBarChartLayer.prototype.renderLayer=function(e){if(this.isEnabled()){this.graphics.clear();var i=this.viewPoint,n=notnull(this.getDataSeries()),a=this.getPointsForCurrentDetailLevel();if(a&&0!==a.length&&void 0!==e.maxPriceRange&&void 0!==e.medPrice){this.localYOffset=i.miny+i.medPriceY+i.V_OFFSET,this.localYScale=i.maxPriceRangeViewSize/e.maxPriceRange;var r=Math.max(n.getRelativeMinuteIndex(i.getFirstMinute(),a)-1,0),o=Math.min(n.getRelativeMinuteIndex(i.getLastMinute(),a)+1,this.getLastRealPointIndex(a)),s=i.getDetailLevelForTechnicalStyle();this.barWidth=this.getBarWidth(s,n);for(var l=Number.MAX_VALUE,h=o;h>=r;h--)n.minuteIsStartOfDataSession(a[h].dayMinute)||isNaN(a[h].high)||isNaN(a[h].low)||isNaN(a[h].open)||(s===t.Intervals.WEEKLY&&(l=this.getWeeklyBarXPos(a[h],l)),this.drawBarAtDataUnit(e,a,h))}}},IntervalBasedBarChartLayer}(t.IntervalBasedChartLayer);t.IntervalBasedBarChartLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function CandleStickChartLayer(){return null!==t&&t.apply(this,arguments)||this}return __extends(CandleStickChartLayer,t),CandleStickChartLayer.prototype.drawBarAtDataUnit=function(t,e,i){var n=e[i];if(!n.fake){var a=isNaN(n.weeklyXPos)?this.viewPoint.getXPos(n):n.weeklyXPos,r=this.getOhlcYPos(t,n),o=this.graphics,s=this.getCandleStickColor(n);o.lineStyle(1,s);var l=n.close>=n.open;if(Math.abs(r.closeY-r.openY)<=1){var h=(r.closeY+r.openY)/2;0===this.barWidth?(o.moveTo(a,h-.5),o.lineTo(a,h+.5)):(o.moveTo(a-this.barWidth/2,h),o.lineTo(a+this.barWidth/2,h))}else o.moveTo(a-this.barWidth/2,l?r.closeY:r.openY),l||o.beginFill(s),o.lineTo(a+this.barWidth/2,l?r.closeY:r.openY),o.lineTo(a+this.barWidth/2,l?r.openY:r.closeY),o.lineTo(a-this.barWidth/2,l?r.openY:r.closeY),o.lineTo(a-this.barWidth/2,l?r.closeY:r.openY),l||o.endFill();o.moveTo(a,r.lowY),o.lineTo(a,l?r.openY:r.closeY),o.moveTo(a,l?r.closeY:r.openY),o.lineTo(a,r.highY)}},CandleStickChartLayer}(t.IntervalBasedBarChartLayer);t.CandleStickChartLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e;!function(t){t[t.GENERIC=0]="GENERIC",t[t.GET_DATA=1]="GET_DATA",t[t.GET_AH_DATA=2]="GET_AH_DATA",t[t.GET_MUTF_DATA=3]="GET_MUTF_DATA",t[t.GET_RT_DATA=4]="GET_RT_DATA",t[t.GET_RT_AH_DATA=5]="GET_RT_AH_DATA"}(e=t.ChartEventTypes||(t.ChartEventTypes={})),function(t){t[t.EXPECTED=0]="EXPECTED",t[t.REQUIRED=1]="REQUIRED",t[t.OPTIONAL=2]="OPTIONAL",t[t.DONE=3]="DONE",t[t.OHLC_REQUIRED=4]="OHLC_REQUIRED",t[t.OHLC_DONE=5]="OHLC_DONE",t[t.POLLING=6]="POLLING"}(t.ChartEventPriorities||(t.ChartEventPriorities={}));var i=function(){function ChartEvent(t){void 0===t&&(t=e.GENERIC),this.type=t}return ChartEvent.prototype.getEventName=function(t){var e="";return this.quote&&(e=e+""+this.quote),this.type&&(e=e+"-t:"+this.type),this.interval&&(e=e+"-i:"+this.interval),t?e=e+"-p:"+t:this.period&&(e=e+"-p:"+this.period),this.startTime&&(e=e+"-st:"+this.startTime),e},ChartEvent}();t.ChartEvent=i}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function Console(i){var n=e.call(this)||this;return n.mainManager=i,n.loading=new t.LoadingMessage,n.pendingLoadings=0,n.loading.visible=!1,n.addChild(n.loading),Boolean(t.MainManager.paramsObj.debug)&&(n.t=new flash.text.TextField,n.t.width=800,n.t.height=400,n.addChild(n.t)),n}return __extends(Console,e),Console.prototype.println=function(e){Boolean(t.MainManager.paramsObj.debug)&&this.t.appendText(e+"\n")},Console.prototype.dataLoading=function(){this.pendingLoadings++,this.positionLoadingMessage(),this.loading.visible=!0},Console.prototype.positionLoadingMessage=function(){var e=this.mainManager.displayManager.getMainViewPoint();e&&(this.loading.x=this.stage.stageWidth-this.loading.width-t.Const.BORDER_WIDTH,this.loading.y=e.miny+1)},Console.prototype.dataLoaded=function(){this.pendingLoadings--,this.pendingLoadings<=0&&(this.loading.visible=!1)},Console}(flash.display.Sprite);t.Console=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(t){t[t.TYPE=0]="TYPE",t[t.LINE=1]="LINE",t[t.CANDLESTICK=2]="CANDLESTICK",t[t.OHLC=3]="OHLC",t[t.LARGE_CHART=4]="LARGE_CHART",t[t.SMALL_CHART=5]="SMALL_CHART",t[t.ZOOM=6]="ZOOM",t[t.ZOOM_1D=7]="ZOOM_1D",t[t.ZOOM_5D=8]="ZOOM_5D",t[t.ZOOM_1M=9]="ZOOM_1M",t[t.ZOOM_3M=10]="ZOOM_3M",t[t.ZOOM_6M=11]="ZOOM_6M",t[t.ZOOM_YTD=12]="ZOOM_YTD",t[t.ZOOM_1Y=13]="ZOOM_1Y",t[t.ZOOM_5Y=14]="ZOOM_5Y",t[t.ZOOM_10Y=15]="ZOOM_10Y",t[t.ZOOM_MAX=16]="ZOOM_MAX",t[t.ZOOM_ALL=17]="ZOOM_ALL",t[t.PRICE=18]="PRICE",t[t.OPEN=19]="OPEN",t[t.CLOSE=20]="CLOSE",t[t.HIGH=21]="HIGH",t[t.LOW=22]="LOW",t[t.VOLUME_LONG=23]="VOLUME_LONG",t[t.VOLUME_SHORT=24]="VOLUME_SHORT",t[t.THOUSAND_SHORT=25]="THOUSAND_SHORT",t[t.MILLION_SHORT=26]="MILLION_SHORT",t[t.THOUSAND_ONE_LETTER=27]="THOUSAND_ONE_LETTER",t[t.TEN_THOUSAND_ONE_LETTER=28]="TEN_THOUSAND_ONE_LETTER",t[t.MILLION_ONE_LETTER=29]="MILLION_ONE_LETTER",t[t.HUNDRED_MILLION_ONE_LETTER=30]="HUNDRED_MILLION_ONE_LETTER",t[t.MINUTES_SHORT=31]="MINUTES_SHORT",t[t.HOUR_SHORT=32]="HOUR_SHORT",t[t.DAY_SHORT=33]="DAY_SHORT",t[t.WEEK_SHORT=34]="WEEK_SHORT",t[t.CURRENCY_SIGN=35]="CURRENCY_SIGN",t[t.SUBCURRENCY_SIGN=36]="SUBCURRENCY_SIGN",t[t.DIVIDEND_TEXT_NO_PERCENT=37]="DIVIDEND_TEXT_NO_PERCENT",t[t.DIVIDEND_TEXT=38]="DIVIDEND_TEXT",t[t.STOCK_DIVIDEND_TEXT=39]="STOCK_DIVIDEND_TEXT",t[t.STOCK_DIVIDEND_TEXT_WITH_TICKER=40]="STOCK_DIVIDEND_TEXT_WITH_TICKER",t[t.ADJUSTMENT_FACTOR_TEXT=41]="ADJUSTMENT_FACTOR_TEXT",t[t.SPLIT_TEXT=42]="SPLIT_TEXT",t[t.LOADING_MESSAGE=43]="LOADING_MESSAGE",t[t.NO_DATA_AVAILABLE=44]="NO_DATA_AVAILABLE",t[t.PREMARKET=45]="PREMARKET",t[t.AFTER_HOURS=46]="AFTER_HOURS",t[t.INTERVAL=47]="INTERVAL",t[t.INTERVAL_2_MINUTES=48]="INTERVAL_2_MINUTES",t[t.INTERVAL_5_MINUTES=49]="INTERVAL_5_MINUTES",t[t.INTERVAL_30_MINUTES=50]="INTERVAL_30_MINUTES",t[t.INTERVAL_1_DAY=51]="INTERVAL_1_DAY",t[t.INTERVAL_1_WEEK=52]="INTERVAL_1_WEEK",t[t.INTERVAL_DAILY=53]="INTERVAL_DAILY",t[t.INTERVAL_WEEKLY=54]="INTERVAL_WEEKLY",t[t.SMA=55]="SMA",t[t.EMA=56]="EMA",t[t.VMA=57]="VMA",t[t.RSI=58]="RSI",t[t.RSI_RSI=59]="RSI_RSI",t[t.BIAS=60]="BIAS",t[t.BIAS_BIAS=61]="BIAS_BIAS",t[t.WPR=62]="WPR",t[t.PR_WPR=63]="PR_WPR",t[t.MACD=64]="MACD",t[t.MACD_MACD=65]="MACD_MACD",t[t.EMA_MACD=66]="EMA_MACD",t[t.DIFF_MACD=67]="DIFF_MACD",t[t.DEA_MACD=68]="DEA_MACD",t[t.DIVERGENCE_MACD=69]="DIVERGENCE_MACD",t[t.KDJ=70]="KDJ",t[t.K_KDJ=71]="K_KDJ",t[t.D_KDJ=72]="D_KDJ",t[t.J_KDJ=73]="J_KDJ",t[t.BOLL=74]="BOLL",t[t.MID_BOLL=75]="MID_BOLL",t[t.UPPER_BOLL=76]="UPPER_BOLL",t[t.LOWER_BOLL=77]="LOWER_BOLL",t[t.FSTO=78]="FSTO",t[t.SSTO=79]="SSTO",t[t.K_STOCHASTIC=80]="K_STOCHASTIC",t[t.D_STOCHASTIC=81]="D_STOCHASTIC",t[t.CCI=82]="CCI",t[t.CCI_CCI=83]="CCI_CCI",t[t.SMA_INTERVAL=84]="SMA_INTERVAL",t[t.EMA_INTERVAL=85]="EMA_INTERVAL",t[t.VMA_INTERVAL=86]="VMA_INTERVAL",t[t.RSI_INTERVAL=87]="RSI_INTERVAL",t[t.BIAS_INTERVAL=88]="BIAS_INTERVAL",t[t.WPR_INTERVAL=89]="WPR_INTERVAL",t[t.MACD_INTERVAL=90]="MACD_INTERVAL",t[t.KDJ_INTERVAL=91]="KDJ_INTERVAL",t[t.BOLL_INTERVAL=92]="BOLL_INTERVAL",t[t.FSTO_INTERVAL=93]="FSTO_INTERVAL",t[t.SSTO_INTERVAL=94]="SSTO_INTERVAL",t[t.CCI_INTERVAL=95]="CCI_INTERVAL"}(t.Messages||(t.Messages={}));var e=function(){function Message(){}return Message.getMsg=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(isNaN(t))return"";if(0===e.length)return Message.MESSAGES[t];for(var n=Message.MESSAGES[t].concat(),a=n.length,r=1;r<a;r+=2)n[r]=e[Number(n[r])-1];return n.join("")},Message.getLocale=function(){return"en"},Message.MESSAGES=["Type","Line","Candlestick","OHLC","Large chart","Small chart","Zoom","1d","5d","1m","3m","6m","YTD","1y","5y","10y","Max","All","Price","Open","Close","High","Low","Volume","Vol","thous","mil","k","k","m","m","min","h","d","wk","$","\\u00A2",["Dividend: ",1,""],["Dividend: ",1," (",2,")"],"Stock Dividend",["Stock Dividend: ",1,""],["Adjustment Factor: ",1,""],["Split: ",1,""],"Loading","No data available","Premarket","After hours","Interval","2min","5min","30min","1d","1w","daily","weekly",["SMA(",1,"):",2,""],["EMA(",1,"):",2,""],["VMA(",1,"):",2,""],["RSI(",1,")"],["RSI:",1,""],["BIAS(",1,")"],["BIAS:",1,""],["W%R(",1,")"],["%R:",1,""],["MACD(",1,",",2,",",3,")"],["MACD:",1,""],["EMA:",1,""],["DIFF:",1,""],["DEA:",1,""],["Divergence:",1,""],["KDJ(",1,")"],["K:",1,""],["D:",1,""],["J:",1,""],["BOLL(",1,")"],["MID:",1,""],["UPPER:",1,""],["LOWER:",1,""],["FSTO(",1,",",2,")"],["SSTO(",1,",",2,")"],["%K:",1,""],["%D:",1,""],["CCI(",1,")"],["CCI:",1,""],["SMA(",1,",",2,"):",3,""],["EMA(",1,",",2,"):",3,""],["VMA(",1,",",2,"):",3,""],["RSI(",1,",",2,")"],["BIAS(",1,",",2,")"],["W%R(",1,",",2,")"],["MACD(",1,",",2,",",3,",",4,")"],["KDJ(",1,",",2,")"],["BOLL(",1,",",2,")"],["FSTO(",1,",",2,",",3,")"],["SSTO(",1,",",2,",",3,")"],["CCI(",1,",",2,")"],""],Message}();t.Message=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e,i,n;!function(t){t[t.INVALID=-1]="INVALID",t[t.INTRADAY=0]="INTRADAY",t[t.FIVE_MINUTES=1]="FIVE_MINUTES",t[t.HALF_HOUR=2]="HALF_HOUR",t[t.DAILY=3]="DAILY",t[t.WEEKLY=4]="WEEKLY"}(e=t.Intervals||(t.Intervals={})),function(t){t[t.COMPANY=0]="COMPANY",t[t.MUTUAL_FUND=1]="MUTUAL_FUND",t[t.CURRENCY=2]="CURRENCY",t[t.QUERY_INDEX=3]="QUERY_INDEX",t[t.PORTFOLIO=4]="PORTFOLIO",t[t.BACKTESTING=5]="BACKTESTING"}(i=t.QuoteTypes||(t.QuoteTypes={})),function(t){t[t.INVALID=-1]="INVALID",t[t.SCALE_MAX=0]="SCALE_MAX",t[t.SCALE_10Y=1]="SCALE_10Y",t[t.SCALE_5Y=2]="SCALE_5Y",t[t.SCALE_1Y=3]="SCALE_1Y",t[t.SCALE_YTD=4]="SCALE_YTD",t[t.SCALE_6M=5]="SCALE_6M",t[t.SCALE_3M=6]="SCALE_3M",t[t.SCALE_1M=7]="SCALE_1M",t[t.SCALE_5D=8]="SCALE_5D",t[t.SCALE_3D=9]="SCALE_3D",t[t.SCALE_1D=10]="SCALE_1D",t[t.SCALE_CUSTOM=11]="SCALE_CUSTOM"}(n=t.ScaleTypes||(t.ScaleTypes={})),function(t){t[t.ERROR=-1]="ERROR",t[t.NOTHING=0]="NOTHING",t[t.FIRST_DATA=1]="FIRST_DATA",t[t.ADDED_DATA=2]="ADDED_DATA"}(t.AddStreamResults||(t.AddStreamResults={})),function(t){t[t.UP=0]="UP",t[t.DOWN=1]="DOWN",t[t.SIDEWAYS=2]="SIDEWAYS",t[t.SIDEWAYS_UP=2]="SIDEWAYS_UP",t[t.SIDEWAYS_DOWN=3]="SIDEWAYS_DOWN"}(t.Orientations||(t.Orientations={})),function(t){t[t.BACKWARD=1]="BACKWARD",t[t.FORWARD=-1]="FORWARD"}(t.Directions||(t.Directions={})),function(t){t[t.GET_1Y_DATA=0]="GET_1Y_DATA",t[t.GET_5D_DATA=1]="GET_5D_DATA",t[t.GET_2Y_DATA=2]="GET_2Y_DATA",t[t.GET_5Y_DATA=3]="GET_5Y_DATA",t[t.GET_AH_DATA=4]="GET_AH_DATA",t[t.GET_3M_DATA=5]="GET_3M_DATA",t[t.MUTF_5D_DATA=6]="MUTF_5D_DATA",t[t.GET_40Y_DATA=7]="GET_40Y_DATA",t[t.GET_10D_DATA=8]="GET_10D_DATA",t[t.GET_30D_DATA=9]="GET_30D_DATA",t[t.GET_RT_DATA=10]="GET_RT_DATA",t[t.GET_RT_AH_DATA=11]="GET_RT_AH_DATA"}(t.ChartDetailTypes||(t.ChartDetailTypes={})),function(t){t[t.SCROLL_BAR=0]="SCROLL_BAR",t[t.LEFT_BUTTON=1]="LEFT_BUTTON",t[t.RIGHT_BUTTON=2]="RIGHT_BUTTON",t[t.LEFT_HANDLE=3]="LEFT_HANDLE",t[t.RIGHT_HANDLE=4]="RIGHT_HANDLE",t[t.SCROLL_BG=5]="SCROLL_BG"}(t.ControllerComponents||(t.ControllerComponents={})),function(t){t[t.SNAP_DAY=0]="SNAP_DAY",t[t.SNAP_WEEK=1]="SNAP_WEEK",t[t.SNAP_MONTH=2]="SNAP_MONTH",t[t.SNAP_YEAR=3]="SNAP_YEAR"}(t.Snaps||(t.Snaps={})),function(t){t[t.BOTTOM=0]="BOTTOM",t[t.TOP=1]="TOP"}(t.TickPositions||(t.TickPositions={}));var a=function(){return function IntervalPeriod(t,e,i,n,a,r){this.type=t,this.days=e,this.maxdays=i,this.mindays=n,this.text=a,this.logtext=r}}();t.IntervalPeriod=a;var r=function(){return function ScaleInterval(t,e,i,n,a,r){this.type=t,this.days=e,this.months=i,this.text=n,this.logtext=a,this.width=r}}();t.ScaleInterval=r;var o=function(){function Const(){}return Const.getDetailLevelInterval=function(t){return Const.DETAIL_LEVEL_INFO[t]},Const.getIntervalDetailLevel=function(t){return Const.INTERVAL_INFO[t]},Const.getZoomLevel=function(t,e){for(var i=Const.SCALE_INTERVALS,n=i.length-1;i[n].days*e<Math.floor(t)&&n>0;)n--;return n},Const.getQuoteType=function(t){return 0===t.indexOf(Const.CURRENCY_PREFIX)?i.CURRENCY:0===t.indexOf(Const.PORTFOLIO_PREFIX)?i.PORTFOLIO:0===t.indexOf(Const.BACKTESTING_PREFIX)?i.BACKTESTING:0===t.search(Const.MUTUAL_FUND_PREFIX)?i.MUTUAL_FUND:0===t.search(Const.QUERY_INDEX_PREFIX)?i.QUERY_INDEX:i.COMPANY},Const.getDefaultDisplayDays=function(t){if(void 0===t&&(t=!1),-1!==Const.DEFAULT_DISPLAY_MINUTES){var e=t?1:Const.MARKET_DAY_LENGTH;return Const.DEFAULT_DISPLAY_MINUTES/e}return Const.DEFAULT_DISPLAY_DAYS},Const.isZhLocale=function(t){return t===Const.ZH_CN_LOCALE||t===Const.ZH_HK_LOCALE||t===Const.ZH_TW_LOCALE},Const.DETAIL_LEVEL_INFO={},Const.INTERVAL_INFO=[],Const.APPLY_CHINESE_STYLE_MACD=!1,Const.CHART_TYPE_BUTTONS_ENABLED=!1,Const.DEFAULT_DISPLAY_DAYS=3,Const.DEFAULT_DISPLAY_MINUTES=-1,Const.DISPLAY_DIVIDENDS_UNITS="true",Const.DISPLAY_NEWS_PINS=!1,Const.DOT_COLOR=26333,Const.ECN_LINE_CHART_FILL_COLOR=16316664,Const.ECN_LINE_CHART_LINE_COLOR=6710886,Const.ENABLE_COMPACT_FLAGS="false",Const.ENABLE_CUSTOM_DATE_ENTRY="false",Const.EXPAND_BUTTON_ENABLED=!1,Const.INDICATOR_ENABLED=!0,Const.INFO_TEXT_ALIGN="right",Const.INFO_TEXT_TOP_PADDING=0,Const.INTRADAY_INTERVAL=120,Const.LINE_CHART_FILL_COLOR=14807807,Const.LINE_CHART_LINE_COLOR=26333,Const.MIN_DISPLAY_DAYS=1,Const.MOVIE_HEIGHT=0,Const.MOVIE_WIDTH=0,Const.NEGATIVE_DIFFERENCE_COLOR=11141171,Const.POSITIVE_DIFFERENCE_COLOR=32768,Const.RANGE_TEXT_COLOR=10275573,Const.ACTIVE=1,Const.AFTER_HOURS_DISPLAY_NAME="After Hours",Const.AFTER_HOURS_NAME="AFTER_HOURS",Const.AH_DOT_COLOR=6710886,Const.AH_VOLUME_LAYER="AHVolumeLayer",Const.BACKTESTING_PREFIX="BACKTESTING:",Const.BAR_WIDTH_RATIO=.7,Const.BIAS="BIAS",Const.BollingerBands="BollingerBands",Const.BORDER_LINE_COLOR=4473924,Const.BORDER_LINE_OPACITY=1,Const.BORDER_SHADOW_COLOR=13421772,Const.BORDER_WIDTH=2,Const.BOTTOM_TICK_COLOR=0,Const.BOTTOM_VIEW_POINT=2,Const.BOTTOM_VIEW_POINT_NAME="BottomViewPoint",Const.BOTTOM_VIEWPOINT_HEADER_HEIGHT=20,Const.CANDLE_STICK="CandleStickChartLayer",Const.CCI="CCI",Const.COLOR_BLUE=26333,Const.COLOR_GREEN=3381555,Const.COLOR_PINK=16711935,Const.COLOR_RED=13382400,Const.COLOR_YELLOW=16228618,Const.COWBELL_THEME=0,Const.CURRENCY_PREFIX="CURRENCY:",Const.DAILY_DAYS=270,Const.DAILY_INTERVAL=86400,Const.DATA_DELIMITER=",",Const.DATE_DEFAULT_BORDER_COLOR=15263976,Const.DATE_HIGHLIGHTED_BACKGROUND_COLOR=16777120,Const.DATE_HIGHLIGHTED_BORDER_COLOR=0,Const.DAY_LINE_ALPHA=.5,Const.DAY_LINE_COLOR=11189162,Const.DAY_PER_WEEK=7,Const.DAYS=1,Const.DEFAULT_FLAG_HEIGHT=25,Const.DEFAULT_LAST_MARKET_WEEKDAY=5,Const.DEFAULT_MAX_RANGE=10,Const.DEFAULT_P="5d",Const.DEFAULT_Q="NASD:GOOG",Const.DEFAULT_WEEKDAY_BITMAP=62,Const.DIF_MKT_COMPARISON_MIN_DISPLAY_DAYS=30,Const.DYNAMIC="dynamic",Const.ECN_LINE_CHART_FILL_VISIBILITY=.6,Const.ECN_LINE_CHART_LINE_THICKNESS=0,Const.ECN_LINE_CHART_LINE_VISIBILITY=1,Const.EMA="EMA",Const.FastStochastic="FastStochastic",Const.FIVE_MINUTE_DAYS=10,Const.FIVE_MINUTE_INTERVAL=300,Const.FIXED_VSCALE="fixed",Const.FORMAT_COMPACT=0,Const.FORMAT_EPOCH=1,Const.HALF_HOUR_DAYS=30,Const.HALF_HOUR_INTERVAL=1800,Const.HORIZONTAL_GRID_COLOR=14211311,Const.HORIZONTAL_LINE_COLOR=8947848,Const.HOUR_LINE_ALPHA=100,Const.HOUR_LINE_COLOR=16119285,Const.INACTIVE=0,Const.INTRADAY_DAYS=5,Const.KDJ="KDJ",Const.LAST_DAY_CLOSE_LINE_COLOR=11141120,Const.LINE_CHART="IntervalBasedLineChartLayer",Const.LINE_CHART_FILL_VISIBILITY=.6,Const.LINE_CHART_LINE_THICKNESS=0,Const.LINE_CHART_LINE_VISIBILITY=1,Const.LINEAR_VSCALE="Linear",Const.LOADING_WIDTH=60,Const.LOG_SCALE=10,Const.LOG_SCALE_LOG=Math.LN10,Const.LOG_VSCALE="logarithmic",Const.MACD="MACD",Const.MAIN_VIEW_POINT=1,Const.MAIN_VIEW_POINT_NAME="MainViewPoint",Const.MARKET_CLOSE_MINUTE=960,Const.MARKET_DAY_LENGTH=391,Const.MARKET_OPEN_MINUTE=570,Const.MAX_RELOAD_TRIES=1,Const.MAX_VSCALE="maximized",Const.MIN_DAY_WIDTH_FOR_INTRADAY=30,Const.MIN_FLAG_DISTANCE=15,Const.MIN_PER_DAY=1440,Const.MNTS=0,Const.MS_PER_DAY=864e5,Const.MS_PER_MINUTE=6e4,Const.MUTUAL_FUND_PREFIX="MUTF(_.*?)?:",Const.NEW_LOG_VSCALE="Logarithmic",Const.NO_BUTTON_TEXT=-1,Const.NORMAL_THEME=1,Const.OHLC_CHART="OhlcChartLayer",Const.PAGE_LEFT_BUTTON=6,Const.PAGE_RIGHT_BUTTON=7,Const.PASSIVE_LINE_LAYER="PassiveLineLayer",Const.PORTFOLIO_PREFIX="PORTFOLIO:",Const.PRE_MARKET_DISPLAY_NAME="Premarket",Const.PRE_MARKET_NAME="PREMARKET",Const.PRICE_SCALE=0,Const.QUERY_INDEX_PREFIX="GOOGLEINDEX(_.*?)?:",Const.REALTIME_CHART_POLLING_INTERVAL=6e3,Const.REALTIME_CHART_POLLING_MARGIN=60,Const.REGULAR_MARKET_DISPLAY_NAME="",Const.REGULAR_MARKET_NAME="REGULAR_MARKET_HOURS",Const.ROLL_OUT="onRollOut",Const.ROLL_OVER="onRollOver",Const.RSI="RSI",Const.SCALE_BUTTON_HEIGHT=15,Const.SCALE_BUTTON_WIDTH=21,Const.SCROLL_HEIGHT=12,Const.SEC_PER_MINUTE=60,Const.SELECTING_FILL_COLOR=14082790,Const.SELECTING_LINE_COLOR=11125708,Const.SHOW_SPARKLINE="true",Const.SlowStochastic="SlowStochastic",Const.SMA="SMA",Const.SPACE_HEIGHT=25,Const.SPARK_PADDING=6,Const.SPARKLINE_VIEW_POINT_NAME="TopViewPoint",Const.STATIC="static",Const.TECHNICAL_INDICATOR_HEIGHT=80,Const.TOP_TICK_COLOR=7897737,Const.TOP_VIEW_POINT=0,Const.VMA="VMA",Const.VOLUME_CHART="VolumeLinesChartLayer",Const.VOLUME_INDICATOR_NAME="Volume",Const.VOLUME_SCALE=1,Const.VOLUME_SCALES=[100,250,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5,2e5,5e5,1e6,2e6,5e6,1e7],Const.WEEKDAY_PER_WEEK=5,Const.WEEKLY_INTERVAL=604800,Const.WilliamsPercentR="WilliamsPercentR",Const.WINDOW_LAYER="WindowLayer",Const.YEAR_2000=9466848e5,Const.YSCALE_INTERVALS=[1e-5,25e-6,5e-5,1e-4,25e-5,5e-4,.001,.0025,.005,.01,.025,.05,.1,.25,.5,1,2,5,10,20,50,100,200,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5,2e5,5e5,1e6,2e6,5e6,1e7,2e7,5e7,1e8,2e8,5e8,1e9,2e9,5e9,1e10,2e10,5e10,1e11,2e11,5e11,1e12,2e12,5e12,1e13,2e13,5e13,1e14,2e14,5e14,1e15,2e15,5e15,1e16,2e16,5e16,1e17,2e17,5e17,1e18,2e18,5e18],Const.ZERO_PERCENT_LINE_COLOR=8015181,Const.ZH_CN_LOCALE="zh_CN",Const.ZH_HK_LOCALE="zh_HK",Const.ZH_TW_LOCALE="zh_TW",Const.REALTIME_CHART_ENABLED=!1,Const.SHRINK_BUTTON_ENABLED=!1,Const.SPARK_ACTIVE_FILL_COLOR=15595519,Const.SPARK_ACTIVE_LINE_COLOR=26333,Const.SPARK_INACTIVE_FILL_COLOR=16316664,Const.SPARK_INACTIVE_LINE_COLOR=14540253,Const.SPARKLINE_HEIGHT=58,Const.TEXT_BACKGROUND_COLOR=12967159,Const.VOLUME_HIGHLIGHT_COLOR=3368703,Const.VOLUME_PLUS_ENABLED=!1,Const.INDICATOR_PARAMETERS={BIAS:[{period:14}],CCI:[{period:20}],KDJ:[{period:14}],MACD:[{shortPeriod:12,longPeriod:26,emaPeriod:9}],RSI:[{period:14}],SMA:[{period:20}],EMA:[{period:20}],VMA:[{period:20}],WilliamsPercentR:[{period:14}],BollingerBands:[{period:20}],FastStochastic:[{kPeriod:14,dPeriod:3}],SlowStochastic:[{kPeriod:14,dPeriod:3}]},Const.SCALE_INTERVALS=[new r(n.SCALE_MAX,1e4,480,t.Messages.ZOOM_ALL,"max",24),new r(n.SCALE_10Y,3100,120,t.Messages.ZOOM_10Y,"10y",20),new r(n.SCALE_5Y,1550,60,t.Messages.ZOOM_5Y,"5y",17),new r(n.SCALE_1Y,250,12,t.Messages.ZOOM_1Y,"1y",17),new r(n.SCALE_YTD,180,100,t.Messages.ZOOM_YTD,"ytd",24),new r(n.SCALE_6M,120,6,t.Messages.ZOOM_6M,"6m",17),new r(n.SCALE_3M,60,3,t.Messages.ZOOM_3M,"3m",17),new r(n.SCALE_1M,20,1,t.Messages.ZOOM_1M,"1m",17),new r(n.SCALE_5D,5,0,t.Messages.ZOOM_5D,"5d",15),new r(n.SCALE_3D,3,0,Const.NO_BUTTON_TEXT,"3d",0),new r(n.SCALE_1D,1,0,t.Messages.ZOOM_1D,"1d",15)],Const.CHART_STYLE_NAMES=[Const.LINE_CHART,Const.CANDLE_STICK,Const.OHLC_CHART],Const.OHLC_DEPENDENT_INDICATOR_NAMES=[Const.WilliamsPercentR,Const.KDJ,Const.FastStochastic,Const.SlowStochastic,Const.CCI],Const.DETAIL_LEVELS=[e.INTRADAY,e.FIVE_MINUTES,e.HALF_HOUR,e.DAILY,e.WEEKLY],Const.INDEPENDENT_INDICATOR_NAMES=[Const.MACD,Const.RSI,Const.WilliamsPercentR,Const.KDJ,Const.BIAS,Const.FastStochastic,Const.SlowStochastic,Const.CCI],Const.VOLUME_DEPENDENT_INDICATOR_NAMES=[Const.VMA],Const.DEPENDENT_INDICATOR_NAMES=[Const.SMA,Const.EMA,Const.BollingerBands],Const.VOLUME_PLUS_CHART_TYPE=[Const.CANDLE_STICK,Const.OHLC_CHART],Const.INTERVAL_PERIODS=[new a(e.INTRADAY,1,1,.2,t.Messages.INTERVAL_2_MINUTES,"2min"),new a(e.FIVE_MINUTES,2,3,.4,t.Messages.INTERVAL_5_MINUTES,"5min"),new a(e.HALF_HOUR,10,15,2,t.Messages.INTERVAL_30_MINUTES,"30min"),new a(e.DAILY,120,200,24,t.Messages.INTERVAL_DAILY,"daily"),new a(e.WEEKLY,600,1e3,120,t.Messages.INTERVAL_WEEKLY,"weekly")],Const.DEFAULT_D=e.DAILY,Const.DEFAULT_I=""+Const.INTRADAY_INTERVAL,Const.DEFAULT_CHART_STYLE_NAME=Const.LINE_CHART,Const._staticConstructor=(Const.INTERVAL_INFO[Const.INTRADAY_INTERVAL]=e.INTRADAY,Const.INTERVAL_INFO[Const.FIVE_MINUTE_INTERVAL]=e.FIVE_MINUTES,Const.INTERVAL_INFO[Const.HALF_HOUR_INTERVAL]=e.HALF_HOUR,Const.INTERVAL_INFO[Const.DAILY_INTERVAL]=e.DAILY,Const.INTERVAL_INFO[Const.WEEKLY_INTERVAL]=e.WEEKLY,Const.DETAIL_LEVEL_INFO[e.INTRADAY]=Const.INTRADAY_INTERVAL,Const.DETAIL_LEVEL_INFO[e.FIVE_MINUTES]=Const.FIVE_MINUTE_INTERVAL,Const.DETAIL_LEVEL_INFO[e.HALF_HOUR]=Const.HALF_HOUR_INTERVAL,Const.DETAIL_LEVEL_INFO[e.DAILY]=Const.DAILY_INTERVAL,void(Const.DETAIL_LEVEL_INFO[e.WEEKLY]=Const.WEEKLY_INTERVAL)),Const}();t.Const=o}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(e){var i;!function(t){t[t.NOTHING=0]="NOTHING",t[t.DRAGGING=1]="DRAGGING",t[t.SELECTING=2]="SELECTING",t[t.ZOOMING_OUT=3]="ZOOMING_OUT",t[t.SCROLLING=4]="SCROLLING",t[t.DRAGGING_LEFT_HANDLE=5]="DRAGGING_LEFT_HANDLE",t[t.DRAGGING_RIGHT_HANDLE=6]="DRAGGING_RIGHT_HANDLE",t[t.PRESSING_LEFT=7]="PRESSING_LEFT",t[t.PRESSING_RIGHT=8]="PRESSING_RIGHT",t[t.WINDOW=9]="WINDOW",t[t.PRESSING_PAGE_LEFT=10]="PRESSING_PAGE_LEFT",t[t.PRESSING_PAGE_RIGHT=11]="PRESSING_PAGE_RIGHT",t[t.DRAGGING_SPARKLINE=12]="DRAGGING_SPARKLINE"}(i=e.ControllerStates||(e.ControllerStates={}));var n=function(n){function Controller(a,r){var o=n.call(this)||this;return o.mainManager=a,o.displayManager=r,o.PAGING_AREA_WIDTH=100,o.MOUSE_DOWN=!1,o.BUTTON_MOVEBY_AMOUNT=40,o.MIN_PIXELS=2,o.SHIFT_DOWN=!1,o.CTRL_DOWN=!1,o.pagingAmount=0,o.aniManager=new e.AnimationManager,o.holderBounds=new e.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),o.state=i.NOTHING,o.cumulativeXOffset=0,o.controlledAreaBounds=[],o.listeners=[],o.isZh=e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale()),o.mouseEnabled=!0,o.buttonTextFormat=new flash.text.TextFormat("Verdana",o.isZh?10:9,204),o.buttonTextFormat.underline=!0,o.promotedButtonTextFormat=new flash.text.TextFormat("Verdana",o.isZh?10:9,14290192),o.promotedButtonTextFormat.underline=!0,o.selectedTextFormat=new flash.text.TextFormat("Verdana",o.isZh?10:9,0),o.selectedTextFormat.underline=!1,o.windowTitleTextFormat=new flash.text.TextFormat("Verdana",10,0),o.windowTitleTextFormat.underline=!1,o.windowTitleTextFormat.bold=!0,o.separatorTextFormat=new flash.text.TextFormat("Verdana",9,0),e.Const.INDICATOR_ENABLED&&e.Const.CHART_TYPE_BUTTONS_ENABLED&&a.getQuoteType()===e.QuoteTypes.COMPANY&&o.createChartTypeButtons(),o.createZoomButtons(),o.createIntervalButtons(),o.enableZoomButtons(),e.Const.EXPAND_BUTTON_ENABLED?o.createChartSizeChangeButton(!0):e.Const.SHRINK_BUTTON_ENABLED&&o.createChartSizeChangeButton(!1),o.addChild(o.aniManager),o.currentZoomLevel=o.getInitialZoomLevel(),o}return __extends(Controller,n),Controller.prototype.movePage=function(t){var e=this.displayManager.getMainViewPoint();e&&this.notifyListenersToMove(t*(e.maxx-e.minx))},Controller.prototype.getInitialZoomLevel=function(){if(-1!==e.Const.DEFAULT_DISPLAY_MINUTES)return-1;for(var t=0;t<e.Const.SCALE_INTERVALS.length;t++)if(e.Const.SCALE_INTERVALS[t].days===e.Const.DEFAULT_DISPLAY_DAYS&&t>=e.ScaleTypes.SCALE_5D)return t;return e.ScaleTypes.INVALID},Controller.prototype.createChartSizeChangeButton=function(t){var i=this;this.chartSizeChangeToolTip&&this.contains(this.chartSizeChangeToolTip)&&this.removeChild(this.chartSizeChangeToolTip),this.chartSizeChangeButton&&this.contains(this.chartSizeChangeButton)&&this.removeChild(this.chartSizeChangeButton),this.chartSizeChangeButton=new flash.display.SimpleButton("chartSizeChangeButton");var n=t?new e.Controller_ExpandIcon:new e.Controller_ShrinkIcon;this.chartSizeChangeButton.overState=n,this.chartSizeChangeButton.downState=n,this.chartSizeChangeButton.hitTestState=n,this.chartSizeChangeButton.upState=n,this.chartSizeChangeButton.useHandCursor=!0,this.chartSizeChangeButton.x=this.mainManager.stage.stageWidth-this.chartSizeChangeButton.width-5,this.chartSizeChangeButton.y=5,this.addChild(this.chartSizeChangeButton),this.chartSizeChangeToolTip=new e.ToolTipMovie,this.addChild(this.chartSizeChangeToolTip),this.chartSizeChangeButton.addEventListener(MouseEvents.MOUSE_OVER,function(n){e.MainManager.mouseCursor.setCursor(e.MouseCursors.CLASSIC),e.MainManager.mouseCursor.lockOnDisplayObject(i.chartSizeChangeButton),i.chartSizeChangeToolTip.renderMovie(i.chartSizeChangeButton.x-5,i.chartSizeChangeButton.y,t?e.Message.getMsg(e.Messages.LARGE_CHART):e.Message.getMsg(e.Messages.SMALL_CHART)),flash.display.Graphics.cleanupPending()}),this.chartSizeChangeButton.addEventListener(MouseEvents.MOUSE_OUT,function(t){e.MainManager.mouseCursor.unlock(),i.chartSizeChangeToolTip.clearMovie(),flash.display.Graphics.cleanupPending()}),this.chartSizeChangeButton.addEventListener(MouseEvents.CLICK,function(i){t?e.MainManager.jsProxy.expandChart():e.MainManager.jsProxy.shrinkChart(),flash.display.Graphics.cleanupPending()})},Controller.prototype.applyLastOrDefaultInterval=function(t,i){this.lastIntervalLevel!==e.Intervals.INVALID&&this.lastIntervalLevel<=e.Intervals.WEEKLY?(this.enableIntervalButtons(this.lastIntervalLevel),this.currentIntervalLevel=this.lastIntervalLevel,this.animateTo(this.lastLastMinutes,this.lastCount,1)):(this.enableIntervalButtons(e.Const.DEFAULT_D),this.currentIntervalLevel=e.Const.DEFAULT_D,i.checkEvents(),t&&this.animateTo(0,e.Const.INTERVAL_PERIODS[e.Const.DEFAULT_D].days*(t.data.marketDayLength+1),1))},Controller.prototype.onMouseMove=function(t){this.stage.setMouse(t.pageX,t.pageY);var e=getTimer();e-this.lastMouseMoveTime<16||(this.lastMouseMoveTime=e,this.mouseMoveAction(t))},Controller.prototype.removeControlListener=function(t){for(var e=0;e<this.listeners.length;e++)if(this.listeners[e]===t)return void this.listeners.splice(e,1)},Controller.prototype.triggerMouseMoveAction=function(){this.mouseMoveAction(new MouseEvent(MouseEvents.MOUSE_MOVE))},Controller.prototype.getCountForDays=function(t,i,n){var a=t.data.units,r=t.data.days,o=t.getEndOfDayDataUnitFor(n),s=e.DataSource.getMinuteMetaIndex(o.relativeMinutes,r,a),l=0,h=0,c=a[r[s=Math.min(s,r.length-1)]].relativeMinutes,u=t.getEndOfDayDataUnitFor(c);for(0!==e.Utils.compareUtcDates(u.exchangeDateInUTC,o.exchangeDateInUTC)&&(l+=t.afterHoursData.getSessionLength(e.Const.PRE_MARKET_NAME)+1);s>=0&&h<i;){var d=a[r[--s]];u.coveredDays>0?(l+=u.coveredDays*(t.data.marketDayLength+1),h+=u.coveredDays):d?(d=t.getEndOfDayDataUnitFor(d.relativeMinutes),l+=u.relativeMinutes-d.relativeMinutes,h++):(l+=t.data.marketDayLength+1,h++),u=d}return l+=(i-h)*(t.data.marketDayLength+1)},Controller.prototype.moveListenersByOffsets=function(){var t=this.displayManager.getMainViewPoint();if(t){var e=this.displayManager.getSparklineViewPoint(),i=e.getWidth(),n=e.sparkCount*(t.maxx-t.minx)/t.count,a=e.moveSparklineBy_Handler(this.cumulativeXOffset),r=(this.baseXOffset-a)*n/i;this.changeListenersOffset(r)}},Controller.prototype.handleMouseWheel=function(t){if(0!==t){var i=Math.abs(t);t>0?this.zoomStuff(e.Directions.FORWARD,this.mouseX,i):t<0&&this.zoomStuff(e.Directions.BACKWARD,this.mouseY,i),clearInterval(this.notifyHtmlIntervalId),this.notifyHtmlIntervalId=setInterval(this.listenersNotifyHtml.bind(this),Controller.NOTIFY_TIMEOUT)}},Controller.prototype.hitTestInsideBounds=function(t,e){for(var i=0,n=this.controlledAreaBounds;i<n.length;i++){if(n[i].containsPoint(t,e))return!0}return!1},Controller.prototype.checkSparklinePositioning=function(){var t=this.displayManager.getSparklineViewPoint(),i=this.displayManager.getMainViewPoint();if(t&&i&&t.windowLayer){var n=t.windowLayer.getLeftX(),a=t.windowLayer.getRightX(),r=this.displayManager.layersManager.getFirstDataSource(),o=t.getSparkLastMinute()<0,s=t.getSparkFirstMinute()>t.getOldestMinute();if(this.currentIntervalLevel!==e.Intervals.INVALID&&r){var l=r.getFirstRelativeMinute(this.currentIntervalLevel);s=t.getSparkFirstMinute()>l}s&&n<t.minx+this.PAGING_AREA_WIDTH?(t.moveSparklineBy_Handler(n-(t.minx+this.PAGING_AREA_WIDTH)),t.commitSparklineOffset_Handler()):o&&a>t.maxx-this.PAGING_AREA_WIDTH&&(t.moveSparklineBy_Handler(a-(t.maxx-this.PAGING_AREA_WIDTH)),t.commitSparklineOffset_Handler())}},Controller.prototype.setNewFinalState=function(t,e){if(void 0===e&&(e=!1),void 0!==t.lastMinute&&void 0!==t.count)if(this.aniManager.isAnimating())for(var i=0,n=this.listeners;i<n.length;i++){n[i].newFinalAnimationState(t)}else this.jumpTo(t.lastMinute,t.count,e)},Controller.prototype.animateTo=function(t,i,n,a){void 0===n&&(n=NaN),void 0===a&&(a=!1);var r=[],o=[],s=new e.Context;s.lastMinute=t,s.count=i;for(var l=0;l<this.listeners.length;l++){this.listeners[l].zoomingAnimation_init(s);var h=this.listeners[l];r[l]=h.zoomingAnimation_ticker.bind(h),o[l]=h}var c=this.displayManager.topBorderLayer;r[this.listeners.length]=c.update.bind(c),o[this.listeners.length]=c,this.aniManager.animate(r,o,n,a)},Controller.prototype.chartTypeButtonClicked=function(t){e.MainManager.jsProxy.setJsChartType(this.chartTypeNameMapping[t])},Controller.prototype.onMouseUp=function(t){this.mouseUpAction()},Controller.prototype.syncZoomLevel=function(t){if(this.state!==i.SCROLLING&&!this.displayManager.isDifferentMarketSessionComparison()){var e=this.getZoomLevelFinalState(this.currentZoomLevel);e&&this.setNewFinalState(e,t)}},Controller.prototype.createChartTypeButtons=function(){this.chartTypeText=new flash.text.TextField,this.chartTypeText.x=5,this.chartTypeText.y=5,this.chartTypeText.autoSize=flash.text.TextFieldAutoSize.LEFT,this.chartTypeText.defaultTextFormat=this.windowTitleTextFormat,this.chartTypeText.text=e.Message.getMsg(e.Messages.TYPE)+":",this.chartTypeText.selectable=!1,this.chartTypeButtons=new e.ui.TextButtonsGroup,this.chartTypeButtons.setSpacing("",this.isZh?1:3),this.chartTypeButtons.setTextFormats(this.buttonTextFormat,this.selectedTextFormat,this.separatorTextFormat),this.chartTypeButtons.x=this.chartTypeText.x+this.chartTypeText.width+this.chartTypeButtons.spacing,this.chartTypeButtons.y=this.chartTypeText.y,this.chartTypeButtons.addButton(e.Message.getMsg(e.Messages.LINE)),this.chartTypeButtons.addButton(e.Message.getMsg(e.Messages.CANDLESTICK),this.promotedButtonTextFormat),this.chartTypeNameMapping={},this.chartTypeNameMapping[e.Message.getMsg(e.Messages.LINE)]="IntervalBasedLine",this.chartTypeNameMapping[e.Message.getMsg(e.Messages.CANDLESTICK)]="CandleStick",this.chartTypeButtons.selectButtonByIndex(e.Const.CHART_STYLE_NAMES.indexOf(e.Const.DEFAULT_CHART_STYLE_NAME)),this.chartTypeButtons.addListener(this.chartTypeButtonClicked,this),this.addChild(this.chartTypeText),this.addChild(this.chartTypeButtons)},Controller.prototype.mouseMoveAction=function(t){var n=this,a=!1,r=!1,o=this.displayManager.getMainViewPoint(),s=this.displayManager.getSparklineViewPoint();switch(this.state){case i.SELECTING:this.drawSquare(this.initialXMouse,this.initialYMouse,this.mouseX,this.mouseY);break;case i.DRAGGING:this.displayManager.showContextualStaticInfo(),this.changeListenersOffset(this.mouseX-this.initialXMouse),this.checkSparklinePositioning();break;case i.NOTHING:if(this.hitTestInsideBounds(this.mouseX,this.mouseY)&&!o.isAnimating()){this.displayManager.spaceText.setPointInfo(this.highlightPoints()),e.MainManager.mouseCursor.setCursor(e.MouseCursors.OPENED_HAND);break}if(s.windowLayer&&t.target!==s.windowLayer.leftHandle.button.element&&t.target!==s.windowLayer.rightHandle.button.element&&e.MainManager.mouseCursor.setCursor(e.MouseCursors.CLASSIC),this.clearAllHighlights(),this.displayManager.showContextualStaticInfo(),s.bg.hitTestPoint(this.mouseX,this.mouseY,!1)){s.toggleHandles(!0);break}s.toggleHandles(!1);break;case i.DRAGGING_SPARKLINE:this.mouseCursor.setCursor(e.MouseCursors.CLOSED_HAND),s.moveSparklineBy_Handler(this.initialXMouse-this.mouseX);break;case i.SCROLLING:this.displayManager.showContextualStaticInfo();var l=this.mouseX;l=Math.max(l,this.scrollMouseMinX),l=Math.min(l,this.scrollMouseMaxX),this.baseXOffset=this.initialXMouse-l;var h=this.displayManager.layersManager.getFirstDataSource();if(a=s.getSparkLastMinute()<0,r=s.getSparkFirstMinute()>s.getOldestMinute(),this.currentIntervalLevel!==e.Intervals.INVALID&&h){var c=h.getFirstRelativeMinute(this.currentIntervalLevel);r=s.getSparkFirstMinute()>c}if(l<this.scrollMouseMinX+this.PAGING_AREA_WIDTH&&r){this.pagingAmount=l-(this.scrollMouseMinX+this.PAGING_AREA_WIDTH),this.addXOffset(this,this.pagingAmount),clearInterval(this.intId),this.intId=setInterval(function(){n.addXOffset(n,n.pagingAmount)},20);break}if(l>=this.scrollMouseMaxX-this.PAGING_AREA_WIDTH&&a){this.pagingAmount=l-(this.scrollMouseMaxX-this.PAGING_AREA_WIDTH),this.addXOffset(this,this.pagingAmount),clearInterval(this.intId),this.intId=setInterval(function(){n.addXOffset(n,n.pagingAmount)},20);break}this.stopContinuousPaging(),this.moveListenersByOffsets();break;case i.DRAGGING_LEFT_HANDLE:this.mouseCursor.setCursor(e.MouseCursors.H_ARROWS),s.windowLayer.initialX=this.initialXMouse,s.windowLayer.leftHandleXOffset=this.initialXMouse-this.mouseX,s.windowLayer.renderLayer(),this.displayManager.spaceText.setTimePeriod(s.windowLayer);break;case i.DRAGGING_RIGHT_HANDLE:this.mouseCursor.setCursor(e.MouseCursors.H_ARROWS),s.windowLayer.initialX=this.initialXMouse,s.windowLayer.rightHandleXOffset=this.initialXMouse-this.mouseX,s.windowLayer.renderLayer(),this.displayManager.spaceText.setTimePeriod(s.windowLayer)}this.displayManager.topBorderLayer&&this.displayManager.topBorderLayer.update()},Controller.prototype.addControlListener=function(t,i){void 0===i&&(i=NaN),i===e.TickPositions.BOTTOM?this.listeners.push(t):this.listeners.splice(0,0,t)},Controller.prototype.getButtonsWidth=function(){return this.zoomButtons&&this.intervalButtons?Math.max(this.zoomButtons.x+this.zoomButtons.width,this.intervalButtons.x+this.intervalButtons.width):0},Controller.prototype.listenersNotifyHtml=function(){for(var t=0,e=this.listeners;t<e.length;t++){e[t].HTMLnotify()}clearInterval(this.notifyHtmlIntervalId)},Controller.prototype.shouldRequestAfterHoursData=function(t,i,n,a){return!t||(i<=e.Const.REALTIME_CHART_POLLING_MARGIN||i>=a-n-e.Const.REALTIME_CHART_POLLING_MARGIN)},Object.defineProperty(Controller.prototype,"mouseCursor",{get:function(){return e.MainManager.mouseCursor},enumerable:!0,configurable:!0}),Controller.prototype.createIntervalButtons=function(){this.intervalText=new flash.text.TextField,this.intervalText.x=this.chartTypeButtons?this.chartTypeButtons.x+this.chartTypeButtons.width+5:5,this.intervalText.y=5,this.intervalText.autoSize=flash.text.TextFieldAutoSize.LEFT,this.intervalText.defaultTextFormat=this.windowTitleTextFormat,this.intervalText.text=e.Message.getMsg(e.Messages.INTERVAL)+":",this.intervalText.selectable=!1,this.intervalButtons=new e.ui.TextButtonsGroup,this.intervalButtons.setSpacing("",this.isZh?1:3),this.intervalButtons.setTextFormats(this.buttonTextFormat,this.selectedTextFormat,this.separatorTextFormat),this.intervalButtons.x=this.intervalText.x+this.intervalText.width+this.intervalButtons.spacing,this.intervalButtons.y=this.intervalText.y;for(var t=0,i=e.Const.INTERVAL_PERIODS;t<i.length;t++){var n=i[t];n.days>=e.Const.MIN_DISPLAY_DAYS&&this.intervalButtons.addButton(e.Message.getMsg(n.text))}this.intervalButtons.addListener(this.intervalButtonClicked,this)},Controller.prototype.jumpTo=function(t,i,n){void 0===n&&(n=!1);var a=new e.Context;a.lastMinute=t,a.count=i;for(var r=0,o=this.listeners;r<o.length;r++){var s=o[r];a=s.getNewContext(t,i),s.zoomInMinutes_Handler(a,n)}},Controller.prototype.adjustCountForAfterHours=function(t,i,n,a){if(n===e.Intervals.INTRADAY&&a>e.Intervals.INTRADAY)for(var r=0;r<i.visibleExtendedHours.length();r++){var o=i.visibleExtendedHours.getIntervalAt(r),s=i.afterHoursData.units[o.start];t-=i.afterHoursData.units[o.end].dayMinute-s.dayMinute}else if(n>e.Intervals.INTRADAY&&a===e.Intervals.INTRADAY)for(r=0;r<i.hiddenExtendedHours.length();r++){o=i.hiddenExtendedHours.getIntervalAt(r),s=i.afterHoursData.units[o.start];t+=i.afterHoursData.units[o.end].dayMinute-s.dayMinute}return t},Controller.prototype.resetZoomButtons=function(t){if(this.zoomButtons){this.zoomButtons.clearSelection(),this.zoomButtons.resetButtonsGroup();for(var i=e.Const.SCALE_INTERVALS,n=i.length-1;n>=0;n--)i[n].days>=t&&i[n].text!==e.Const.NO_BUTTON_TEXT&&this.zoomButtons.addButton(e.Message.getMsg(i[n].text));this.zoomButtons.addListener(this.zoomButtonClicked,this)}},Controller.prototype.computeHolderBounds=function(){this.holderBounds=new e.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0);for(var t=0,i=this.controlledAreaBounds;t<i.length;t++){var n=i[t];this.holderBounds.append(n)}},Controller.prototype.clearCurrentInterval=function(){this.currentIntervalLevel=e.Intervals.INVALID,this.intervalButtons.clearSelection()},Controller.prototype.clearCurrentZoom=function(){this.currentZoomLevel=e.ScaleTypes.INVALID,this.zoomButtons.clearSelection()},Controller.prototype.initPollingTimer=function(){e.Const.INDICATOR_ENABLED&&e.Const.REALTIME_CHART_ENABLED&&-1===this.mainManager.quote.indexOf("INDEXDJX")&&(this.isMarketOpen=1===Number(e.MainManager.paramsObj.isMarketOpenState),this.stateRemainingMinutes=e.MainManager.paramsObj.stateRemainingMinutes>=0?e.MainManager.paramsObj.stateRemainingMinutes:Number.MAX_VALUE,this.delayedMinutes=e.MainManager.paramsObj.delayedMinutes>=0?e.MainManager.paramsObj.delayedMinutes:0,this.pollingTimer=new flash.utils.Timer(e.Const.REALTIME_CHART_POLLING_INTERVAL),this.pollingTimer.addEventListener(TimerEvents.TIMER,flash.display.Stage.bind(this.pollingTimerHandler,this)),this.pollingTimer.start())},Controller.prototype.onMouseLeave=function(t){e.MainManager.jsProxy.setChartFocus(!1),e.MainManager.mouseCursor.setCursor(e.MouseCursors.CLASSIC),this.clearAllHighlights(),this.displayManager.showContextualStaticInfo()},Controller.prototype.mouseUpAction=function(){var t=this.displayManager.getSparklineViewPoint();switch(this.state){case i.SELECTING:for(var n=Math.min(this.initialXMouse,this.mouseX),a=Math.max(this.initialXMouse,this.mouseX),r=0,o=this.listeners;r<o.length;r++){o[r].zoomIn_Handler(n,a)}this.listenersNotifyHtml(),this.graphics.clear();break;case i.ZOOMING_OUT:case i.PRESSING_LEFT:case i.PRESSING_RIGHT:case i.PRESSING_PAGE_RIGHT:case i.PRESSING_PAGE_LEFT:clearInterval(this.intId);break;case i.DRAGGING:case i.SCROLLING:if(clearInterval(this.intId),t.moveSparklineBy_Handler(this.cumulativeXOffset+this.pagingAmount),t.commitSparklineOffset_Handler(),this.cumulativeXOffset=0,this.pagingAmount=0,this.commitListenersOffset(),Math.abs(this.initialXMouse-this.mouseX)>=this.MIN_PIXELS){for(var s=0,l=this.listeners;s<l.length;s++){l[s].HTMLnotify()}break}break;case i.DRAGGING_LEFT_HANDLE:t.windowLayer.handleReleased(t.windowLayer.leftHandle);break;case i.DRAGGING_RIGHT_HANDLE:t.windowLayer.handleReleased(t.windowLayer.rightHandle);break;case i.WINDOW:return}this.mouseCursor.setCursor(e.MouseCursors.CLASSIC);for(var h=0,c=this.displayManager.getViewPoints();h<c.length;h++){var u=c[h];u.bg.hitTestPoint(this.mouseX,this.mouseY,!1)&&!u.isAnimating()&&e.MainManager.mouseCursor.setCursor(e.MouseCursor.DRAGGABLE_CURSOR)}this.displayManager.topBorderLayer.update(),this.state=i.NOTHING,this.MOUSE_DOWN=!1},Controller.prototype.clearAllHighlights=function(){for(var t=0,e=this.displayManager.getViewPoints();t<e.length;t++){e[t].clearPointInformation()}},Controller.prototype.moveSparkline=function(t){var e=this.displayManager.getSparklineViewPoint();e.moveSparklineBy_Handler(10*t),e.commitSparklineOffset_Handler(),this.displayManager.topBorderLayer.update()},Controller.prototype.zoomButtonClicked=function(t){var i=this.displayManager.layersManager.getFirstDataSource();if(i&&!i.isEmpty()){for(var n=e.Const.SCALE_INTERVALS,a=n.length-1;a>=0&&e.Message.getMsg(n[a].text)!==t;)a--;-1!==a&&(e.MainManager.jsProxy.logZoomButtonClick(n[a].logtext),this.animateToLevel(a))}},Controller.prototype.addXOffset=function(t,e){notnull(t.displayManager.getSparklineViewPoint()).sparklinePagingPossible(e)?(t.cumulativeXOffset+=e,t.moveListenersByOffsets()):t.stopContinuousPaging()},Controller.prototype.findBestFitDetailLevel=function(t,i){if(!t||!i)return e.Intervals.INVALID;var n=t.getFirstMinute(),a=t.count;if(this.isFitDetailLevel(this.lastIntervalLevel,i,n,a))return this.lastIntervalLevel;for(var r=e.Intervals.INTRADAY;r<=e.Intervals.WEEKLY;r++)if(this.isFitDetailLevel(r,i,n,a))return r;return e.Intervals.INVALID},Controller.prototype.drawSquare=function(t,i,n,a){var r=this.graphics;r.clear(),r.beginFill(e.Const.SELECTING_FILL_COLOR,.4),r.lineStyle(0,e.Const.SELECTING_LINE_COLOR,1),r.drawRect(t,this.holderBounds.miny,n-t,this.holderBounds.maxy-this.holderBounds.miny),r.endFill()},Controller.prototype.replaceBounds=function(t,e){var i=this.getBoundsIndex(t);-1!==i&&this.controlledAreaBounds.splice(i,1),this.controlledAreaBounds.push(e),this.computeHolderBounds()},Controller.prototype.commitListenersOffset=function(){for(var t=0,e=this.listeners;t<e.length;t++){e[t].commitOffset_Handler()}},Controller.prototype.getCustomScaleZoomLevel=function(t,i,n){if(!i||!n||i>=n)return null;var a=t.data.units,r=e.DataSource.getTimeIndex(i.getTime(),a),o=a[e.DataSource.getTimeIndex(n.getTime(),a)].relativeMinutes;return{lastMinute:o,count:o-a[r].relativeMinutes}},Controller.prototype.setMinDisplayDays=function(t){var i=this.displayManager.getMainViewPoint();if(i){var n=i.getFirstMinute(),a=i.getLastMinute(),r=this.mainManager.layersManager.getFirstDataSource();if(r){var o=r.getEndOfDayDataUnitFor(a).relativeMinutes,s=this.getCountForDays(r,t,o);e.Const.MIN_DISPLAY_DAYS=t,s>a-n&&this.animateTo(o,s)}}},Controller.prototype.notifyListenersToMove=function(t){this.changeListenersOffset(t),this.checkSparklinePositioning(),this.commitListenersOffset(),this.displayManager.showContextualStaticInfo(),this.displayManager.topBorderLayer.update(),clearInterval(this.notifyHtmlIntervalId),this.notifyHtmlIntervalId=setInterval(flash.display.Stage.bind(this.listenersNotifyHtml,this),Controller.NOTIFY_TIMEOUT)},Controller.prototype.stopContinuousPaging=function(){clearInterval(this.intId),this.pagingAmount=0},Controller.prototype.enableZoomButtons=function(){this.contains(this.zoomButtons)||(this.addChild(this.zoomText),this.addChild(this.zoomButtons),this.contains(this.intervalButtons)&&(this.removeChild(this.intervalButtons),this.removeChild(this.intervalText)),this.clearCurrentInterval())},Controller.prototype.pollingTimerHandler=function(t){var i=this.displayManager.layersManager.getFirstDataSource();if(i&&!i.isEmpty()){var n=i.data.marketCloseMinute-i.data.marketOpenMinute,a=this.getNewMarketState(this.isMarketOpen,this.stateRemainingMinutes,n);if(this.isMarketOpen=a.isMarketOpen,this.stateRemainingMinutes=a.stateRemainingMinutes,i.data.hasPointsInIntervalArray(e.Const.INTRADAY_INTERVAL)&&this.shouldRequestRegularMarketData(this.isMarketOpen,this.stateRemainingMinutes,this.delayedMinutes,n)){var r=e.EventFactory.getEvent(e.ChartDetailTypes.GET_RT_DATA,i.quoteName,e.ChartEventPriorities.POLLING);this.mainManager.dataManager.eventHandler(r)}if(Boolean(e.MainManager.paramsObj.hasExtendedHours)&&i.afterHoursData.hasPointsInIntervalArray(e.Const.INTRADAY_INTERVAL)&&this.shouldRequestAfterHoursData(this.isMarketOpen,this.stateRemainingMinutes,this.delayedMinutes,n)){var o=e.EventFactory.getEvent(e.ChartDetailTypes.GET_RT_AH_DATA,i.quoteName,e.ChartEventPriorities.POLLING);this.mainManager.dataManager.eventHandler(o)}}else this.pollingTimer.stop()},Controller.prototype.updateChartSizeChangeButtonPosition=function(){this.chartSizeChangeButton&&(this.chartSizeChangeButton.x=this.mainManager.stage.stageWidth-this.chartSizeChangeButton.width-5)},Controller.prototype.toggleZoomIntervalButtons=function(t,i){if(t!==i){this.chartTypeButtons&&this.chartTypeButtons.selectButtonByIndex(e.Const.CHART_STYLE_NAMES.indexOf(i));var n=this.displayManager.getMainViewPoint();if(t===e.Const.LINE_CHART){var a=this.displayManager.layersManager.getFirstDataSource();if(a&&n.getFirstMinute()<a.firstOpenRelativeMinutes)return void this.applyLastOrDefaultInterval(a,n);if(this.displayManager.getDetailLevel()<e.Intervals.DAILY&&Boolean(e.MainManager.paramsObj.displayExtendedHours))return void this.applyLastOrDefaultInterval(a,n);var r=this.findBestFitDetailLevel(n,a);r===e.Intervals.INVALID?this.applyLastOrDefaultInterval(a,n):(this.enableIntervalButtons(r),this.currentIntervalLevel=r,n.checkEvents())}else i===e.Const.LINE_CHART&&(this.lastIntervalLevel=this.currentIntervalLevel,this.lastCount=n.count,this.lastLastMinutes=n.lastMinute,this.enableZoomButtons())}},Controller.prototype.addBounds=function(t){this.controlledAreaBounds.push(t),this.holderBounds.append(t)},Controller.prototype.animateToLevel=function(t){var e=this.getZoomLevelFinalState(t);e&&(this.currentZoomLevel=t,this.animateTo(e.lastMinute,e.count))},Controller.prototype.createZoomButtons=function(){this.zoomText=new flash.text.TextField,this.zoomText.x=this.chartTypeButtons?this.chartTypeButtons.x+this.chartTypeButtons.width+5:5,this.zoomText.y=5,this.zoomText.autoSize=flash.text.TextFieldAutoSize.LEFT,this.zoomText.defaultTextFormat=this.windowTitleTextFormat,this.zoomText.text=e.Message.getMsg(e.Messages.ZOOM)+":",this.zoomText.selectable=!1,this.zoomButtons=new e.ui.TextButtonsGroup,this.zoomButtons.setSpacing("",this.isZh?1:3),this.zoomButtons.setTextFormats(this.buttonTextFormat,this.selectedTextFormat,this.separatorTextFormat),this.zoomButtons.x=this.zoomText.x+this.zoomText.width+this.zoomButtons.spacing,this.zoomButtons.y=this.zoomText.y,this.resetZoomButtons(e.Const.MIN_DISPLAY_DAYS)},Controller.prototype.onKeyDown=function(t){this.CTRL_DOWN=t.ctrlKey,this.SHIFT_DOWN=t.shiftKey,t.charCode==="vVeElLcC".charCodeAt(0)?e.MainManager.jsProxy.setParameter("displayVolume","false"):t.charCode==="vVeElLcC".charCodeAt(1)?e.MainManager.jsProxy.setParameter("displayVolume","true"):t.charCode==="vVeElLcC".charCodeAt(2)?e.MainManager.jsProxy.setParameter("displayExtendedHours","true"):t.charCode==="vVeElLcC".charCodeAt(3)?e.MainManager.jsProxy.setParameter("displayExtendedHours","false"):t.charCode==="vVeElLcC".charCodeAt(4)?e.MainManager.jsProxy.setParameter("verticalScaling","Logarithmic"):t.charCode==="vVeElLcC".charCodeAt(5)?e.MainManager.jsProxy.setParameter("verticalScaling","Linear"):38===t.keyCode?this.zoomStuff(e.Directions.FORWARD,0,1):40===t.keyCode&&this.zoomStuff(e.Directions.BACKWARD,0,1)},Controller.prototype.isFitDetailLevel=function(t,i,n,a){if(!(t>=e.Intervals.INTRADAY&&t<=e.Intervals.WEEKLY))return!1;var r=e.Const.getDetailLevelInterval(t),o=i.data.getPointsInIntervalArray(r),s=i.data.marketDayLength+1;return o&&o.length>0&&o[0].relativeMinutes<=n&&a<=e.Const.INTERVAL_PERIODS[t].maxdays*s&&a>=e.Const.INTERVAL_PERIODS[t].mindays*s},Controller.prototype.onMouseDown=function(t){e.MainManager.jsProxy.setChartFocus(!0),this.SHIFT_DOWN=t.shiftKey,this.CTRL_DOWN=t.ctrlKey,this.displayManager.spaceText.isDateFieldClicked(t)||this.displayManager.spaceText.resetInfoText(),this.mouseDownAction()},Controller.prototype.onKeyUp=function(t){this.CTRL_DOWN=t.ctrlKey,this.SHIFT_DOWN=t.shiftKey,clearInterval(this.intId)},Controller.prototype.removeAllBounds=function(){this.controlledAreaBounds.splice(0),this.computeHolderBounds()},Controller.prototype.shouldRequestRegularMarketData=function(t,i,n,a){return!!t||(i<=e.Const.REALTIME_CHART_POLLING_MARGIN||i>=e.Const.MIN_PER_DAY-a-n-e.Const.REALTIME_CHART_POLLING_MARGIN)},Controller.prototype.animateToCustomLevel=function(t,i){this.customZoomStartDate=t,this.customZoomEndDate=i,this.animateToLevel(e.ScaleTypes.SCALE_CUSTOM)},Controller.prototype.intervalButtonClicked=function(t){var i=this.displayManager.layersManager.getFirstDataSource();if(i&&!i.isEmpty()){for(var n=e.Const.INTERVAL_PERIODS,a=n.length-1;a!==e.Intervals.INVALID&&e.Message.getMsg(n[a].text)!==t;)a--;a!==e.Intervals.INVALID&&(e.MainManager.jsProxy.logIntervalButtonClick(n[a].logtext),this.currentIntervalLevel=a,Boolean(e.MainManager.paramsObj.displayExtendedHours)&&(this.currentIntervalLevel===e.Intervals.INTRADAY?this.displayManager.toggleAllAfterHoursSessions(!0):this.displayManager.toggleAllAfterHoursSessions(!1)),this.animateTo(0,n[a].days*(i.data.marketDayLength+1),1),e.MainManager.jsProxy.setJsCurrentViewParam("defaultDisplayInterval",e.Const.getDetailLevelInterval(a)))}},Controller.prototype.highlightPoints=function(){for(var t={},e=0,i=this.displayManager.getViewPoints();e<i.length;e++){i[e].highlightPoint(this.mouseX,t)}return t},Controller.prototype.getState=function(){return this.state},Controller.prototype.getZoomLevelFinalState=function(t){var i=NaN,n=this.displayManager.getSparklineViewPoint(),a=this.displayManager.getMainViewPoint(),r=this.mainManager.layersManager.getFirstDataSource();if(!r)return null;var o=e.Const.SCALE_INTERVALS,s=n.getLastMinute();if(t===e.ScaleTypes.SCALE_CUSTOM){var l=this.getCustomScaleZoomLevel(r,this.customZoomStartDate,this.customZoomEndDate);if(!l)return null;s=l.lastMinute,i=l.count}else if(t===e.ScaleTypes.SCALE_YTD){(h=new Date(r.data.units[r.data.units.length-1].time)).setMonth(0),h.setDate(1),i=(s=0)-(c=r.data.units)[e.DataSource.getTimeIndex(h.getTime(),c)].relativeMinutes}else if(t===e.ScaleTypes.SCALE_MAX)s=a.getNewestMinute(),i=Math.abs(a.getOldestBaseMinute());else if(t!==e.ScaleTypes.INVALID&&t<=e.ScaleTypes.SCALE_1M){var h;(h=new Date(n.getLastDataUnit().time)).setMonth(h.getMonth()-o[t].months);var c=r.data.units,u=e.DataSource.getTimeIndex(h.getTime(),c);i=n.getLastMinute()-c[u].relativeMinutes}else{if(!(t>=0&&t<o.length))return null;s=r.getEndOfDayDataUnitFor(a.getLastMinute()).relativeMinutes,i=this.getCountForDays(r,o[t].days,s)}if(this.displayManager.layersManager.getStyle()===e.LayersManager.SINGLE&&Boolean(e.MainManager.paramsObj.displayExtendedHours)){var d=void 0,g=void 0;e.Const.INDICATOR_ENABLED?(d=a.getDetailLevelForTechnicalStyle(),g=a.getDetailLevelForTechnicalStyle(i,s)):(d=a.getDetailLevel(),g=a.getDetailLevel(i,s)),i=this.adjustCountForAfterHours(i,r,d,g)}return isNaN(i)||isNaN(s)?null:{lastMinute:s,count:i}},Controller.prototype.zoomStuff=function(t,e,i){void 0===i&&(i=NaN),this.clearCurrentZoom();for(var n=0,a=this.listeners;n<a.length;n++){a[n].zoomChart_Handler(t,i)}this.displayManager.topBorderLayer.update(),this.displayManager.showContextualStaticInfo()},Controller.prototype.getBoundsIndex=function(t){for(var e=0;e<this.controlledAreaBounds.length;e++)if(t.equals(this.controlledAreaBounds[e]))return e;return-1},Controller.prototype.changeListenersOffset=function(t){for(var e=0,i=this.listeners;e<i.length;e++){i[e].moveChartBy_Handler(t)}},Controller.prototype.getNewMarketState=function(t,i,n){return 0===i&&(i=(t=!t)?n:e.Const.MIN_PER_DAY-n),{isMarketOpen:t,stateRemainingMinutes:i-=e.Const.REALTIME_CHART_POLLING_INTERVAL/e.Const.MS_PER_MINUTE}},Controller.prototype.initEventListeners=function(){if(this.stage){var t=this.stage;t.addEventListener(KeyboardEvents.KEY_DOWN,flash.display.Stage.bind(this.onKeyDown,this)),t.addEventListener(KeyboardEvents.KEY_UP,flash.display.Stage.bind(this.onKeyUp,this)),t.addEventListener(MouseEvents.MOUSE_MOVE,flash.display.Stage.bind(this.onMouseMove,this)),t.addEventListener(MouseEvents.MOUSE_LEAVE,flash.display.Stage.bind(this.onMouseLeave,this)),t.addEventListener(MouseEvents.MOUSE_DOWN,flash.display.Stage.bind(this.onMouseDown,this)),t.addEventListener(MouseEvents.MOUSE_UP,flash.display.Stage.bind(this.onMouseUp,this)),this.initPollingTimer()}},Controller.prototype.enableIntervalButtons=function(t){this.contains(this.intervalButtons)||(this.addChild(this.intervalText),this.addChild(this.intervalButtons),this.intervalButtons.selectButtonByIndex(t),this.contains(this.zoomButtons)&&(this.removeChild(this.zoomButtons),this.removeChild(this.zoomText)),this.clearCurrentZoom())},Controller.prototype.mouseDownAction=function(t){var n=this;void 0===t&&(t=NaN);var a=this.displayManager.getSparklineViewPoint();switch(this.initialXMouse=this.stage.mouseX,this.initialYMouse=this.stage.mouseY,t){case e.ControllerComponents.SCROLL_BAR:this.state=i.SCROLLING,this.cumulativeXOffset=0,this.pagingAmount=0;var r=a.windowLayer.getLeftX(),o=a.windowLayer.getRightX();this.scrollMouseMinX=a.minx+this.initialXMouse-r,this.scrollMouseMaxX=a.maxx-(o-this.initialXMouse);break;case e.ControllerComponents.SCROLL_BG:var s=a.windowLayer.scrollSlider;if(this.mouseX<s.x){this.movePage(e.Directions.BACKWARD);break}if(this.mouseX>s.x+s.width){this.movePage(e.Directions.FORWARD);break}break;case e.ControllerComponents.LEFT_BUTTON:this.state=i.PRESSING_LEFT,clearInterval(this.intId),this.intId=setInterval(function(){n.notifyListenersToMove(e.Directions.BACKWARD*n.BUTTON_MOVEBY_AMOUNT)},20);break;case e.ControllerComponents.RIGHT_BUTTON:this.state=i.PRESSING_RIGHT,clearInterval(this.intId),this.intId=setInterval(function(){n.notifyListenersToMove(e.Directions.FORWARD*n.BUTTON_MOVEBY_AMOUNT)},20);break;case e.ControllerComponents.LEFT_HANDLE:return this.state=i.DRAGGING_LEFT_HANDLE,this.MOUSE_DOWN=!0,void this.mouseCursor.setCursor(e.MouseCursors.H_ARROWS);case e.ControllerComponents.RIGHT_HANDLE:return this.state=i.DRAGGING_RIGHT_HANDLE,this.MOUSE_DOWN=!0,void this.mouseCursor.setCursor(e.MouseCursors.H_ARROWS)}if(this.hitTestInsideBounds(this.mouseX,this.mouseY)){if(this.MOUSE_DOWN=!0,this.clearAllHighlights(),this.CTRL_DOWN&&this.SHIFT_DOWN)return this.state=i.ZOOMING_OUT,clearInterval(this.intId),void(this.intId=setInterval(function(){n.zoomStuff(e.Directions.BACKWARD,n.stage.mouseX)},20));if(this.SHIFT_DOWN)return this.state=i.SELECTING,void this.mouseCursor.setCursor(e.MouseCursors.CLASSIC);this.mouseCursor.setCursor(e.MouseCursors.CLOSED_HAND),this.state=i.DRAGGING}},Controller.NOTIFY_TIMEOUT=500,Controller}(flash.display.Sprite);e.Controller=n}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){var e=function(){return function BitmapData(){}}();t.BitmapData=e;var i=function(t){function Bitmap(){var e=t.call(this,document.createElement("img"))||this;return e.element.onload=function(){e.element.style.width||(e.element.style.width=e.element.naturalWidth+"px"),e.element.style.height||(e.element.style.height=e.element.naturalHeight+"px")},e.element.src="images/"+getClassName(e)+".png",e}return __extends(Bitmap,t),Object.defineProperty(Bitmap.prototype,"width",{get:function(){return this._width||this.element.scrollWidth},set:function(t){this.element.style.width=t+"px"},enumerable:!0,configurable:!0}),Object.defineProperty(Bitmap.prototype,"height",{get:function(){return this._height||this.element.scrollHeight},set:function(t){this.element.style.height=t+"px"},enumerable:!0,configurable:!0}),Bitmap}(t.DisplayObject);t.Bitmap=i}(t.display||(t.display={}))}(flash||(flash={})),function(t){!function(t){!function(t){var e=function(t){function Controller_ExpandIcon(){return null!==t&&t.apply(this,arguments)||this}return __extends(Controller_ExpandIcon,t),Controller_ExpandIcon}(flash.display.Bitmap);t.Controller_ExpandIcon=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function Controller_ShrinkIcon(){return null!==t&&t.apply(this,arguments)||this}return __extends(Controller_ShrinkIcon,t),Controller_ShrinkIcon}(flash.display.Bitmap);t.Controller_ShrinkIcon=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){function DataManager(t,e,i){void 0===e&&(e=NaN),void 0===i&&(i=NaN),this.mainManager=t,this.startTime=e,this.endTime=i,this.dataSources={}}return DataManager.prototype.addObject=function(t){this.dataSources[t._quote]&&this.dataSources[t._quote].addObject(t)},DataManager.prototype.expectEvent=function(e){e&&(this.checkDataSourceExistance(e.quote),this.dataSources[e.quote].markEvent(e,t.ChartEventPriorities.EXPECTED))},DataManager.prototype.syncDataSources=function(e,i){for(var n=[],a=0,r=Object.keys(this.dataSources);a<r.length;a++){var o=r[a],s=this.dataSources[o].hasPendingEvents();o===e.quoteName||s||n.push(this.dataSources[o])}if(0!==n.length){for(var l=e.data,h=n[0].data,c=l.days.length-1,u=h.days.length-1,d=!1,g=!1;c>0&&u>0;){var p=l.units[l.days[c]],v=h.units[h.days[u]],y=t.Utils.compareUtcDates(p.exchangeDateInUTC,v.exchangeDateInUTC);if(y<0){var f=this.cloneDataUnitForTargetExchange(v,p,t.Const.DAILY_INTERVAL);l.units.splice(l.days[c]+1,0,f),u--,g=!0}else if(y>0){for(var T=0,I=n;T<I.length;T++){var L=(E=I[T]).data;if(L.days.length>h.days.length-u){var m=L.days[L.days.length-(h.days.length-u)];f=this.cloneDataUnitForTargetExchange(p,L.units[m],t.Const.DAILY_INTERVAL);L.units.splice(m+1,0,f)}}d=!0,c--}else c--,u--}if(g&&(e.preCalculate(e.data),i.computeRelativeTimes(e)),d)for(var M=0,C=n;M<C.length;M++){var E;(E=C[M]).preCalculate(E.data),i.computeRelativeTimes(E)}}},DataManager.prototype.sortObjects=function(t,e){this.dataSources[t]&&this.dataSources[t].sortObjects(e)},DataManager.prototype.eventHandler=function(e,i){if(void 0===i&&(i=!0),e&&(this.checkDataSourceExistance(e.quote),e.type===t.ChartEventTypes.GET_RT_DATA||e.type===t.ChartEventTypes.GET_RT_AH_DATA||!1!==this.dataSources[e.quote].markEvent(e,e.priority)))switch(e.type){case t.ChartEventTypes.GET_DATA:case t.ChartEventTypes.GET_AH_DATA:case t.ChartEventTypes.GET_MUTF_DATA:case t.ChartEventTypes.GET_RT_DATA:case t.ChartEventTypes.GET_RT_AH_DATA:this.getQuoteData(this.mainManager.url,this.mainManager.stickyArgs,e,i)}},DataManager.prototype.selectObject=function(t,e,i,n){return this.dataSources[t].selectObject(e,i,n)},DataManager.prototype.getQuoteData=function(e,i,n,a){var r=t.Utils.getSymbolFromTicker(n.quote);if("javascript"!==t.MainManager.paramsObj[r+"_data_"+n.period]){if(!t.Const.INDICATOR_ENABLED||!a){if(void 0!==t.MainManager.paramsObj[r+"_data_"+n.period]&&n.type!==t.ChartEventTypes.GET_AH_DATA)return void this.addData(n,decodeURIComponent(t.MainManager.paramsObj[r+"_data_"+n.period]));if(void 0!==t.MainManager.paramsObj[r+"_data_ah"]&&n.type===t.ChartEventTypes.GET_AH_DATA)return void this.addData(n,decodeURIComponent(t.MainManager.paramsObj[r+"_data_ah"]))}var o=this.getUrlString(e,i,n);new t.DataRequestHandler(this,o,n)}else t.MainManager.jsProxy.getData(n.quote,n.period)},DataManager.prototype.clearAllObjects=function(t,e){this.dataSources[t].clearAllObjects(e)},DataManager.prototype.removeObject=function(t,e,i){this.dataSources[t].removeObject(i,e)},DataManager.prototype.hasDataSource=function(t){return!!this.dataSources[t]},DataManager.prototype.addData=function(t,e){var i=this.dataSources[t.quote].addStream(e,t);this.mainManager.dataIsHere(this.dataSources[t.quote],i)},DataManager.prototype.dataUnavailableOnServer=function(t){var e=this.dataSources[t];return!!e&&e.dataUnavailableOnServer},DataManager.prototype.getUrlString=function(e,i,n){var a=t.Utils.getSymbolFromTicker(n.quote),r=t.Utils.getExchangeFromTicker(n.quote),o="";if(-1!==a.indexOf("@")){var s=a.split("@");a=s[0],o=s[1]}r="NASDAQ"===r?"NASD":r;var l="";return""===o?(l=e+"?q="+a,""!==r&&(l+="&x="+r),l+="&i="+n.interval,n.type!==t.ChartEventTypes.GET_AH_DATA&&n.type!==t.ChartEventTypes.GET_RT_AH_DATA||(l+="&sessions=ext_hours"),isNaN(this.startTime)||isNaN(this.endTime)?l+="&p="+n.period:l+="&se="+this.startTime+"&ee="+this.endTime):(l=e.substr(0,e.indexOf("getprices"))+"gettechnicals",l+="?symbol="+a,l+="&technicals="+o,""!==r&&(l+="&exchange="+r),l+="&interval="+n.interval+"&period="+n.period),l+="&f="+n.columns+"&df=cpct",l+="&auto=1",l+="&ts="+(new Date).getTime(),l+=i},DataManager.prototype.cloneDataUnitForTargetExchange=function(e,i,n){var a=new t.DataUnit(i.close,NaN,NaN,NaN),r=Date.UTC(e.exchangeDateInUTC.fullYearUTC,e.exchangeDateInUTC.monthUTC,e.exchangeDateInUTC.dateUTC,i.dayMinute/60,i.dayMinute%60);return a.setExchangeDateInUTC(r,i.timezoneOffset),a.coveredDays=e.coveredDays,a.volumes[n]=0,a.intervals[0]=n,a},DataManager.prototype.checkDataSourceExistance=function(e,i){if(this.hasDataSource(e))!this.dataSources[e].displayName&&i&&(this.dataSources[e].displayName=i);else{var n=this.mainManager?this.mainManager.weekdayBitmap:t.Const.DEFAULT_WEEKDAY_BITMAP;this.dataSources[e]=new t.DataSource(e,n,i)}},DataManager.prototype.hasNonEmptyDataSource=function(t){return this.dataSources[t]&&!this.dataSources[t].isEmpty()},DataManager}();t.DataManager=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){function DataRequestHandler(e,i,n){this.dataManager=e,this.url=i,this.event=n,this.urlLoader=new flash.net.URLLoader,this.tries=0,this.initListeners(),i&&(t.MainManager.console.dataLoading(),this.urlLoader.load(new flash.net.URLRequest(i)))}return DataRequestHandler.prototype.ioErrorHandler=function(t){this.setUpDataReload(),console.log("ioErrorHandler: "+t)},DataRequestHandler.prototype.securityErrorHandler=function(t){this.setUpDataReload(),console.log("security error: "+t)},DataRequestHandler.prototype.dataReload=function(){0===this.tries&&t.MainManager.console.dataLoading(),clearInterval(this.intervalId),this.urlLoader.load(new flash.net.URLRequest(this.url))},DataRequestHandler.prototype.configReloadInterval=function(t,e){this.intervalId=setInterval(t,e)},DataRequestHandler.prototype.completeHandler=function(e){clearInterval(this.intervalId);var i=this.dataManager.dataSources,n=i[this.event.quote].addStream(decodeURIComponent(this.urlLoader.data),this.event);switch(n){case t.AddStreamResults.ERROR:this.setUpDataReload();break;case t.AddStreamResults.NOTHING:t.MainManager.console.dataLoaded(),i[this.event.quote].dataUnavailableOnServer=!0;break;case t.AddStreamResults.FIRST_DATA:case t.AddStreamResults.ADDED_DATA:if(t.MainManager.console.dataLoaded(),this.dataManager.mainManager.dataIsHere(i[this.event.quote],n),this.event.callbacks)for(var a=0,r=this.event.callbacks;a<r.length;a++){var o=r[a];o.func.apply(this,o.param)}flash.display.Graphics.cleanupPending()}},DataRequestHandler.prototype.initListeners=function(){this.urlLoader.addEventListener(Events.COMPLETE,this.completeHandler.bind(this)),this.urlLoader.addEventListener(SecurityErrorEvents.SECURITY_ERROR,this.securityErrorHandler.bind(this)),this.urlLoader.addEventListener(IOErrorEvents.IO_ERROR,this.ioErrorHandler.bind(this))},DataRequestHandler.prototype.setUpDataReload=function(){this.event.type!==t.ChartEventTypes.GET_RT_DATA&&this.event.type!==t.ChartEventTypes.GET_RT_AH_DATA&&(this.tries<t.Const.MAX_RELOAD_TRIES?(this.configReloadInterval(this.dataReload.bind(this),5e3),this.tries++):(t.MainManager.console.dataLoaded(),this.configReloadInterval(this.dataReload.bind(this),5e4),this.tries=0))},DataRequestHandler}();t.DataRequestHandler=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){function DataSeries(){this.noPointsInIntervals={},this.pointsInIntervals={},this.currentSessionIndex=0,this.intradayRegions=[],this.coalescedChildren={},this.firsts=[],this.interval=-1,this.years=[],this.days=[],this.intervalBounds={},this.points=[],this.dataSessions=new t.IntervalSet,this.fridays=[],this.units=this.points}return DataSeries.compareUnitAndRelativeMinute=function(t,e){return t.relativeMinutes<e?-1:t.relativeMinutes>e?1:0},DataSeries.prototype.getDayContainingTime=function(e){var i=1+t.Utils.binarySearch(this.days,e,this.compareIndexWithTime,this);if(i>=this.days.length)return null;var n=this.units[this.days[i]];return(n.time-e)/t.Const.MS_PER_MINUTE<n.dayMinute?n:null},DataSeries.prototype.getRelativeMinuteIndex=function(e,i){var n=i||this.units,a=t.Utils.binarySearch(n,e,DataSeries.compareUnitAndRelativeMinute,this);return-1===a?0:a},DataSeries.prototype.printFridays=function(){for(var t=0,e=this.fridays;t<e.length;t++){var i=e[t];this.units[i]?console.log(this.units[i]):console.log(this.points[i].point+" "+this.points[i].volume)}},DataSeries.prototype.getCoalescedDataSeries=function(e){var i=this.coalescedChildren[e];return i||((i=e<t.Const.DAILY_INTERVAL?this.createCoalescedIntradayDataSeries(e):e<t.Const.WEEKLY_INTERVAL?this.createCoalescedDailyDataSeries(e):this.createCoalescedWeeklyDataSeries(e)).interval=e,this.coalescedChildren[e]=i),i},DataSeries.prototype.setNoPointsInIntervalArray=function(t){this.noPointsInIntervals[t]=!0},DataSeries.prototype.getPointsInIntervals=function(){return this.pointsInIntervals},DataSeries.prototype.hasPointsInIntervalArray=function(t){var e=this.pointsInIntervals[t];return e&&e.length>0},DataSeries.prototype.compareRefPointAndRelativeMinute=function(t,e){return DataSeries.compareUnitAndRelativeMinute(t.point,e)},DataSeries.prototype.getReferencePointIndex=function(e){var i=t.Utils.binarySearch(this.points,e,this.compareRefPointAndRelativeMinute,this);return-1===i?0:i},DataSeries.prototype.getLastWeeklyWeekIndex=function(){for(var t=this.fridays.length-1;t>0&&this.fridays[t]!==this.fridays[t-1]+1||0===t&&this.fridays[t]>0;)t--;return t},DataSeries.prototype.getFirstRelativeMinute=function(){return this.units.length>0?this.units[0].relativeMinutes:0},DataSeries.prototype.getNextWeekEnd=function(t){for(var e=this.fridays.length-1;this.fridays[e]>t&&e>=0;)e--;return e>=this.fridays.length-1?this.fridays.length-1:e+1},DataSeries.prototype.minuteIsEndOfDataSession=function(t){return!isNaN(t)&&notnull(this.dataSessions.getClosestEarlierIntervalForValue(t)).end===t},DataSeries.prototype.getIntradaySessionsString=function(t){t+=": ";for(var e=0,i=this.intradayRegions;e<i.length;e++){var n=i[e];t+="["+n.start+", "+n.end+"] ",t+=this.units[n.end].dayMinute+"\n"}return t},DataSeries.prototype.getLastDailyDayIndex=function(){for(var t=this.days.length-1;t>0&&this.days[t]!==this.days[t-1]+1||0===t&&this.days[t]>0;)t--;return t},DataSeries.prototype.getFirstReferencePoint=function(){return this.units.length>0?this.points[0].point:null},DataSeries.prototype.compareUnitAndTimestamp=function(t,e){return t.time<e?-1:t.time>e?1:0},DataSeries.prototype.addDataSession=function(e,i,n){this.dataSessions.addPair(new t.MarketSessionPair(e,i,n))},DataSeries.prototype.relativeMinuteMetaIndex=function(e,i){var n=t.Utils.binarySearch(i,e,this.compareIndexAndRelativeMinute,this);return-1===n?0:n},DataSeries.prototype.getNextDayStart=function(t){return 1===this.days.length?0:t>this.days[this.days.length-1]?this.days.length-1:this.getPrevDayStart(t)+1},DataSeries.prototype.getLastReferencePoint=function(){return this.units.length>0?this.points[this.units.length-1].point:null},DataSeries.prototype.intervalDataContainsTime=function(t,e,i){void 0===i&&(i=NaN);var n=this.intervalBounds[this.intervalHashKey(e)];if(n&&n.containsValue(t))return!0;if(!isNaN(i)){var a=this.intervalBounds[this.intervalHashKey(i)];if(a&&a.containsValue(t))return!0}return!1},DataSeries.prototype.getSessionForMinute=function(t){return isNaN(t)?null:this.dataSessions.getClosestEarlierIntervalForValue(t)},DataSeries.prototype.getDaysString=function(){for(var t=[],e=0,i=this.days;e<i.length;e++){var n=i[e];t.push(this.units[n].toString())}return t.join("\n")},DataSeries.prototype.createCoalescedIntradayDataSeries=function(e){var i=new DataSeries;i.copyMarketTimesFrom(this);for(var n=e/t.Const.INTRADAY_INTERVAL,a=this.getLastDailyDayIndex();a<this.days.length-1;a++)for(var r=a===this.days.length-1?this.units.length-1:this.days[a+1],o=this.days[a]+1;o<=r;){var s=new t.DataUnit(NaN,Number.MIN_VALUE,Number.MAX_VALUE,this.units[o].open);s.fake=!0;for(var l=0;l<n;l++)s.high=Math.max(s.high,this.units[o].high),s.low=Math.min(s.low,this.units[o].low),s.close=this.units[o].close,this.units[o].fake||(s.fake=!1),o++;s.exchangeDateInUTC=this.units[o-1].exchangeDateInUTC,s.dayMinute=this.units[o-1].dayMinute,s.time=this.units[o-1].time,s.relativeMinutes=this.units[o-1].relativeMinutes,s.coveredDays=0,o>=r&&(i.days.push(i.points.length),0),i.units.push(s)}return i},DataSeries.prototype.getLastRelativeMinute=function(){return this.units.length>0?this.units[this.units.length-1].relativeMinutes:0},DataSeries.prototype.compareIndexWithTime=function(t,e){return this.units[t].time<e?-1:this.units[t].time>e?1:0},DataSeries.prototype.createCoalescedWeeklyDataSeries=function(e){var i=new DataSeries;i.copyMarketTimesFrom(this);for(var n=0,a=this.fridays;n<a.length;n++){var r=a[n],o=new t.DataUnit(this.units[r].close,this.units[r].high,this.units[r].low,this.units[r].open);o.exchangeDateInUTC=this.units[r].exchangeDateInUTC,o.dayMinute=this.units[r].dayMinute,o.time=this.units[r].time,o.relativeMinutes=this.units[r].relativeMinutes,o.coveredDays=this.units[r].coveredDays,i.fridays.push(i.points.length),i.units.push(o)}return i},DataSeries.prototype.compareIndexAndRelativeMinute=function(t,e){return DataSeries.compareUnitAndRelativeMinute(this.units[t],e)},DataSeries.prototype.getSessionIndex=function(t){if(isNaN(t))return-1;for(var e=this.dataSessions.length(),i=0;i<e;i++){var n=this.dataSessions.getIntervalAt(i);if(t>=n.start&&t<=n.end)return i}return-1},DataSeries.prototype.getFirstDailyIndex=function(){var t;for(t=0;t<this.units.length&&this.units[t].coveredDays>1;t++);return t},DataSeries.prototype.hasNoPointsInIntervalArray=function(t){return this.noPointsInIntervals[t]},DataSeries.prototype.getTimestampIndex=function(e,i){var n=i||this.units,a=t.Utils.binarySearch(n,e,this.compareUnitAndTimestamp,this);return-1===a?0:a},DataSeries.prototype.addIntervalBounds=function(e,i,n){var a=this.intervalHashKey(e);this.intervalBounds[a]||(this.intervalBounds[a]=new t.IntervalSet),this.intervalBounds[a].addInterval(i,n)},DataSeries.prototype.getDataSession=function(t){for(var e=this.dataSessions.length(),i=0;i<e;i++){var n=this.dataSessions.getIntervalAt(i);if(n.name===t)return n}return null},DataSeries.prototype.getSessionDisplayNameForMinute=function(e){var i=this.getSessionForMinute(e);if(i)switch(i.name){case t.Const.AFTER_HOURS_NAME:return t.Const.AFTER_HOURS_DISPLAY_NAME;case t.Const.PRE_MARKET_NAME:return t.Const.PRE_MARKET_DISPLAY_NAME;case t.Const.REGULAR_MARKET_NAME:return t.Const.REGULAR_MARKET_DISPLAY_NAME}return""},DataSeries.prototype.setPointsInIntervalArray=function(t,e){this.pointsInIntervals[t]=e},DataSeries.prototype.allSessionsLength=function(){return this.dataSessions.allIntervalsLength()},DataSeries.prototype.getPointsInIntervalArray=function(t){return this.pointsInIntervals[t]},DataSeries.prototype.getSessionLength=function(t){var e=this.getDataSession(t);return e?e.end-e.start:0},DataSeries.prototype.intervalDataPreceedsTime=function(t,e){var i=this.intervalHashKey(e);if(this.intervalBounds[i]){var n=this.intervalBounds[i].getEarliestInterval();if(n&&t>n.start)return!0}return!1},DataSeries.prototype.intervalHashKey=function(t){return t},DataSeries.prototype.clearCoalescedChildren=function(){this.coalescedChildren={}},DataSeries.prototype.printPoints=function(e){for(var i=0,n=this.units;i<n.length;i++){var a=n[i];if(e){var r=a;console.log(a.relativeMinutes+" "+r[e])}else a instanceof t.DataUnit?console.log(a):console.log(t.Utils.appendObjectMembersAsStrings("",a))}},DataSeries.prototype.minuteIsStartOfDataSession=function(t){return!isNaN(t)&&notnull(this.dataSessions.getClosestEarlierIntervalForValue(t)).start===t},DataSeries.prototype.getFirstDailyDayIndex=function(){for(var t=0,e=this.getFirstDailyIndex();t<this.days.length&&this.days[t]<e;)t++;return t},DataSeries.prototype.getPrevDayStart=function(e){var i=t.Utils.binarySearch(this.days,e,t.Utils.compareNumbers,this);return this.days[i]===e?i-1:i},DataSeries.prototype.createCoalescedDailyDataSeries=function(e){var i=new DataSeries;i.copyMarketTimesFrom(this);for(var n=this.getFirstDailyDayIndex();n<this.days.length;n++){var a=this.units[this.days[n]],r=new t.DataUnit(a.close,a.high,a.low,a.open);r.exchangeDateInUTC=a.exchangeDateInUTC,r.dayMinute=a.dayMinute,r.time=a.time,r.relativeMinutes=a.relativeMinutes,r.coveredDays=a.coveredDays,i.days.push(i.points.length),i.units.push(r)}return i},DataSeries.prototype.copyMarketTimesFrom=function(t){this.dataSessions=t.dataSessions,this.currentSessionIndex=0,this.marketOpenMinute=t.marketOpenMinute,this.marketCloseMinute=t.marketCloseMinute,this.marketDayLength=t.marketDayLength},DataSeries}();t.DataSeries=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){return function SeriesPosition(t,e,i){void 0===i&&(i=null),this.refDataSeries=t,this.pos=e,this.dayPos=i}}();t.SeriesPosition=e;var i,n=function(){return function ObjectPositions(){}}();t.ObjectPositions=n,function(t){t[t.COL_DATE_TYPE=1]="COL_DATE_TYPE",t[t.COL_CLOSE_TYPE=2]="COL_CLOSE_TYPE",t[t.COL_HIGH_TYPE=3]="COL_HIGH_TYPE",t[t.COL_LOW_TYPE=4]="COL_LOW_TYPE",t[t.COL_OPEN_TYPE=5]="COL_OPEN_TYPE",t[t.COL_VOLUME_TYPE=6]="COL_VOLUME_TYPE",t[t.COL_CDAYS_TYPE=7]="COL_CDAYS_TYPE"}(i||(i={}));var a=function(){function DataSource(e,i,n){if(void 0===i&&(i=62),this.quoteName=e,this.weekdayBitmap=i,this.displayName=n,this.columnNames=["DATE","CLOSE","HIGH","LOW","OPEN","VOLUME","CDAYS"],this.allowedOffset=10,this.relativeMinutesState=DataSource.RELATIVE_MINUTES_NOT_READY,this.events={},this.visibleExtendedHours=new t.IntervalSet,this.objects={},this.data=new t.DataSeries,this.indicators={},this.hiddenExtendedHours=new t.IntervalSet,this.afterHoursData=new t.DataSeries,this.dataUnavailableOnServer=!1,this.intradayMinutesInterval=t.Const.INTRADAY_INTERVAL/t.Const.SEC_PER_MINUTE,this.firstOpenRelativeMinutes=0,this.quoteType=t.Const.getQuoteType(e),-1!==e.indexOf("@")){var a=e.split("@");this.tickerName=a[0],this.technicalsName=a[1]}else this.tickerName=e,this.technicalsName=""}return DataSource.unitsInDifferentDays=function(e,i){return!i||!e||(e.exchangeDateInUTC.getUTCDay()!==i.exchangeDateInUTC.getUTCDay()||Math.abs(e.time-i.time)>t.Const.MS_PER_DAY)},DataSource.getMinuteMetaIndex=function(t,e,i){if(isNaN(t)||!i||0===i.length||0===e.length)return-1;for(var n=0,a=e.length-1;;){var r=Math.round((n+a)/2);if(0===r&&i[e[0]].relativeMinutes>t)break;if(r===e.length-1&&i[e[r]].relativeMinutes<t)return e.length-1;if(i[e[r]].relativeMinutes===t)return r;if(n>=a-1)return n;i[e[r]].relativeMinutes<t?n=r:a=r}return 0},DataSource.getTimeIndex=function(t,e){var i=0;if(isNaN(t)||!e||0===e.length)return-1;for(var n=0,a=e.length-1;!(0===(i=Math.round((n+a)/2))&&e[0].time>t);){if(i===e.length-1&&e[i].time<t)return e.length-1;if(e[i].time===t)return i;if(n>=a-1)return n;e[i].time<t?n=i:a=i}return 0},DataSource.prototype.computeStarts=function(e){var i=-1;e.years.length=0,e.firsts.length=0,e.fridays.length=0,e.days.length=0;for(var n=e.units,a=notnull(e.getSessionForMinute(n[0].dayMinute)),r=t.Utils.getLastDayOfWeek(this.weekdayBitmap),o=0;o<n.length;o++){var s=n[o],l=o===n.length-1?null:n[o+1];if(s.dayMinute===a.end){if(DataSource.unitsInDifferentDays(s,l)){e.days.push(o),s.exchangeDateInUTC.getUTCMonth()!==i&&(e.firsts.push(o),0===(i=s.exchangeDateInUTC.getUTCMonth())&&e.years.push(o));var h=s.exchangeDateInUTC.getUTCDay(),c=Number.POSITIVE_INFINITY;l&&(c=l.exchangeDateInUTC.getUTCDay()),(h===r||s.coveredDays>1||o<n.length-1&&h>c)&&e.fridays.push(o)}l&&(a=notnull(e.getSessionForMinute(l.dayMinute)))}}},DataSource.prototype.addStream=function(e,n){var a=0!==this.data.points.length;if(this.clearAllIndicatorsOnAddData(Number(n.interval)),this.clearCoalescedChildren(),0!==e.indexOf(DataSource.EXCHANGE_STR))return t.AddStreamResults.ERROR;var r=e.split("\n"),o=this.data;switch(n.type){case t.ChartEventTypes.GET_AH_DATA:case t.ChartEventTypes.GET_RT_AH_DATA:o=this.afterHoursData}var s=this.parseHeader(r,n);if(!s)return t.AddStreamResults.ERROR;this.checkHeaderSanity(s,o);var l=t.Utils.assocArrayLength(s)+1;if(this.baseInterval=Number(s[DataSource.INTERVAL_STR]),n.detailType!==t.ChartDetailTypes.GET_RT_DATA&&n.detailType!==t.ChartDetailTypes.GET_RT_AH_DATA){var h=s[DataSource.COLUMNS_STR].split(",");-1!==h.indexOf(this.columnNames[i.COL_OPEN_TYPE])&&-1!==h.indexOf(this.columnNames[i.COL_HIGH_TYPE])&&-1!==h.indexOf(this.columnNames[i.COL_LOW_TYPE])?this.eventOhlcDone(n.getEventName()):this.eventDone(n.getEventName())}var c=o.units,u=this.parseStream(r.slice(l),s,o);if(!u)return t.AddStreamResults.ERROR;if(0===u.length)return o.setNoPointsInIntervalArray(this.baseInterval),t.AddStreamResults.ADDED_DATA;var d=t.Utils.getLastRealPointIndex(u),g=!1;if(t.Const.INDICATOR_ENABLED)switch(n.detailType){case t.ChartDetailTypes.GET_10D_DATA:case t.ChartDetailTypes.GET_30D_DATA:return this.addStreamForPointsInIntervals(this.baseInterval,u),t.AddStreamResults.ADDED_DATA;case t.ChartDetailTypes.GET_5D_DATA:case t.ChartDetailTypes.GET_1Y_DATA:case t.ChartDetailTypes.GET_5Y_DATA:case t.ChartDetailTypes.GET_40Y_DATA:this.addStreamForPointsInIntervals(this.baseInterval,u);break;case t.ChartDetailTypes.GET_AH_DATA:this.addAHStreamForPointsInIntervals(u);break;case t.ChartDetailTypes.GET_RT_DATA:g=!0;var p=this.data.getPointsInIntervalArray(t.Const.INTRADAY_INTERVAL);this.addStreamForPointsInIntervals(this.baseInterval,this.mergePoints(u,p,g,d));break;case t.ChartDetailTypes.GET_RT_AH_DATA:g=!0;var v=this.afterHoursData.getPointsInIntervalArray(t.Const.INTRADAY_INTERVAL);this.addAHStreamForPointsInIntervals(this.mergePoints(u,v,g,d))}var y=this.mergePoints(u,c,g,d);o.units=y,o.points=y;var f=u[0].time,T=u[u.length-1].time;return o.addIntervalBounds(this.baseInterval,f,T),this.preCalculate(o),o===this.afterHoursData&&(this.hiddenExtendedHours.length()>0?(this.hiddenExtendedHours=new t.IntervalSet,this.extractAfterHoursSessions(this.hiddenExtendedHours)):(this.visibleExtendedHours.length()>0&&(this.visibleExtendedHours=new t.IntervalSet),this.extractAfterHoursSessions(this.visibleExtendedHours))),a?t.AddStreamResults.ADDED_DATA:0===u.length?t.AddStreamResults.NOTHING:t.AddStreamResults.FIRST_DATA},DataSource.prototype.preCalculate=function(t){this.computeStarts(t),this.computeIntradaySessions(t),this.computeObjectPositions()},DataSource.prototype.getClosestDataUnitLessThen=function(t){var e=this.afterHoursData.units[this.afterHoursData.getRelativeMinuteIndex(t)],i=this.data.units[this.data.getRelativeMinuteIndex(t)];return t<e.relativeMinutes&&t<i.relativeMinutes?null:e.relativeMinutes>t?i:i.relativeMinutes>t?e:t-i.relativeMinutes<t-e.relativeMinutes?i:e},DataSource.prototype.getAllDataSessions=function(e,i){for(var n=new t.IntervalSet,a=0;a<this.data.dataSessions.length();a++)n.addPair(this.data.dataSessions.getIntervalAt(a));return e<this.data.marketOpenMinute&&n.addInterval(e,this.data.marketOpenMinute),i>this.data.marketCloseMinute&&n.addInterval(this.data.marketCloseMinute,i),n},DataSource.prototype.countEvents=function(t){for(var e=0,i=0,n=Object.keys(this.events);i<n.length;i++){var a=n[i];this.events[a]===t&&e++}return e},DataSource.prototype.getColumnTypes=function(t){for(var e=[],i=t.split(","),n=0;n<i.length;n++)for(var a=0;a<this.columnNames.length;a++)i[n]===this.columnNames[a]&&(e[n]=a+1);return e},DataSource.prototype.eventOhlcDone=function(e){this.events[e]=t.ChartEventPriorities.OHLC_DONE},DataSource.prototype.hasEventHappened=function(t){var e=t.getEventName();return!!this.events[e]},DataSource.prototype.parseStream=function(e,i,n){var a=0,r=0;if(this.baseInterval=Number(i[DataSource.INTERVAL_STR]),this.baseMinutesInterval=this.baseInterval/t.Const.SEC_PER_MINUTE,!e||0===e.length)return[];var o=this.getColumnTypes(i[DataSource.COLUMNS_STR]),s=[],l=0;this.timezoneOffset=0,this.lastAbsTime=0;var h=DataSource.TIMEZONE_OFFSET_STR.charCodeAt(0),c=null,u=null,d=0;do{var g=e[l++];if(g.charCodeAt(0)===h)this.timezoneOffset=Number(g.split("=")[1]);else{var p=g.split(t.Const.DATA_DELIMITER);if(p.length===o.length&&"&"!==p[0].charAt(0)){var v=this.getDataUnitNoValidation(p,o,i);if(v.duplicate=n.minuteIsStartOfDataSession(v.dayMinute),t.Const.INDICATOR_ENABLED&&!isNaN(v.open)){0===v.open&&(v.open=v.close),v.high=Math.max(v.high,Math.max(v.open,v.close));var y=Math.min(v.open,v.close);(0===v.low||v.low>y)&&(v.low=y)}if(0===s.length&&(u=notnull(n.getSessionForMinute(v.dayMinute)),d=0),this.baseInterval<t.Const.DAILY_INTERVAL&&s.length>0){var f=(v.time-s[s.length-1].time)/t.Const.MS_PER_MINUTE;if(f>this.baseMinutesInterval&&f-(notnull(u).end-r)>this.allowedOffset&&d>0){var T=notnull(n.getSessionForMinute(v.dayMinute));v.dayMinute>=T.start&&(c=u,u=T,d=0)}}v.dayMinute>=notnull(u).start&&(this.quoteType===t.QuoteTypes.CURRENCY&&(this.baseInterval===t.Const.WEEKLY_INTERVAL?6===v.exchangeDateInUTC.getUTCDay()?v.setDate(v.time-t.Const.MS_PER_DAY,v.timezoneOffset):0===v.exchangeDateInUTC.getUTCDay()&&v.setDate(v.time-2*t.Const.MS_PER_DAY,v.timezoneOffset):0===v.exchangeDateInUTC.getUTCDay()||v.exchangeDateInUTC.getUTCDay()),this.baseInterval<t.Const.DAILY_INTERVAL&&v.dayMinute>notnull(u).end?(this.addAfterHoursUnitToLastMinute(v,s,notnull(u),n),d++,r=notnull(u).end):isNaN(v.close)||v.volumes[Number(i[DataSource.INTERVAL_STR])]>=0&&(this.quoteType===t.QuoteTypes.COMPANY&&s.length>0&&this.isTradeHaltedInterday(v,s[s.length-1],this.baseInterval),s.length>0&&v.time===s[s.length-1].time||(this.regularSanityCheck(s,v,c,notnull(u),r,n),d++,s.push(v),r=v.dayMinute)))}}}while(l<e.length);return 0!==s.length&&u&&Number(i[DataSource.INTERVAL_STR])<t.Const.DAILY_INTERVAL&&r!==u.end&&(a=(u.end-r)/this.baseMinutesInterval,this.addFakeDataUnits(s,s[s.length-1],n,a,t.Directions.FORWARD),r=u.end),0!==s.length&&u&&Number(i[DataSource.INTERVAL_STR])<t.Const.DAILY_INTERVAL&&r!==n.marketCloseMinute&&this.addFakeDataUnitsForSessions(s,s[s.length-1],n,n.getSessionIndex(r)+1,n.dataSessions.length(),t.Directions.FORWARD),s},DataSource.prototype.sortObjects=function(e){e||(e="newspin"),this.objects[e].sort(t.StockAssociatedObject.compare)},DataSource.prototype.addFakeDataUnitsForSessions=function(e,i,n,a,r,o){var s=0;if(n===this.data)for(var l=a;l<r;l++){var h=n.dataSessions.getIntervalAt(l);switch(o){case t.Directions.BACKWARD:s=h.end-i.dayMinute+this.baseMinutesInterval;break;case t.Directions.FORWARD:s=h.start-i.dayMinute-this.baseMinutesInterval}var c=Math.floor((h.end-h.start)/this.baseMinutesInterval)+1;this.addFakeDataUnits(e,i,n,c,o,s)}},DataSource.prototype.getFirstRelativeMinute=function(e){var i=t.Const.getDetailLevelInterval(e),n=this.data.getPointsInIntervalArray(i);return n&&0!==n.length?n[0].relativeMinutes:0},DataSource.prototype.hasPendingEvents=function(){for(var e=0,i=Object.keys(this.events);e<i.length;e++){var n=i[e];if(this.events[n]!==t.ChartEventPriorities.DONE&&this.events[n]!==t.ChartEventPriorities.OHLC_DONE)return!0}return!1},DataSource.prototype.regularSanityCheck=function(e,i,n,a,r,o){var s=0;if(this.baseInterval<t.Const.DAILY_INTERVAL){var l=o.getSessionIndex(a.start),h=n?o.getSessionIndex(n.start):-1;if(i.dayMinute===a.start)n&&r!==n.end&&(s=Math.floor((n.end-r)/this.baseMinutesInterval),this.addFakeDataUnits(e,e[e.length-1],o,s,t.Directions.FORWARD)),n?DataSource.unitsInDifferentDays(e[e.length-1],i)?(this.addFakeDataUnitsForSessions(e,e[e.length-1],o,h+1,o.dataSessions.length(),t.Directions.FORWARD),this.addFakeDataUnitsForSessions(e,i,o,0,l,t.Directions.BACKWARD)):this.addFakeDataUnitsForSessions(e,e[e.length-1],o,h+1,l,t.Directions.FORWARD):this.addFakeDataUnitsForSessions(e,i,o,0,l,t.Directions.BACKWARD);else if(0===e.length||i.time-e[e.length-1].time!=this.baseMinutesInterval*t.Const.MS_PER_MINUTE)if(0===e.length)this.addFakeDataUnitsForSessions(e,i,o,0,l,t.Directions.BACKWARD),o!==this.data&&i.dayMinute===a.end||(s=Math.floor((i.dayMinute-a.start)/this.baseMinutesInterval),this.addFakeDataUnits(e,i,o,s,t.Directions.BACKWARD));else if(i.time-e[e.length-1].time<=(i.dayMinute-a.start)*t.Const.MS_PER_MINUTE)s=Math.floor((i.dayMinute-r)/this.baseMinutesInterval)-1,this.addFakeDataUnits(e,e[e.length-1],o,s,t.Directions.FORWARD);else if(s=Math.floor((notnull(n).end-r)/this.baseMinutesInterval),this.addFakeDataUnits(e,e[e.length-1],o,s,t.Directions.FORWARD),DataSource.unitsInDifferentDays(e[e.length-1],i)||o!==this.data)this.addFakeDataUnitsForSessions(e,e[e.length-1],o,h+1,o.dataSessions.length(),t.Directions.FORWARD),this.addFakeDataUnitsForSessions(e,i,o,0,l,t.Directions.BACKWARD),s=Math.floor((i.dayMinute-a.start)/this.baseMinutesInterval),this.addFakeDataUnits(e,i,o,s,t.Directions.BACKWARD);else{this.addFakeDataUnitsForSessions(e,e[e.length-1],o,h+1,l,t.Directions.FORWARD),s=Math.floor((i.dayMinute-a.start)/this.baseMinutesInterval);var c=a.start-e[e.length-1].dayMinute-this.baseMinutesInterval;this.addFakeDataUnits(e,e[e.length-1],o,s,t.Directions.FORWARD,c)}}else if((this.baseInterval===t.Const.DAILY_INTERVAL||this.baseInterval===t.Const.WEEKLY_INTERVAL)&&i.dayMinute!==o.marketCloseMinute){var u=(o.marketCloseMinute-i.dayMinute)*t.Const.MS_PER_MINUTE;u-=1e3*i.exchangeDateInUTC.getUTCSeconds(),i.setDate(i.time+u,i.timezoneOffset)}},DataSource.prototype.getObjectPositionsInInterval=function(i){for(var a=new n,r=[],o=t.Const.DETAIL_LEVELS.length-1;o>=0;o--){var s=t.Const.getDetailLevelInterval(t.Const.DETAIL_LEVELS[o]),l=this.data.getPointsInIntervalArray(s);if(l&&l.length>0)0===(h=DataSource.getTimeIndex(i,l))&&l[0].time>i?a.exchangeTimezoneOffset=l[h].timezoneOffset:(l[h].time<i&&(h=Math.min(h+1,l.length-1)),r[s]=new e(this.data,h),a.exchangeTimezoneOffset=l[h].timezoneOffset,a.closePrice=l[h].close)}var h,c=this.afterHoursData.getPointsInIntervalArray(t.Const.INTRADAY_INTERVAL);if(c&&c.length>0&&this.visibleExtendedHours.length())if(0!==(h=DataSource.getTimeIndex(i,c))||c[0].time<=i)if(c[h].time<i&&(h=Math.min(h+1,c.length-1)),r[t.Const.INTRADAY_INTERVAL]){var u=this.data.getPointsInIntervalArray(t.Const.INTRADAY_INTERVAL)[r[t.Const.INTRADAY_INTERVAL].position].time,d=c[h].time;(u>=i&&d>=i&&d<u||u<i&&d>u)&&(r[t.Const.INTRADAY_INTERVAL]=new e(this.afterHoursData,h),a.exchangeTimezoneOffset=c[h].timezoneOffset,a.closePrice=c[h].close)}else r[t.Const.INTRADAY_INTERVAL]=new e(this.afterHoursData,h),a.exchangeTimezoneOffset=c[h].timezoneOffset,a.closePrice=c[h].close;else a.exchangeTimezoneOffset=c[h].timezoneOffset;return a.posInInterval=r,a},DataSource.prototype.parseHeader=function(t,e){for(var i={},n=0,a=t;n<a.length;n++){var r=a[n].split("=");if(r.length<=1)return null;if(r[0]===DataSource.DATA_STR)return i;i[r[0]]=r[1]}return null},DataSource.prototype.computeIntradaySessions=function(e){var i=t.Const.INTRADAY_INTERVAL;e.intradayRegions.length=0;for(var n=0,a=0,r=1;r<e.units.length;r++){var o=e.units[r],s=e.units[r-1];(o.time-s.time)/1e3!==i?(a>0&&e.intradayRegions.push(new t.StartEndPair(n,r-1)),n=r,a=0):a++}a>0&&e.intradayRegions.push(new t.StartEndPair(n,e.points.length-1))},DataSource.prototype.addStreamForPointsInIntervals=function(t,e){this.data.setPointsInIntervalArray(t,e)},DataSource.prototype.makeDataUnitEndOfDay=function(e,i,n,a){var r=n.end-n.start,o=60*-(e.dayMinute-n.end)*1e3;o-=1e3*e.exchangeDateInUTC.getUTCSeconds(),e.setDate(e.time+o,e.timezoneOffset),this.baseInterval<t.Const.DAILY_INTERVAL&&this.addFakeDataUnits(i,e,a,r/this.baseMinutesInterval,t.Directions.BACKWARD),i.push(e)},DataSource.prototype.selectObject=function(t,e,i){var n=null;if(void 0===this.objects[t])return null;for(var a=0,r=this.objects[t];a<r.length;a++){var o=r[a];o.active=!1,"newspin"===t&&(o.forceExpandInGroup=!1),o.id!==e||i&&o.letter!==i||(o.active=!0,n=o)}return n},DataSource.prototype.objectInTheFuture=function(e,i){var n;if(t.Const.INDICATOR_ENABLED){var a=i.getPointsInIntervalArray(t.Const.INTRADAY_INTERVAL),r=notnull(e.posInInterval)[t.Const.INTRADAY_INTERVAL];if(!a||0===a.length||!r||r.position!==a.length-1)return!1;n=a[a.length-1]}else{var o=i.units.length;if(e.pos!==o-1)return!1;n=i.units[o-1]}var s=n.exchangeDateInUTC,l=new Date(e.time+n.timezoneOffset);return!(l.getUTCFullYear()<s.getUTCFullYear())&&(l.getUTCFullYear()>s.getUTCFullYear()||!(l.getUTCMonth()<s.getUTCMonth())&&(l.getUTCMonth()<s.getUTCMonth()||!(l.getUTCDate()<s.getUTCDate())&&l.getUTCDate()>s.getUTCDate()))},DataSource.prototype.extractAfterHoursSessions=function(t){if(0!==this.afterHoursData.units.length)for(var e=this.afterHoursData.units[0],i=notnull(this.afterHoursData.getSessionForMinute(e.dayMinute)),n=0,a=0,r=0;r<this.afterHoursData.units.length;r++)(e=this.afterHoursData.units[r]).dayMinute===i.start?n=r:e.dayMinute===i.end&&(a=r,t.addInterval(n,a),r<this.afterHoursData.units.length-1&&(e=this.afterHoursData.units[r+1],i=notnull(this.afterHoursData.getSessionForMinute(e.dayMinute))))},DataSource.prototype.computeObjectPositions=function(){for(var e=NaN,i=0,n=Object.keys(this.objects);i<n.length;i++){for(var a=n[i],r=this.objects[a],o=r.length-1;o>=0;o--){var s=r[o];if(t.Const.INDICATOR_ENABLED){var l=this.getObjectPositionsInInterval(r[o].time);s.posInInterval=l.posInInterval,e=l.closePrice}else{var h=this.getObjectPositions(r[o].time,this.data);h.pos>=0&&h.pos<notnull(h.refDataSeries).units.length&&(s.pos=h.pos,s.dayPos=h.dayPos,s.refDataSeries=h.refDataSeries,e=notnull(h.refDataSeries).units[h.pos].close)}if("dividend"===a){var c=s;c.yield=c.amount/e}}r.sort(t.StockAssociatedObject.compare)}},DataSource.prototype.getRelativeMinutesState=function(){return this.relativeMinutesState},DataSource.prototype.hasEvent=function(t){return!!this.events[t]},DataSource.prototype.mergePoints=function(t,e,i,n){for(var a=[],r=0,o=0;r<t.length||o<e.length;)if(r===t.length)for(;o<e.length;)a.push(e[o]),o++;else if(o===e.length)for(;r<t.length;)a.push(t[r]),r++;else if(t[r].time<e[o].time)a.push(t[r++]);else if(t[r].time===e[o].time){var s=void 0;s=i&&t[r].fake||e[o].realtime&&n<=r||e[o].coveredDays<t[r].coveredDays?e[o]:t[r],a.push(s),s.addVolumeInfo(t[r]),s.addVolumeInfo(e[o]),r++,o++}else a.push(e[o++]);return a},DataSource.prototype.extractSessions=function(t,e){for(var i=0,n=(t=t.slice(1,t.length-1)).split("],[");i<n.length;i++){var a=n[i].split(",");e.addDataSession(Number(a[1]),Number(a[2]),a[0])}},DataSource.prototype.getClosestDataUnitAfterMinute=function(t){var e=this.afterHoursData.getRelativeMinuteIndex(t),i=this.afterHoursData.units[e+1],n=this.data.getRelativeMinuteIndex(t),a=this.data.units[n+1];return i||a?i?a?t>a.relativeMinutes&&t>i.relativeMinutes?null:0===this.visibleExtendedHours.length()||isNaN(i.relativeMinutes)||i.relativeMinutes<t?a:a.relativeMinutes<t?i:a.relativeMinutes-t<i.relativeMinutes-t?a:i:i:a:null},DataSource.prototype.addObject=function(e){if(e){var i,n=e._type?e._type:"newspin";if(this.objects[n]||(this.objects[n]=[]),e._date instanceof Date)i=e._date.getTime();else{if(isNaN(e._date))return;i=1e3*Number(e._date)}var a,r,o,s,l=NaN,h=NaN;if(t.Const.INDICATOR_ENABLED){var c=this.getObjectPositionsInInterval(i);if(isNaN(c.exchangeTimezoneOffset))return;s=c.exchangeTimezoneOffset,o=c.closePrice,r=c.posInInterval,a=null}else{var u=notnull((c=this.getObjectPositions(i,this.data)).refDataSeries);if(c.pos<0||c.pos>=u.units.length)return;s=u.units[c.pos].timezoneOffset,o=u.units[c.pos].close,l=c.pos,h=notnull(c.dayPos),a=c.refDataSeries,r=null}var d,g=t.Utils.newDateInTimezone(new Date(i),s);switch(n){case"newspin":d=new t.PinPoint(l,h,r,i,g,e._id,this.quoteName,e._letter);break;case"split":if(d=new t.Split(l,h,r,i,g,e._id,this.quoteName,e._old_shares,e._new_shares),this.objectInTheFuture(d,this.data))return;break;case"dividend":if(d=new t.Dividend(l,h,r,i,g,e._id,this.quoteName,e._amount,e._amount_currency,o),this.objectInTheFuture(d,this.data))return;break;case"stock_dividend":if(d=new t.StockDividend(l,h,r,i,g,e._id,this.quoteName,e._ticker,e._adjustment_factor),this.objectInTheFuture(d,this.data))return;break;default:d=new t.StockAssociatedObject(l,h,r,i,g,e._id,this.quoteName)}d.originalObject=e,d.refDataSeries=a,this.objects[n].push(d)}},DataSource.prototype.eventDone=function(e){this.events[e]=t.ChartEventPriorities.DONE},DataSource.prototype.addAHStreamForPointsInIntervals=function(e){this.afterHoursData.setPointsInIntervalArray(t.Const.INTRADAY_INTERVAL,e)},DataSource.prototype.dayIndexHasVisibleExtendedHours=function(t){if(0===this.visibleExtendedHours.length())return!1;var e=this.data.units[this.data.days[t]];if(t===this.data.days.length-1)return 0!==e.relativeMinutes;var i=this.data.units[this.data.days[t]+1];return(!this.data.minuteIsEndOfDataSession(e.dayMinute)||!this.data.minuteIsEndOfDataSession(i.dayMinute))&&i.relativeMinutes-e.relativeMinutes!=1},DataSource.prototype.isEmpty=function(){return 0===this.data.points.length},DataSource.prototype.getVisibleDataUnitForMinute=function(t){if(this.visibleExtendedHours.length()>0)return notnull(this.getClosestDataUnitLessThen(t));var e=this.data.getRelativeMinuteIndex(t);return this.data.units[e]},DataSource.prototype.getObjectPositions=function(i,n){var a,r=n.units,o=n.days,s=DataSource.getTimeIndex(i,r);if(-1===s)return new e(null,-1,-1);if(0===s&&i<r[0].time)return new e(n,0,0);var l=new Date(i);if(r[s].dayMinute===n.marketCloseMinute){var h=new Date(r[s].time),c=t.Utils.getDateInTimezone(h,r[s].timezoneOffset),u=t.Utils.getDateInTimezone(l,r[s].timezoneOffset);if(c<u){var d=void 0;s<r.length-1?(h=new Date(r[s+1].time),d=t.Utils.getDateInTimezone(h,r[s].timezoneOffset)):d=c,a=d===u?o[n.getNextDayStart(s+1)]:s,s<r.length-1&&r[s+1].dayMinute===n.marketCloseMinute&&(s=a)}else if(c>u){var g=void 0,p=void 0;s>0?(p=n.getPrevDayStart(s),h=new Date(r[p].time),g=t.Utils.getDateInTimezone(h,r[s].timezoneOffset)):(p=s,g=c),a=g===u?o[n.getPrevDayStart(s)]:s,0!==s&&r[s-1].dayMinute!==n.marketCloseMinute||(s=a)}else a=s}else a=o[n.getNextDayStart(s)];var v=r[s],y=null;s<r.length-1&&(y=r[s+1]);var f=n;return(!y&&0!==v.relativeMinutes||y&&v.dayMinute===n.marketCloseMinute&&y.dayMinute===n.marketOpenMinute&&y.relativeMinutes-v.relativeMinutes>1)&&0!==this.afterHoursData.units.length&&(y||(s=this.afterHoursData.units.length-1,y=this.afterHoursData.units[s]),s=DataSource.getTimeIndex(i,this.afterHoursData.units),a=DataSource.getTimeIndex(y.time,this.afterHoursData.units),f=this.afterHoursData),new e(f,s,a)},DataSource.prototype.objectsToString=function(){for(var t="",e=0,i=Object.keys(this.objects);e<i.length;e++){var n=i[e];t+=", "+this.objects[n].toString()}return t},DataSource.prototype.markEvent=function(t,e){var i=t.getEventName();return("5Y"!==t.period||!this.hasEvent(t.getEventName("40Y")))&&(this.hasEvent(i)?this.events[i]<e&&(this.events[i]=e,!0):(this.events[i]=e,!0))},DataSource.prototype.clearAllObjects=function(t){this.objects[t]=[]},DataSource.prototype.getEndOfDayDataUnitFor=function(e){var i=DataSource.getMinuteMetaIndex(e,this.data.days,this.data.units);if(-1===i)return this.data.units[this.data.days[0]];var n=this.data.days[i];if(n+1<this.data.units.length&&this.data.minuteIsEndOfDataSession(this.data.units[n+1].dayMinute))return e===this.data.units[n].relativeMinutes?this.data.units[n]:this.data.units[n+1];if(n+1<this.data.units.length&&e>=this.data.units[n+1].relativeMinutes&&(i++,n=this.data.days[i]),!this.dayIndexHasVisibleExtendedHours(i))return n=this.data.days[i],this.data.units[n];var a=DataSource.getMinuteMetaIndex(e,this.afterHoursData.days,this.afterHoursData.units),r=this.afterHoursData.days[a];e>this.afterHoursData.units[r].relativeMinutes&&a+1<this.afterHoursData.days.length&&(r=this.afterHoursData.days[a+1]);var o=this.afterHoursData.units[r],s=this.data.units[n];e>s.relativeMinutes&&i+1<this.data.days.length&&(n=this.data.days[i+1],s=this.data.units[n]);var l=this.getClosestDataUnitLessThen(e);return l?0===t.Utils.compareUtcDates(l.exchangeDateInUTC,s.exchangeDateInUTC)&&0===t.Utils.compareUtcDates(l.exchangeDateInUTC,o.exchangeDateInUTC)?o.time>s.time?o:s:0===t.Utils.compareUtcDates(l.exchangeDateInUTC,o.exchangeDateInUTC)?o:(t.Utils.compareUtcDates(l.exchangeDateInUTC,s.exchangeDateInUTC),s):s},DataSource.prototype.checkHeaderSanity=function(e,i){var n=e[DataSource.MARKET_CLOSE_MINUTE_STR],a=e[DataSource.MARKET_OPEN_MINUTE_STR];a&&(i.marketOpenMinute=Number(a)),n&&(i.marketCloseMinute=Number(n),this.quoteName.indexOf("CURRENCY")>=0&&(i.marketCloseMinute-=(i.marketCloseMinute-i.marketOpenMinute)%this.intradayMinutesInterval)),Number(n)-Number(a)<30&&(i.marketCloseMinute=t.Const.MARKET_CLOSE_MINUTE,i.marketOpenMinute=t.Const.MARKET_OPEN_MINUTE),e[DataSource.DATA_SESSIONS_STR]?this.extractSessions(e[DataSource.DATA_SESSIONS_STR],i):i.addDataSession(i.marketOpenMinute,i.marketCloseMinute,t.Const.REGULAR_MARKET_NAME),i.marketDayLength=i.allSessionsLength()},DataSource.prototype.setRelativeMinutesState=function(t){this.relativeMinutesState=t},DataSource.prototype.getObjPos=function(t,e){if(void 0===this.objects[t])return-1;for(var i=this.objects[t].length-1;i>=0;i--)if(this.objects[t][i].id===e)return i;return-1},DataSource.prototype.addFakeDataUnits=function(e,i,n,a,r,o){if(void 0===o&&(o=0),0!==a)for(var s=a;s>0;s--){var l=new t.DataUnit(i.close,i.high,i.low,i.open);l.volumes[this.baseInterval]=0,l.intervals[0]=this.baseInterval;var h=o*t.Const.MS_PER_MINUTE;switch(r){case t.Directions.BACKWARD:h+=i.time-s*this.baseInterval*1e3;break;case t.Directions.FORWARD:h+=i.time+(a-s+1)*this.baseInterval*1e3}l.setDate(h,i.timezoneOffset),l.fake=!0,l.duplicate=n.minuteIsStartOfDataSession(l.dayMinute),e.push(l)}},DataSource.prototype.clearAllIndicatorsOnAddData=function(t){for(var e=0,i=Object.keys(this.indicators);e<i.length;e++){var n=i[e];this.indicators[n].clearAllOnAddData?this.indicators[n].clear():this.indicators[n].clear(t)}},DataSource.prototype.clearCoalescedChildren=function(){this.data.clearCoalescedChildren()},DataSource.prototype.clearAllIndicators=function(){for(var t=0,e=Object.keys(this.indicators);t<e.length;t++){var i=e[t];this.indicators[i].clear()}},DataSource.prototype.isTradeHaltedInterday=function(e,i,n){return!(n<t.Const.DAILY_INTERVAL)&&(!(e.volumes[n]>0)&&(i.close===e.close&&(isNaN(e.open)||e.open===e.close)&&(isNaN(e.high)||e.high===e.close)&&(isNaN(e.low)||e.low===e.close)))},DataSource.prototype.removeObject=function(t,e){var i=this.getObjPos(t,e);-1!==i&&this.objects[t].splice(i,1)},DataSource.prototype.addAfterHoursUnitToLastMinute=function(e,i,n,a){var r=0;if(n){var o=a.getSessionIndex(n.start);if(0===i.length)return this.addFakeDataUnitsForSessions(i,e,a,0,o,t.Directions.BACKWARD),void this.makeDataUnitEndOfDay(e,i,n,a);var s=i[i.length-1],l=notnull(a.getSessionForMinute(s.dayMinute)),h=a.getSessionIndex(s.dayMinute);s&&s.dayMinute<l.end&&(r=(l.end-s.dayMinute)/this.baseMinutesInterval,this.addFakeDataUnits(i,s,a,r,t.Directions.FORWARD),s=i[i.length-1]);var c=(e.time-s.time)/t.Const.MS_PER_MINUTE,u=n.end-n.start;if(c>e.dayMinute-n.end+u)DataSource.unitsInDifferentDays(s,e)?(this.addFakeDataUnitsForSessions(i,i[i.length-1],a,h+1,a.dataSessions.length(),t.Directions.FORWARD),this.addFakeDataUnitsForSessions(i,e,a,0,o,t.Directions.BACKWARD)):this.addFakeDataUnitsForSessions(i,i[i.length-1],a,h+1,o,t.Directions.FORWARD),this.makeDataUnitEndOfDay(e,i,n,a);else{s.close=e.close,!isNaN(s.high)&&s.high<s.close&&(s.high=s.close),!isNaN(s.low)&&s.low>s.close&&(s.low=s.close);var d=e.intervals[0];s.volumes[d]+=e.volumes[d]}}},DataSource.prototype.getDataUnitNoValidation=function(e,n,a){for(var r=new t.DataUnit(NaN,NaN,NaN,NaN),o=0;o<n.length;o++)if(n[o]===i.COL_DATE_TYPE){var s=void 0;isNaN(Number(e[o]))?(this.lastAbsTime=Number(e[o].substr(1)),s=1e3*this.lastAbsTime):s=1e3*(this.lastAbsTime+Number(e[o])*this.baseInterval),r.setDate(s,this.timezoneOffset)}else n[o]===i.COL_CLOSE_TYPE?r.close=Number(e[o]):n[o]===i.COL_OPEN_TYPE?r.open=Number(e[o]):n[o]===i.COL_LOW_TYPE?r.low=Number(e[o]):n[o]===i.COL_HIGH_TYPE?r.high=Number(e[o]):n[o]===i.COL_VOLUME_TYPE?(r.volumes[Number(a[DataSource.INTERVAL_STR])]=Number(e[o]),r.intervals.push(this.baseInterval)):n[o]===i.COL_CDAYS_TYPE&&(r.coveredDays=Number(e[o]));return r},DataSource.COLUMNS_STR="COLUMNS",DataSource.INTERVAL_STR="INTERVAL",DataSource.MARKET_CLOSE_MINUTE_STR="MARKET_CLOSE_MINUTE",DataSource.DATA_SESSIONS_STR="DATA_SESSIONS",DataSource.TIMEZONE_OFFSET_STR="TIMEZONE_OFFSET",DataSource.EXCHANGE_STR="EXCHANGE",DataSource.MARKET_OPEN_MINUTE_STR="MARKET_OPEN_MINUTE",DataSource.DATA_STR="DATA",DataSource.RELATIVE_MINUTES_NOT_READY=0,DataSource.DMS_RELATIVE_MINUTES_READY=2,DataSource.RELATIVE_MINUTES_READY=1,DataSource}();t.DataSource=a}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){function DataUnit(t,e,i,n){this.close=t,this.high=e,this.low=i,this.open=n,this.duplicate=!1,this.intervals=[],this.volumes={},this.fake=!1,this.coveredDays=0,this.realtime=!1}return DataUnit.prototype.toString=function(){var e=this.exchangeDateInUTC,i=t.Utils.utcDateToString(e);return isNaN(this.relativeMinutes)||(i+="[relMin:"+this.relativeMinutes+"]"),this.time+" "+this.dayMinute+" "+i+" "+close},DataUnit.prototype.getHighLogValue=function(e){return e===t.Const.LOG_VSCALE||e===t.Const.NEW_LOG_VSCALE?this.logHigh||(this.logHigh=t.Utils.logTransform(this.high)):this.high},DataUnit.prototype.getLowLogValue=function(e){return e===t.Const.LOG_VSCALE||e===t.Const.NEW_LOG_VSCALE?this.logLow||(this.logLow=t.Utils.logTransform(this.low)):this.low},DataUnit.prototype.setExchangeDateInUTC=function(e,i){this.timezoneOffset=i,this.time=e-i*t.Const.MS_PER_MINUTE,this.exchangeDateInUTC=new Date(e),this.dayMinute=60*this.exchangeDateInUTC.getUTCHours()+this.exchangeDateInUTC.getUTCMinutes(),assert(!isNaN(this.dayMinute))},DataUnit.prototype.addVolumeInfo=function(t){for(var e=0,i=t.intervals;e<i.length;e++){var n=i[e];void 0===this.volumes[n]&&(this.volumes[n]=t.volumes[n],this.intervals.push(n))}},DataUnit.prototype.getOpenLogValue=function(e){return e===t.Const.LOG_VSCALE||e===t.Const.NEW_LOG_VSCALE?this.logOpen||(this.logOpen=t.Utils.logTransform(this.open)):this.open},DataUnit.prototype.setData=function(t,e){return!isNaN(Number(e))&&(this[t]=Number(e),!0)},DataUnit.prototype.getCloseLogValue=function(e){return e===t.Const.LOG_VSCALE||e===t.Const.NEW_LOG_VSCALE?this.logClose||(this.logClose=t.Utils.logTransform(this.close)):this.close},DataUnit.prototype.setDate=function(t,e){this.timezoneOffset=e,this.time=t,this.exchangeDateInUTC=new Date(t+6e4*e),this.dayMinute=60*this.exchangeDateInUTC.getUTCHours()+this.exchangeDateInUTC.getUTCMinutes(),assert(!isNaN(this.dayMinute))},DataUnit}();t.DataUnit=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(e){var i=function(){return function DayVisibility(){}}();e.DayVisibility=i;var n=function(n){function DateLinesLayer(){var t=null!==n&&n.apply(this,arguments)||this;return t.topMargin=0,t.tickPosition=e.TickPositions.TOP,t}return __extends(DateLinesLayer,n),DateLinesLayer.prototype.getDayPixel=function(t,e,i){return(t.getDisplayManager().isDifferentMarketSessionComparison()?1:e.marketDayLength+i)*t.minutePix},DateLinesLayer.prototype.getHourTextFromUtcDate=function(i){var n="HH:mm";return 0!==i.getUTCMinutes()||e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale())||(n="h a"),t.i18n.locale.DateTimeLocale.formatDateTime(n,i,!0).toLowerCase()},DateLinesLayer.prototype.adjustVisibleDaysWithAfterHours=function(t){for(var i=this.dataSource.afterHoursData,n=this.dataSource.visibleExtendedHours,a=0;a<n.length();a++){var r=n.getIntervalAt(a),o=r.end,s=r.start,l=i.units[s].time,h=i.units[o].dayMinute-i.units[s].dayMinute,c=e.Utils.binarySearch(t,l,this.compareVisibleDayPairWithTime,this);-1!==c&&(c<t.length&&t[c].dataUnit.time===l?(t[c].coveredMinutes+=h,t[c].dataUnit=i.units[o]):c+1<t.length&&(t[c+1].startMinute=t[c+1].startMinute-h,t[c+1].coveredMinutes=t[c+1].coveredMinutes+h))}},DateLinesLayer.prototype.drawVerticalLines=function(t){var i=this.dataSource.data,n=this.viewPoint;if(i&&!this.dataSource.isEmpty()){this.graphics.clear();var a=i.getRelativeMinuteIndex(n.getLastMinute()),r=this.getDayPixel(n,i,0),o=e.Const.INDICATOR_ENABLED?n.getDetailLevelForTechnicalStyle():n.getDetailLevel();!n.getDisplayManager().isDifferentMarketSessionComparison()&&r>e.Const.MIN_DAY_WIDTH_FOR_INTRADAY&&o<=e.Intervals.DAILY?this.drawDayStarts(this,this.textCanvas,this.getVisibleDaysArray(t),o):r>15?this.drawWeekStarts(this,this.textCanvas,1,a):r>2?this.drawMonthStarts(this,this.textCanvas,1,a):this.drawYearStarts(this,this.textCanvas,1,a)}},DateLinesLayer.prototype.getMinutesSkip=function(){for(var t=this.viewPoint.count*e.ViewPoint.MIN_DISTANCE_BETWEEN_V_LINES/(this.viewPoint.maxx-this.viewPoint.minx),i=DateLinesLayer.HOUR_INTERVALS.length-1;DateLinesLayer.HOUR_INTERVALS[i]>=t&&i>0;)i--;return DateLinesLayer.HOUR_INTERVALS[i]},DateLinesLayer.prototype.drawWeekStarts=function(i,n,a,r){for(var o=this.dataSource.data,s=this.viewPoint,l=o.days.length-1;l>0&&o.days[l]>r;)l-=a;(l+=a)>o.days.length-1&&(l=o.days.length-1);for(var h=o.fridays.length-1;h>=0&&o.fridays[h]>o.days[l];)h-=a;var c=this.getDayPixel(s,o,2),u=s.getXPos(o.units[o.days[l]]),d=s.maxy-e.ViewPoint.TEXT_VERTICAL_OFFSET-e.ViewPoint.TEXT_FIELD_HEIGHT,g=Number.MAX_VALUE;do{if(o.days[l]===o.fridays[h]){u=s.getXPos(o.units[o.days[l]]);var p=s.miny+this.topMargin,v=s.maxy-s.bottomTextHeight;if(e.AbstractLayer.drawVerticalLine(i,u,e.Const.DAY_LINE_COLOR,e.Const.DAY_LINE_ALPHA,p,v,e.ViewPoint.TICK_SIZE_BIG,this.tickPosition),s.bottomTextHeight>0&&l>=0){var y=o.units[o.days[l]].exchangeDateInUTC,f=this.getWeekStartDateFormat(),T=t.i18n.locale.DateTimeLocale.formatDateTime(f,y,!0),I=u-e.ViewPoint.TEXT_FIELD_WIDTH/2,L=e.ViewPoint.addTextField(n,T,I,d,e.ViewPoint.TEXT_FIELD_WIDTH,e.ViewPoint.TEXT_FIELD_HEIGHT,"center",s.hourTextFormat);g-l>=DateLinesLayer.WEEK_TEXT_MIN_DAYS?g=l:n.removeChild(L)}}else{p=s.miny+this.topMargin,v=s.maxy-s.bottomTextHeight;e.AbstractLayer.drawVerticalLine(i,u,e.Const.DAY_LINE_COLOR,0,p,v,e.ViewPoint.TICK_SIZE_SMALL,this.tickPosition)}l-=a,o.fridays[h]>o.days[l]&&h--,u-=c}while(u>=s.minx&&l>0)},DateLinesLayer.prototype.drawYearStarts=function(t,i,n,a){var r=this.dataSource.data;if(0!==r.years.length){var o=this.viewPoint,s=r.years.length-1,l=this.getDayPixel(o,r,1),h=o.getXPos(r.units[r.years[s]]),c=h+250*l,u=o.maxy-e.ViewPoint.TEXT_VERTICAL_OFFSET-e.ViewPoint.TEXT_FIELD_HEIGHT;do{h=o.getXPos(r.units[r.years[s]]);var d=o.miny+this.topMargin,g=o.maxy-o.bottomTextHeight;if(e.AbstractLayer.drawVerticalLine(t,h-l,e.Const.DAY_LINE_COLOR,e.Const.DAY_LINE_ALPHA,d,g,e.ViewPoint.TICK_SIZE_BIG,this.tickPosition),o.bottomTextHeight>0&&s>=0){var p=r.units[r.years[s]].exchangeDateInUTC.getUTCFullYear().toString();c-h<DateLinesLayer.FULL_YEAR_TEXT_MAX_WIDTH&&(p="'"+p.substr(2,2)),e.ViewPoint.addTextField(i,p,h,u,c-h,e.ViewPoint.TEXT_FIELD_HEIGHT,"center",o.dateTextFormat)}s-=n,c=h}while(h>o.minx&&s>=0)}},DateLinesLayer.prototype.drawMonthStarts=function(i,n,a,r){var o=this.dataSource.data;if(0!==o.firsts.length){for(var s=this.viewPoint,l=o.firsts.length-1;o.firsts[l]>r;)l-=a;var h=this.getDayPixel(s,o,0),c=s.getXPos(o.units[o.firsts[l]]),u=c+20*h,d=u,g=s.maxy-e.ViewPoint.TEXT_VERTICAL_OFFSET-e.ViewPoint.TEXT_FIELD_HEIGHT,p=20*h<70;do{c=s.getXPos(o.units[o.firsts[l]]);var v=s.miny+this.topMargin,y=s.maxy-s.bottomTextHeight;if(e.AbstractLayer.drawVerticalLine(i,c-h,e.Const.DAY_LINE_COLOR,e.Const.DAY_LINE_ALPHA,v,y,e.ViewPoint.TICK_SIZE_BIG,this.tickPosition),s.bottomTextHeight>0&&l>=0){var f=o.units[o.firsts[l]].exchangeDateInUTC,T=this.getMonthStartDateFormat(20*h),I=t.i18n.locale.DateTimeLocale.formatDateTime(T,f,!0),L=u-c,m=c;d-c>DateLinesLayer.MONTH_TEXT_MIN_PIXELS&&(p?f.getUTCMonth()%3==0&&(m-=L/2,e.ViewPoint.addTextField(n,I,m,g,L,e.ViewPoint.TEXT_FIELD_HEIGHT,"center",s.dateTextFormat),d=c):(e.ViewPoint.addTextField(n,I,m,g,L,e.ViewPoint.TEXT_FIELD_HEIGHT,"center",s.dateTextFormat),d=c))}l-=a,u=c}while(c>s.minx&&l>=0)}},DateLinesLayer.prototype.renderLayer=function(t){this.drawVerticalLines(t)},DateLinesLayer.prototype.compareVisibleDayPairWithTime=function(t,e){return t.dataUnit.time<e?-1:t.dataUnit.time>e?1:0},DateLinesLayer.prototype.getMonthStartDateFormat=function(i){return i>90?e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale())?"yyyyMMMMM":"MMM yyyy":e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale())?"yyMMMMM":"MMM'yy"},DateLinesLayer.prototype.drawHoursForDay=function(t,i,n,a){for(var r=n.dataUnit,o=n.startMinute,s=n.coveredMinutes,l=this.getMinutesSkip(),h=this.viewPoint.getIntervalLength(l),c=this.viewPoint.getXPos(r)-h,u=this.viewPoint.miny+this.topMargin,d=this.viewPoint.maxy-this.viewPoint.bottomTextHeight,g=this.viewPoint.maxy-e.ViewPoint.TEXT_VERTICAL_OFFSET-e.ViewPoint.TEXT_FIELD_HEIGHT,p=h,v=e.ViewPoint.TEXT_FIELD_HEIGHT,y=this.dataSource.getAllDataSessions(o,r.dayMinute),f=y.length()-1,T=y.getIntervalAt(f),I=r.dayMinute,L=new Date(r.exchangeDateInUTC.getTime());I>o;){for(var m=I,M=Number(l);M>0;){var C=I-T.start;if(C>=M)I-=M,M=0;else{if(M=Number(M-C),--f<0)return;I=(T=y.getIntervalAt(f)).end}}if(L.setTime(L.getTime()-(m-I)*e.Const.MS_PER_MINUTE),I<=o)return;if(s-=l,this.viewPoint.getIntervalLength(s)<DateLinesLayer.DAY_START_TEXT_MAX_WIDTH)return;e.AbstractLayer.drawVerticalLine(t,c,e.Const.HOUR_LINE_COLOR,e.Const.HOUR_LINE_ALPHA,u,d,e.ViewPoint.TICK_SIZE_SMALL,this.tickPosition);var E=this.getHourTextFromUtcDate(L);e.ViewPoint.addTextField(i,E,c,g,p,v,"left",this.viewPoint.hourTextFormat),c-=h}},DateLinesLayer.prototype.drawDayStarts=function(t,i,n,a){for(var r=this.viewPoint.maxy-e.ViewPoint.TEXT_VERTICAL_OFFSET-e.ViewPoint.TEXT_FIELD_HEIGHT,o=0;o<n.length;o++){var s=this.viewPoint.getXPos(n[o].dataUnit);if(this.viewPoint.bottomTextHeight>0){var l=this.viewPoint.getIntervalLength(n[o].coveredMinutes),h=this.getDayText(n,o,l),c="center";l>=DateLinesLayer.DISPLAY_HOURS_MIN_DAY_WIDTH&&a<e.Intervals.DAILY&&(c="left",this.drawHoursForDay(t,i,n[o],l));var u=void 0,d=void 0;a<e.Intervals.DAILY?(u=s-l+e.ViewPoint.TEXT_HORIZONTAL_OFFSET,d=l-e.ViewPoint.TEXT_HORIZONTAL_OFFSET):(u=s-e.ViewPoint.TEXT_FIELD_WIDTH/2,d=e.ViewPoint.TEXT_FIELD_WIDTH),e.ViewPoint.addTextField(i,h,u,r,d,e.ViewPoint.TEXT_FIELD_HEIGHT,c,this.viewPoint.hourTextFormat)}}},DateLinesLayer.prototype.getVisibleDaysArray=function(t){var n=[],a=this.dataSource.data,r=1+e.DataSource.getMinuteMetaIndex(t.lastMinute,a.days,a.units);r=Math.min(r,a.days.length-1);for(var o=e.DataSource.getMinuteMetaIndex(t.lastMinute-t.count,a.days,a.units);o<=r;o++){var s=a.units[a.days[o]];if(s){var l=new i;l.dataUnit=s,l.startMinute=a.marketOpenMinute,l.coveredMinutes=a.marketDayLength,n.push(l)}}return this.adjustVisibleDaysWithAfterHours(n),n},DateLinesLayer.prototype.getDayText=function(i,n,a){var r=i[n].dataUnit.exchangeDateInUTC,o="d";return(a>50||2===n||n===i.length-2)&&(o="MMM "+o,e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale())&&(o="Md")),a>75&&(o="E "+o,e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale())&&(o="Md E")),t.i18n.locale.DateTimeLocale.formatDateTime(o,r,!0)},DateLinesLayer.prototype.getWeekStartDateFormat=function(){return e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale())?"Md":"MMM d"},DateLinesLayer.HOUR_INTERVALS=[60,120,240],DateLinesLayer.WEEK_TEXT_MIN_DAYS=3,DateLinesLayer.MONTH_TEXT_MIN_PIXELS=55,DateLinesLayer.FULL_YEAR_TEXT_MAX_WIDTH=40,DateLinesLayer.DISPLAY_HOURS_MIN_DAY_WIDTH=180,DateLinesLayer.DAY_START_TEXT_MAX_WIDTH=65,DateLinesLayer}(e.AbstractLayer);e.DateLinesLayer=n}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(e){var i;!function(t){t[t.INPUT=0]="INPUT",t[t.DYNAMIC=1]="DYNAMIC"}(i=e.TextFieldType||(e.TextFieldType={}));var n=function(){function TextFormatAlign(){}return TextFormatAlign.RIGHT="right",TextFormatAlign}();e.TextFormatAlign=n;var a=function(){function TextFieldAutoSize(){}return TextFieldAutoSize.LEFT="left",TextFieldAutoSize.RIGHT="right",TextFieldAutoSize.CENTER="center",TextFieldAutoSize}();e.TextFieldAutoSize=a;var r=function(){return function TextFormat(t,e,i,n,a,r){void 0===t&&(t="Arial"),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=!1),void 0===a&&(a=!1),void 0===r&&(r=!1),this.family=t,this.size=e,this.color=i,this.bold=n,this.italic=a,this.underline=r}}();e.TextFormat=r;var o=function(t){function TextField(){var e=t.call(this,document.createElement("span"))||this;return e.type=i.INPUT,e}return __extends(TextField,t),TextField.prototype.appendText=function(t){this.element.textContent+=t},TextField.prototype.setTextFormat=function(t,e,i){void 0===e&&(e=-1),void 0===i&&(i=-1)},TextField.prototype.getTextFormat=function(){return null},Object.defineProperty(TextField.prototype,"defaultTextFormat",{set:function(t){this.element.style.fontFamily=t.family||"Arial",this.element.style.fontSize=t.size+"px",this.element.style.color=cssColor(t.color),this.element.style.textAlign=t.align||"left"},enumerable:!0,configurable:!0}),TextField.prototype.setSelection=function(t,e){},Object.defineProperty(TextField.prototype,"width",{get:function(){return this.element.offsetWidth},set:function(t){this.element.style.width=t+"px"},enumerable:!0,configurable:!0}),Object.defineProperty(TextField.prototype,"height",{get:function(){return this.element.offsetHeight},set:function(t){this.element.style.height=t+"px"},enumerable:!0,configurable:!0}),Object.defineProperty(TextField.prototype,"text",{get:function(){return this.element.textContent||""},set:function(t){this.element.textContent=t},enumerable:!0,configurable:!0}),Object.defineProperty(TextField.prototype,"htmlText",{get:function(){return this.element.innerHTML},set:function(t){this.element.innerHTML=t},enumerable:!0,configurable:!0}),Object.defineProperty(TextField.prototype,"textColor",{get:function(){return this._textColor},set:function(t){this._textColor=t,this.element.style.color=cssColor(t)},enumerable:!0,configurable:!0}),Object.defineProperty(TextField.prototype,"textHeight",{get:function(){return this._textHeight},set:function(t){this._textHeight=t,this.element.style.fontSize=t+"pt"},enumerable:!0,configurable:!0}),TextField}(t.display.InteractiveObject);e.TextField=o}(t.text||(t.text={}))}(flash||(flash={})),function(t){!function(t){!function(e){var i=function(i){function DateTextField(){return null!==i&&i.apply(this,arguments)||this}return __extends(DateTextField,i),DateTextField.newDateInUtc=function(t,e,i){var n=new Date;return n.setUTCFullYear(t),n.setUTCMonth(e-1,i),n.setUTCHours(0,0,0,0),n},DateTextField.stringToNumberOrOne=function(t){return t?Number(t.replace("/","").replace("-","").replace(".","")):1},DateTextField.prototype.setHighlighted=function(t){t?(this.background=!0,this.borderColor=e.Const.DATE_HIGHLIGHTED_BORDER_COLOR):(this.background=!1,this.borderColor=e.Const.DATE_DEFAULT_BORDER_COLOR,this.setSelection(0,0),this.type=flash.text.TextFieldType.DYNAMIC)},DateTextField.prototype.displayDateInParseableFormat=function(){this.text=t.i18n.locale.DateTimeLocale.formatDateTime(DateTextField.PARSEABLE_FORMAT,this.date,!0)},DateTextField.prototype.displayDateInLocalizedFormat=function(){e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale())?this.text=t.i18n.locale.DateTimeLocale.standardFormatDateTime(t.i18n.locale.DateTimeFormats.LONG_DATE_FORMAT,this.date,!0):this.text=t.i18n.locale.DateTimeLocale.formatDateTime(DateTextField.LOCALIZED_FORMAT,this.date,!0)},DateTextField.prototype.parseUtcDate=function(){this.parsedDate=null;var t=this.text.match(DateTextField.datePattern);if(!t)return!1;var e=DateTextField.stringToNumberOrOne(t[1]);if(e<1900)return!1;var i=DateTextField.stringToNumberOrOne(t[2]);if(i<1||i>12)return!1;var n=DateTextField.stringToNumberOrOne(t[3]);return!(n<1||n>31)&&(this.parsedDate=DateTextField.newDateInUtc(e,i,n),!0)},DateTextField.datePattern=/^ *(\d{4})( *[./-] *\d{1,2})?( *[./-] *\d{1,2})? *$/,DateTextField.PARSEABLE_FORMAT="yyyy-MM-dd",DateTextField.LOCALIZED_FORMAT="MMM dd, yyyy",DateTextField}(flash.text.TextField);e.DateTextField=i}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function DisplayManager(t){var i=e.call(this)||this;return i.mainManager=t,i.firstResize=!0,i.viewpoints=[],t&&(i.layersManager=t.layersManager),i}return __extends(DisplayManager,e),DisplayManager.prototype.computeRelativeTimesForPointsInIntervals=function(e){for(var i=e.data.getPointsInIntervals(),n=e.data.units,a={},r=0,o=Object.keys(i);r<o.length;r++){var s=o[r],l=Number(s),h=i[l];l===t.Const.FIVE_MINUTE_INTERVAL&&h[h.length-1].dayMinute%2==1&&h.splice(h.length-1,1),a[l]=h.length-1}for(var c=n.length-1;c>=0;c--)for(var u=0,d=Object.keys(i);u<d.length;u++){var g=d[u],p=Number(g),v=i[p];for(a[p]>=0&&v[a[p]].time===n[c].time&&(v[a[p]].relativeMinutes=n[c].relativeMinutes,a[p]--);a[p]>=0&&(v[a[p]].time>n[c].time||0===c);){var y=notnull(e.data.getSessionForMinute(v[a[p]].dayMinute)),f=y.end-v[a[p]].dayMinute;f<Number(p)/t.Const.SEC_PER_MINUTE?v.length<=a[p]+1?v[a[p]].relativeMinutes=-f:(y=notnull(e.data.getSessionForMinute(v[a[p]+1].dayMinute)),v[a[p]].relativeMinutes=v[a[p]+1].relativeMinutes-(v[a[p]+1].dayMinute-y.start)-1-f,y.start!==e.data.marketOpenMinute&&v[a[p]].relativeMinutes++):v[a[p]].relativeMinutes=v[a[p]+1].relativeMinutes-(v[a[p]+1].dayMinute-v[a[p]].dayMinute),a[p]--}}},DisplayManager.prototype.hasOhlcRequiredIndicator=function(){for(var e=0,i=this.layersManager.config[t.LayersManager.SINGLE].layers;e<i.length;e++){var n=i[e];if(-1!==t.Const.OHLC_DEPENDENT_INDICATOR_NAMES.indexOf(n.name)&&Boolean(n.enabled))return!0}return!1},DisplayManager.prototype.clearWeeklyXPos=function(){if(t.Const.INDICATOR_ENABLED){var e=this.layersManager?this.layersManager.getFirstDataSource():null,i=e?e.data.getPointsInIntervalArray(t.Const.WEEKLY_INTERVAL):null;if(i)for(var n=0,a=i;n<a.length;n++){a[n].weeklyXPos=NaN}}},DisplayManager.prototype.showContextualStaticInfo=function(){for(var t=0,e=this.viewpoints;t<e.length;t++){e[t].clearPointInformation()}var i=this.layersManager.getContextualStaticInfo();this.spaceText.setContextualStaticInfo(i),this.resizeViewPoints(this.stage.stageWidth,this.stage.stageHeight)},DisplayManager.prototype.init=function(e,i){this.mainController=new t.Controller(this.mainManager,this);var n=null;Boolean(t.Const.SHOW_SPARKLINE)?((n=new t.SparklineViewPoint(this.mainManager.dataManager,this)).my_minx=0,n.my_miny=0,n.my_maxx=e,n.my_maxy=t.Const.SPARKLINE_HEIGHT+1,n.name=t.Const.SPARKLINE_VIEW_POINT_NAME,this.addChild(n),this.viewpoints.push(n),n.setController(this.mainController),n.topBorder=t.Const.SPARK_PADDING-1,n.drawBorders()):this.viewpoints.push(null);for(var a=0,r=t.Utils.decodeObjects(t.MainManager.paramsObj.single_viewpoints);a<r.length;a++){var o=r[a];"hidden"!==o.display&&this.addViewPoint("ViewPoint",o.name,this.stage.stageWidth,Number(o.height),Number(o.topMargin),e,i)}this.spaceText=new t.SpaceText(this),this.spaceText.y=0,this.spaceText.x=0,this.addChild(this.spaceText),Boolean(t.Const.SHOW_SPARKLINE)&&(this.topBorderLayer=new t.BorderLayer(this,notnull(n)),this.addChild(this.topBorderLayer)),this.resizeViewPoints(e,i),this.addChild(this.mainController),this.mainController.initEventListeners()},DisplayManager.prototype.positionAfterHoursTimes=function(t,e,i,n,a,r){for(var o=i,s=e;s>=t;s--)a.units[s].relativeMinutes=o,r&&(r[s].relativeMinutes=o),o-=n},DisplayManager.prototype.isIndicatorConfigEnabled=function(e){for(var i=0,n=this.layersManager.config[t.LayersManager.SINGLE].layers;i<n.length;i++){var a=n[i];if(a.name===e)return Boolean(a.enabled)}return!1},DisplayManager.prototype.getLayer=function(t,e,i){var n=this.getViewPoint(e);return n?n.getLayer(t,i):null},DisplayManager.prototype.makeBorderLayerTop=function(){var e=this.getViewPoint(t.Const.SPARKLINE_VIEW_POINT_NAME);e&&(this.addChildAt(e,this.numChildren-1),this.addChildAt(this.topBorderLayer,this.numChildren-1))},DisplayManager.prototype.removeAllLayers=function(t){this.viewpoints[t].removeAllLayers()},DisplayManager.prototype.windowResized=function(e,i){var n=new t.Bounds(0,0,e,t.Const.SPARKLINE_HEIGHT+1),a=this.getSparklineViewPoint();a&&a.setNewSize(n);var r=this.getMainViewPoint().count;if(this.resizeViewPoints(e,i),this.mainController.updateChartSizeChangeButtonPosition(),this.firstResize){if(this.firstResize=!1,!this.layersManager.getFirstDataSource())return;if(this.mainController.currentZoomLevel!==t.ScaleTypes.INVALID)this.mainController.syncZoomLevel();else{for(var o=0,s=this.viewpoints;o<s.length;o++){s[o].setNewCount(r)}this.update()}}},DisplayManager.prototype.updateViewPoint=function(t){this.viewpoints[t].update()},DisplayManager.prototype.extractInterdayPoints=function(t){for(var e=[],i=t.marketCloseMinute,n=0,a=t.units;n<a.length;n++){var r=a[n];r.relativeMinutes=NaN,r.dayMinute===i&&e.push(r)}return e},DisplayManager.prototype.animateToSelectedPin=function(e){if(e){var i=this.layersManager.getFirstDataSource();if(i){var n,a,r=this.getMainViewPoint();if(t.Const.INDICATOR_ENABLED){var o=this.getEnabledChartLayer(),s=r.getDetailLevelForTechnicalStyle(),l=t.Const.getDetailLevelInterval(s);if(n=e.getRelativeMinutes(l),o===t.Const.LINE_CHART)for(;isNaN(n)&&s<t.Intervals.WEEKLY;){if(s++,l=t.Const.getDetailLevelInterval(s),!i.data.hasPointsInIntervalArray(l)){var h=new t.EventCallback(this.animateToSelectedPin,[e]);return void r.checkEvents(s,[h])}n=e.getRelativeMinutes(l)}}else n=e.getRelativeMinutes();if(n>r.getLastMinute())(a=Number(n+r.count/3))>0&&(a=0);else{if(!(n<=r.getFirstMinute()))return;a=Number(n+2*r.count/3);var c=r.getOldestMinute();a<c&&(a=Number(c+r.count))}this.mainController.animateTo(a,r.count,NaN,!0)}}},DisplayManager.prototype.removeLayer=function(t,e,i){this.getViewPoint(e).removeLayer(t,i)},DisplayManager.prototype.enableIndicatorConfig=function(e,i){void 0===i&&(i=!0);for(var n=0,a=this.layersManager.config[t.LayersManager.SINGLE].layers;n<a.length;n++){var r=a[n];r.name===e&&(r.enabled=i?"true":"false")}},DisplayManager.prototype.addLayer=function(t,e,i,n){var a=this.getViewPoint(e);return a?a.addLayer(t,i,n):null},DisplayManager.prototype.getViewPoint=function(t){var e=this.getViewPointPos(t);return-1!==e?this.viewpoints[e]:null},DisplayManager.prototype.getMainViewPoint=function(){var e=this.getViewPointPos(t.Const.MAIN_VIEW_POINT_NAME);if(-1===e)throw new Error;return this.viewpoints[e]},DisplayManager.prototype.getSparklineViewPoint=function(){var e=this.getViewPointPos(t.Const.SPARKLINE_VIEW_POINT_NAME);if(-1===e)throw new Error;return this.viewpoints[e]},DisplayManager.prototype.getComparedDataSeries=function(){var t=[];t.push(this.mainManager.dataManager.dataSources[this.mainManager.quote].data);for(var e=0,i=this.layersManager.getComparedTickers();e<i.length;e++){var n=i[e];t.push(this.mainManager.dataManager.dataSources[n].data)}return t},DisplayManager.prototype.getLayers=function(t){return notnull(this.getViewPoint(t)).getLayers()},DisplayManager.prototype.HTMLnotify=function(e,i){if(void 0===i&&(i=!1),e===t.Const.MAIN_VIEW_POINT_NAME){var n=this.getMainViewPoint(),a=n.getFirstDataUnit(),r=n.getLastDataUnit();if(a&&r){var o=new Date(a.time),s=new Date(r.time);o.getTime()>=s.getTime()&&(o=new Date(s.getTime()-t.Const.MS_PER_DAY));var l=this.layersManager.getFirstDataSource();if(l){var h=this.getNumberOfDaysForCount(n.count,n.lastMinute,l);t.MainManager.jsProxy.HTMLnotify(o,s,h,n.count,i),t.MainManager.jsProxy.setForceDisplayExtendedHours(l)}}}},DisplayManager.prototype.resizeViewPoints=function(e,i){var n,a=new t.Bounds(0,i-t.Const.SPARKLINE_HEIGHT,e,i),r=this.getSparklineViewPoint();for(r&&r.setNewSize(a),i=a.miny-t.Const.SPARK_PADDING,n=this.viewpoints.length-1;n>=2;n--)a=new t.Bounds(t.Const.BORDER_WIDTH,i-(this.viewpoints[n].maxy-this.viewpoints[n].miny),e-t.Const.BORDER_WIDTH,i),this.viewpoints[n].setNewSize(a),i=a.miny-this.viewpoints[n].topMargin;this.spaceText.setSize(e,t.Const.SPACE_HEIGHT+this.viewpoints[n].topMargin),a=new t.Bounds(t.Const.BORDER_WIDTH,t.Const.SPACE_HEIGHT+t.Const.INFO_TEXT_TOP_PADDING+this.viewpoints[n].topMargin,e-t.Const.BORDER_WIDTH,i),this.viewpoints[t.Const.MAIN_VIEW_POINT].setNewSize(a),this.viewpoints[t.Const.MAIN_VIEW_POINT].clearPointInformation(),Boolean(t.Const.SHOW_SPARKLINE)&&this.topBorderLayer.update()},DisplayManager.prototype.removeViewPoint=function(t){var e=this.getViewPointPos(t);if(-1!==e){var i=this.viewpoints[e];i&&(this.mainController.removeControlListener(i),this.removeChild(i),this.viewpoints.splice(e,1))}},DisplayManager.prototype.update=function(t){void 0===t&&(t=!1),this.clearWeeklyXPos();for(var e=0;e<this.viewpoints.length;e++)this.updateViewPoint(e);t?this.mainController.triggerMouseMoveAction():this.showContextualStaticInfo(),this.topBorderLayer.update()},DisplayManager.prototype.addViewPoint=function(e,i,n,a,r,o,s,l){var h=getDefinitionByName("com.google.finance."+e),c=new t.Bounds(t.Const.BORDER_WIDTH,s-a+r,o-t.Const.BORDER_WIDTH,s),u=new h(this);return this.addChild(u),u.name=i,u.topMargin=r,u.setNewSize(c),l&&(u.count=l.count,u.lastMinute=l.lastMinute),this.viewpoints.push(u),u.setController(this.mainController),l&&u.setNewCount(l.count),this.viewpoints.length-1},DisplayManager.prototype.setLastMinute=function(t){for(var e=0,i=this.viewpoints;e<i.length;e++){i[e].lastMinute=t}},DisplayManager.prototype.isDifferentMarketSessionComparison=function(){return this.differentMarketSessionComparison},DisplayManager.prototype.getNumberOfDaysForCount=function(e,i,n){if(this.differentMarketSessionComparison)return e;var a=n.data,r=i-e,o=0,s=n.getEndOfDayDataUnitFor(i),l=t.DataSource.getMinuteMetaIndex(s.relativeMinutes,a.days,a.units);if(s.coveredDays>0){var h=s.relativeMinutes-i;o=Number(o-Math.floor(h/a.marketDayLength))}for(;s.relativeMinutes>r&&l>0&&!(--l<0);){var c=a.units[a.days[l]].relativeMinutes,u=n.getEndOfDayDataUnitFor(c);if(u.relativeMinutes>=r)0===s.coveredDays?o++:o=Number(o+s.coveredDays);else if(s.coveredDays>0){var d=s.relativeMinutes-r;o=Number(o+Math.floor(d/a.marketDayLength))}s=u}return o},DisplayManager.prototype.toggleAllAfterHoursSessions=function(t,e){var i;if(e)i=e;else{var n=this.layersManager.getFirstDataSource();if(!n)return;i=n}var a=i.visibleExtendedHours.length(),r=i.hiddenExtendedHours.length();if(!0===t&&r>0||!1===t&&a>0){var o=i.visibleExtendedHours;i.visibleExtendedHours=i.hiddenExtendedHours,i.hiddenExtendedHours=o}this.computeRelativeTimes(i),i.computeObjectPositions(),this.mainController.syncZoomLevel(!0)},DisplayManager.prototype.getViewPoints=function(){return this.viewpoints},DisplayManager.prototype.getViewPointPos=function(t){for(var e=0;e<this.viewpoints.length;e++)if(this.viewpoints[e].name===t)return e;return-1},DisplayManager.prototype.computeRelativeTimes=function(e){if(!this.differentMarketSessionComparison){e.setRelativeMinutesState(t.DataSource.RELATIVE_MINUTES_READY);var i=e.data;if(0!==i.units.length){var n=e.afterHoursData,a=t.Const.INDICATOR_ENABLED?n.getPointsInIntervalArray(t.Const.INTRADAY_INTERVAL):null;e.firstOpenRelativeMinutes=0;var r=null,o=e.visibleExtendedHours.length()-1;-1!==o&&(r=e.visibleExtendedHours.getIntervalAt(o));for(var s=i.units[i.units.length-1],l=notnull(i.getSessionForMinute(s.dayMinute)),h=e.intradayMinutesInterval,c=0,u=i.units.length-1;u>0;u--){var d=i.units[u];if(d.relativeMinutes=c,d.time>=t.Const.YEAR_2000&&c<e.firstOpenRelativeMinutes&&(e.firstOpenRelativeMinutes=c),d.coveredDays>0){if(u>0){var g=d.time-i.units[u-1].time,p=Math.floor(g/(1e3*t.Const.DAILY_INTERVAL));d.coveredDays>p&&(d.coveredDays=p)}0===d.coveredDays?c-=h:c-=(i.marketDayLength+1)*d.coveredDays}else if(d.dayMinute===l.end&&i.minuteIsEndOfDataSession(i.units[u-1].dayMinute))c-=i.marketDayLength+1;else{var v=d.dayMinute-l.start;if(v>=0&&v<h){c-=v+(l.start===i.marketOpenMinute?1:0);var y=i.units[u-1].dayMinute;isNaN(y)||(l=notnull(i.getSessionForMinute(y)))}else if(d.dayMinute===l.end&&r){for(var f=r.start,T=r.end,I=Number(n.units[f].time);d.time<=I;){var L=n.units[T].dayMinute-n.units[f].dayMinute;d.relativeMinutes-=L+1,this.positionAfterHoursTimes(f,T,c,h,n,a),c-=L+1,o--,(r=e.visibleExtendedHours.getIntervalAt(o))?(f=r.start,T=r.end,I=Number(n.units[f].time)):I=-1}c-=h}else c-=h}}i.units[0].relativeMinutes=c,i.units[0].time>=t.Const.YEAR_2000&&c<e.firstOpenRelativeMinutes&&(e.firstOpenRelativeMinutes=c),t.Const.INDICATOR_ENABLED&&this.computeRelativeTimesForPointsInIntervals(e)}}},DisplayManager.prototype.enableIndicatorLayer=function(e,i,n){void 0===n&&(n=!0);var a=this.getViewPoint(i);if(a){for(var r=0,o=a.getLayers();r<o.length;r++){var s=o[r];s instanceof t.indicator.IndicatorLayer&&e===s.getIndicatorName()&&s.setEnabled(n)}this.update()}},DisplayManager.prototype.setDifferentMarketSessionComparison=function(t){this.differentMarketSessionComparison=t},DisplayManager.prototype.setAfterHoursDisplay=function(e,i){var n;if(i)n=i;else if(!(n=this.layersManager.getFirstDataSource()))return;var a=n.visibleExtendedHours.length(),r=n.hiddenExtendedHours.length();if(!0===e&&a+r===0){var o=t.EventFactory.getEvent(t.ChartDetailTypes.GET_AH_DATA,n.quoteName,t.ChartEventPriorities.OPTIONAL);this.mainManager.dataManager.expectEvent(o),this.mainManager.dataManager.eventHandler(o)}else{var s=this.getDetailLevel(),l=t.Const.INDICATOR_ENABLED?this.getEnabledChartLayer():"";if((s===t.Intervals.INTRADAY||l===t.Const.LINE_CHART&&s<t.Intervals.DAILY)&&this.layersManager.getStyle()===t.LayersManager.SINGLE)if(this.toggleAllAfterHoursSessions(e,n),l===t.Const.CANDLE_STICK||l===t.Const.OHLC_CHART){var h=n.data.marketDayLength+1;this.mainController.jumpTo(0,h*t.Const.INTERVAL_PERIODS[s].days)}else this.mainController.syncZoomLevel()}},DisplayManager.prototype.setDiffMarketSessionRelativeMinutesState=function(){this.mainManager.dataManager.dataSources[this.mainManager.quote].setRelativeMinutesState(t.DataSource.DMS_RELATIVE_MINUTES_READY);for(var e=0,i=this.layersManager.getComparedTickers();e<i.length;e++){var n=i[e];this.mainManager.dataManager.dataSources[n].setRelativeMinutesState(t.DataSource.DMS_RELATIVE_MINUTES_READY)}},DisplayManager.prototype.setEnabledChartLayer=function(e){for(var i=this.getMainViewPoint().getLayers(),n=this.layersManager?this.layersManager.getFirstDataSource():null,a=0,r=i;a<r.length;a++){var o=r[a];o instanceof t.IntervalBasedChartManagerLayer&&(Boolean(t.MainManager.paramsObj.displayExtendedHours)&&(!n||n.visibleExtendedHours.length()>0)&&e!==t.Const.LINE_CHART&&o.getEnabledLayerName()===t.Const.LINE_CHART&&this.setAfterHoursDisplay(!1),o.setEnabledLayer(e),Boolean(t.MainManager.paramsObj.displayExtendedHours)&&(n&&0!==n.visibleExtendedHours.length()||-1===t.Const.CHART_STYLE_NAMES.indexOf(e)||this.setAfterHoursDisplay(!0)))}this.update()},DisplayManager.prototype.computeRelativeTimesForDiffSessionComparison=function(){this.setDiffMarketSessionRelativeMinutesState();for(var e=[],i=this.getComparedDataSeries(),n=0,a=i;n<a.length;n++)for(var r=a[n],o=0,s=this.extractInterdayPoints(r);o<s.length;o++){var l=s[o];e.push(l)}if(0!==e.length){e.sort(t.Utils.compareDataUnits);for(var h=0,c=e[e.length-1],u=new Date(c.exchangeDateInUTC.fullYearUTC,c.exchangeDateInUTC.monthUTC,c.exchangeDateInUTC.dateUTC),d=e.length-1;d>=0;d--){var g=e[d],p=g.exchangeDateInUTC;if(p.dateUTC!==u.date||p.monthUTC!==u.month||p.fullYearUTC!==u.fullYear){var v=new Date(p.fullYearUTC,p.monthUTC,p.dateUTC),y=this.mainManager?this.mainManager.weekdayBitmap:t.Const.DEFAULT_WEEKDAY_BITMAP;h-=t.Utils.getWeekdaysDifference(v,u,y),u=v}g.relativeMinutes=h}for(var f=0,T=i;f<T.length;f++){var I=(r=T[f]).units;if(0!==I.length){for(var L=0;L<I.length&&isNaN(I[L].relativeMinutes);)L++;if(L!==I.length){h=I[L].relativeMinutes;for(d=L+1;d<I.length;d++)isNaN(I[d].relativeMinutes)?I[d].relativeMinutes=h:h=I[d].relativeMinutes}}}}},DisplayManager.prototype.setIndicatorInstanceArray=function(e,i){for(var n=0,a=this.getMainViewPoint().getLayers();n<a.length;n++){(d=a[n])instanceof t.indicator.DependentIndicatorLayer&&e===d.getIndicatorName()&&d.setIndicatorInstanceArray(i)}var r=this.getViewPoint(t.Const.BOTTOM_VIEW_POINT_NAME);if(r)for(var o=0,s=r.getLayers();o<s.length;o++){var l=s[o];l instanceof t.indicator.VolumeDependentIndicatorLayer&&e===l.getIndicatorName()&&l.setIndicatorInstanceArray(i)}for(var h=this.getViewPoint(e),c=0,u=h?h.getLayers():[];c<u.length;c++){var d;(d=u[c])instanceof t.indicator.IndependentIndicatorLayer&&e===d.getIndicatorName()&&d.setIndicatorInstanceArray(i)}this.update()},DisplayManager.prototype.getDetailLevel=function(){var e=this.getMainViewPoint(),i=t.Const.INDICATOR_ENABLED?e.getDetailLevelForTechnicalStyle():e.getDetailLevel();if(i===t.Intervals.INVALID){var n=t.Const.getZoomLevel(t.Const.MARKET_DAY_LENGTH*t.Const.getDefaultDisplayDays(),t.Const.MARKET_DAY_LENGTH);return n<=t.ScaleTypes.SCALE_1Y?t.Intervals.WEEKLY:n<=t.ScaleTypes.SCALE_1M?t.Intervals.DAILY:t.Intervals.INTRADAY}return i},DisplayManager.prototype.getEnabledChartLayer=function(){for(var e=0,i=this.getMainViewPoint().getLayers();e<i.length;e++){var n=i[e];if(n instanceof t.IntervalBasedChartManagerLayer)return n.getEnabledLayerName()}var a=t.IntervalBasedChartManagerLayer.getEnabledChartLayerName();return a||t.Const.DEFAULT_CHART_STYLE_NAME},DisplayManager}(flash.display.Sprite);t.DisplayManager=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function StockAssociatedObject(t,i,n,a,r,o,s){var l=e.call(this,null,t,i)||this;return l.posInInterval=n,l.time=a,l.exchangeDateInUTC=r,l.id=o,l.qname=s,l.active=!1,l}return __extends(StockAssociatedObject,e),StockAssociatedObject.compare=function(e,i){var n=e.time,a=i.time;if(n<a)return-1;if(n>a)return 1;if(e instanceof t.PinPoint&&i instanceof t.PinPoint){if(e.letter<i.letter)return-1;if(e.letter>i.letter)return 1}return 0},StockAssociatedObject.prototype.toString=function(){return this.id+" "+this.pos},StockAssociatedObject.prototype.getRelativeMinutes=function(t){if(void 0===t&&(t=-1),!this.posInInterval)return notnull(this.refDataSeries).units[this.pos].relativeMinutes;if(!this.posInInterval[t])return NaN;var e=this.posInInterval[t].refDataSeries,i=this.posInInterval[t].position;return notnull(e).getPointsInIntervalArray(t)[i].relativeMinutes},StockAssociatedObject}(t.SeriesPosition);t.StockAssociatedObject=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function Dividend(e,i,n,a,r,o,s,l,h,c){var u=t.call(this,e,i,n,a,r,o,s)||this;return u.amount=l,u.currency=h,u.yield=l/c,u}return __extends(Dividend,t),Dividend}(t.StockAssociatedObject);t.Dividend=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function SplitMovie_SplitArrowClass(){return null!==t&&t.apply(this,arguments)||this}return __extends(SplitMovie_SplitArrowClass,t),SplitMovie_SplitArrowClass}(flash.display.Bitmap);t.SplitMovie_SplitArrowClass=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function SplitMovie_SplitArrowSidewaysClass(){return null!==t&&t.apply(this,arguments)||this}return __extends(SplitMovie_SplitArrowSidewaysClass,t),SplitMovie_SplitArrowSidewaysClass}(flash.display.Bitmap);t.SplitMovie_SplitArrowSidewaysClass=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function SplitMovie_SplitArrowSidewaysOverClass(){return null!==t&&t.apply(this,arguments)||this}return __extends(SplitMovie_SplitArrowSidewaysOverClass,t),SplitMovie_SplitArrowSidewaysOverClass}(flash.display.Bitmap);t.SplitMovie_SplitArrowSidewaysOverClass=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function SplitMovie_SplitArrowOnOverClass(){return null!==t&&t.apply(this,arguments)||this}return __extends(SplitMovie_SplitArrowOnOverClass,t),SplitMovie_SplitArrowOnOverClass}(flash.display.Bitmap);t.SplitMovie_SplitArrowOnOverClass=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(e){var i=function(i){function SplitMovie(){var t=i.call(this)||this;return t.textFormat=new flash.text.TextFormat("Verdana",9,t.getTextColor(),!0,!1,!1),t.arrowOrientation=e.Orientations.DOWN,t.detailsTextField=new flash.text.TextField,t.detailsTextFormat=new flash.text.TextFormat("Arial",11,0,!1,!1,!1),t.initArrows(),t.createButtons(),t.currentVisibleButton=t.attachRegularArrow(),t.regularButton.x=-t.regularButton.width/2,t.detailsTextField.defaultTextFormat=t.detailsTextFormat,t.detailsTextField.autoSize=flash.text.TextFieldAutoSize.LEFT,t.text=t.initTextField(),t.addChild(t.text),t.attachArrowListeners(),t.highlightCanvas=t,t}return __extends(SplitMovie,i),SplitMovie.prototype.getTextColor=function(){return 2210891},SplitMovie.prototype.showDetails=function(){this.hideText(),this.highlightCanvas.addChild(this.detailsTextField),this.detailsTextField.x=this.x+this.currentVisibleButton.x,this.detailsTextField.y=this.y-this.currentVisibleButton.height,this.detailsTextField.text=this.getDetailedText(),this.detailsTextField.appendText("\n"+this.getDateText()),-1===this.currentVisibleButton.scaleY?this.detailsTextField.y=this.y+this.currentVisibleButton.height-this.detailsTextField.height:this.detailsTextField.y=this.y-this.currentVisibleButton.height-this.detailsTextField.height;var t=this.detailsTextField.x-2,e=this.detailsTextField.y-2,i=this.detailsTextField.x+this.detailsTextField.width+2,n=this.detailsTextField.y+this.detailsTextField.height+2,a=-2,r=this.supportingLayer.viewPoint.minx,o=this.supportingLayer.viewPoint.maxx;t<r?a=Number(r-t-2):i>o&&(a=Number(o-i-2)),this.detailsTextField.x+=a;var s=this.highlightCanvas.graphics;s.lineStyle(0,this.textColor,1),s.beginFill(16777215,1),s.drawRect(t+a,e,i-t,n-e),s.endFill()},SplitMovie.prototype.getShortText=function(t){return void 0===t&&(t=!1),this.associatedSplit.newShares+":"+this.associatedSplit.oldShares},SplitMovie.prototype.setOrientation=function(t){if(this.checkArrowChange(t),this.currentVisibleButton)switch(t){case e.Orientations.UP:case e.Orientations.SIDEWAYS_UP:this.currentVisibleButton.scaleY=-1,this.text.y=this.arrow.height-3;break;case e.Orientations.DOWN:case e.Orientations.SIDEWAYS_DOWN:this.currentVisibleButton.scaleY=1,this.currentVisibleButton.y=-this.arrow.height,this.text.y=2-this.arrow.height-this.text.height}this.arrowOrientation=t},SplitMovie.prototype.getDateText=function(){var i=this.associatedSplit.exchangeDateInUTC;return e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale())?t.i18n.locale.DateTimeLocale.standardFormatDateTime(t.i18n.locale.DateTimeFormats.LONG_DATE_FORMAT,i,!0):t.i18n.locale.DateTimeLocale.standardFormatDateTime(t.i18n.locale.DateTimeFormats.MEDIUM_DATE_FORMAT,i,!0)},SplitMovie.prototype.hideDetails=function(){this.showText();try{this.highlightCanvas.removeChild(this.detailsTextField)}catch(t){}this.highlightCanvas.graphics.clear()},SplitMovie.prototype.setSupportingLayer=function(t){this.supportingLayer=t},SplitMovie.prototype.initTextField=function(){var t=new flash.text.TextField;return t.autoSize=flash.text.TextFieldAutoSize.CENTER,t.x=0,t.selectable=!1,t.cacheAsBitmap=!1,t.defaultTextFormat=this.textFormat,t},SplitMovie.prototype.positionRegularArrow=function(){this.currentVisibleButton.x=-this.currentVisibleButton.width/2,this.text.x=-this.text.width/2},SplitMovie.prototype.hideText=function(){try{return void this.removeChild(this.text)}catch(t){return}},SplitMovie.prototype.attachRegularArrow=function(){return this.currentVisibleButton&&this.removeChild(this.currentVisibleButton),this.addChild(this.regularButton),this.regularButton},SplitMovie.prototype.initArrows=function(){this.arrow=new SplitMovie.SplitArrowClass,this.arrowOnOver=new SplitMovie.SplitArrowOnOverClass,this.arrowSideways=new SplitMovie.SplitArrowSidewaysClass,this.arrowSidewaysOver=new SplitMovie.SplitArrowSidewaysOverClass},SplitMovie.prototype.setObject=function(t){this.associatedSplit=t,this.showText()},SplitMovie.prototype.attachSidewaysArrow=function(){return this.currentVisibleButton&&this.removeChild(this.currentVisibleButton),this.addChild(this.sidewaysButton),this.sidewaysButton},SplitMovie.prototype.showText=function(t){this.persistentHide||(this.addChild(this.text),t=t||this.getShortText(),this.text.text!==t&&(this.text.text=t))},SplitMovie.prototype.attachArrowListeners=function(){var t=this;this.currentVisibleButton.addEventListener(MouseEvents.MOUSE_OVER,function(i){e.MainManager.mouseCursor.setCursor(e.MouseCursors.CLASSIC),e.MainManager.mouseCursor.lockOnDisplayObject(t.currentVisibleButton),t.showDetails()}),this.currentVisibleButton.addEventListener(MouseEvents.MOUSE_OUT,function(i){e.MainManager.mouseCursor.unlock(),t.hideDetails()})},SplitMovie.prototype.createButtons=function(){this.regularButton=new flash.display.SimpleButton("regularButton"),this.regularButton.overState=this.arrowOnOver,this.regularButton.downState=this.arrowOnOver,this.regularButton.hitTestState=this.arrow,this.regularButton.upState=this.arrow,this.arrowOnOver.y=this.arrow.y+this.arrow.height-this.arrowOnOver.height,this.arrowOnOver.x=this.arrow.x,this.sidewaysButton=new flash.display.SimpleButton("sidewaysButton"),this.sidewaysButton.overState=this.arrowSidewaysOver,this.sidewaysButton.downState=this.arrowSidewaysOver,this.sidewaysButton.hitTestState=this.arrowSideways,this.sidewaysButton.upState=this.arrowSideways,this.arrowSidewaysOver.y=this.arrowSideways.y+this.arrowSideways.height-this.arrowSidewaysOver.height,this.arrowSidewaysOver.x=this.arrowSideways.x},SplitMovie.prototype.setHighlightCanvas=function(t){this.highlightCanvas=t},SplitMovie.prototype.checkArrowChange=function(t){this.arrowOrientation!==e.Orientations.UP&&this.arrowOrientation!==e.Orientations.DOWN||t!==e.Orientations.SIDEWAYS_UP&&t!==e.Orientations.SIDEWAYS_DOWN||(this.currentVisibleButton=this.attachSidewaysArrow(),this.positionSidewaysArrow()),this.arrowOrientation!==e.Orientations.SIDEWAYS_UP&&this.arrowOrientation!==e.Orientations.SIDEWAYS_DOWN||t!==e.Orientations.UP&&t!==e.Orientations.DOWN||(this.currentVisibleButton=this.attachRegularArrow(),this.positionRegularArrow()),this.attachArrowListeners()},SplitMovie.prototype.positionSidewaysArrow=function(){this.currentVisibleButton.x=1-this.currentVisibleButton.width,this.text.autoSize=flash.text.TextFieldAutoSize.LEFT,this.text.x=1-this.text.width},SplitMovie.prototype.getDetailedText=function(){return e.Message.getMsg(e.Messages.SPLIT_TEXT,this.getShortText())},SplitMovie.prototype.setPersistentHide=function(t){this.persistentHide=t},SplitMovie.SplitArrowClass=e.SplitMovie_SplitArrowClass,SplitMovie.SplitArrowSidewaysClass=e.SplitMovie_SplitArrowSidewaysClass,SplitMovie.SplitArrowSidewaysOverClass=e.SplitMovie_SplitArrowSidewaysOverClass,SplitMovie.SplitArrowOnOverClass=e.SplitMovie_SplitArrowOnOverClass,SplitMovie}(flash.display.Sprite);e.SplitMovie=i}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function DividendMovie_DividendArrowClass(){return null!==t&&t.apply(this,arguments)||this}return __extends(DividendMovie_DividendArrowClass,t),DividendMovie_DividendArrowClass}(flash.display.Bitmap);t.DividendMovie_DividendArrowClass=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function DividendMovie_DividendArrowOnOverClass(){return null!==t&&t.apply(this,arguments)||this}return __extends(DividendMovie_DividendArrowOnOverClass,t),DividendMovie_DividendArrowOnOverClass}(flash.display.Bitmap);t.DividendMovie_DividendArrowOnOverClass=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function DividendMovie_DividendArrowSidewaysClass(){return null!==t&&t.apply(this,arguments)||this}return __extends(DividendMovie_DividendArrowSidewaysClass,t),DividendMovie_DividendArrowSidewaysClass}(flash.display.Bitmap);t.DividendMovie_DividendArrowSidewaysClass=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function DividendMovie_DividendArrowSidewaysOverClass(){return null!==t&&t.apply(this,arguments)||this}return __extends(DividendMovie_DividendArrowSidewaysOverClass,t),DividendMovie_DividendArrowSidewaysOverClass}(flash.display.Bitmap);t.DividendMovie_DividendArrowSidewaysOverClass=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(e){var i=function(i){function DividendMovie(){return null!==i&&i.apply(this,arguments)||this}return __extends(DividendMovie,i),DividendMovie.prototype.getTextColor=function(){return 26333},DividendMovie.prototype.initArrows=function(){this.arrow=new DividendMovie.dividendArrowClass,this.arrowOnOver=new DividendMovie.dividendArrowOnOverClass,this.arrowSideways=new DividendMovie.dividendArrowSidewaysClass,this.arrowSidewaysOver=new DividendMovie.dividendArrowSidewaysOverClass},DividendMovie.prototype.getDetailedText=function(){if(e.MainManager.paramsObj.companyCurrency&&this.associatedDividend.currency&&e.MainManager.paramsObj.differentDividendCurrency)return e.Message.getMsg(e.Messages.DIVIDEND_TEXT_NO_PERCENT,this.getShortText(!0));var t=Math.floor(1e4*this.associatedDividend.yield)/100+"%";return e.Message.getMsg(e.Messages.DIVIDEND_TEXT,this.getShortText(!0),t)},DividendMovie.prototype.setObject=function(t){this.associatedDividend=t,this.showText()},DividendMovie.prototype.positionSidewaysArrow=function(){this.currentVisibleButton.x=-1,this.text.autoSize=flash.text.TextFieldAutoSize.RIGHT,this.text.x=0},DividendMovie.prototype.getDateText=function(){var i=this.associatedDividend.exchangeDateInUTC;return e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale())?t.i18n.locale.DateTimeLocale.standardFormatDateTime(t.i18n.locale.DateTimeFormats.LONG_DATE_FORMAT,i,!0):t.i18n.locale.DateTimeLocale.standardFormatDateTime(t.i18n.locale.DateTimeFormats.MEDIUM_DATE_FORMAT,i,!0)},DividendMovie.prototype.getShortText=function(t){void 0===t&&(t=!1);var i=!1,n=this.associatedDividend.amount;if(!Boolean(e.Const.DISPLAY_DIVIDENDS_UNITS)){i=!e.MainManager.paramsObj.companyCurrency||!this.associatedDividend.currency||e.MainManager.paramsObj.differentDividendCurrency;var a=this.associatedDividend.currency&&i?this.associatedDividend.currency:"";if(!t){for(var r=100;r<1e4;r*=10){var o=Math.round(n*r)/r;if(0!==o)return a+o}return a+"0"}return a+n.toString()}if(n<1){var s=100*n;return t||(s=0===Math.round(s)?Math.round(10*s)/10:Math.round(s)),s+String.fromCharCode(162)}var l=n;return t||(l=Math.round(100*l)/100),"$"+l},DividendMovie.dividendArrowClass=e.DividendMovie_DividendArrowClass,DividendMovie.dividendArrowOnOverClass=e.DividendMovie_DividendArrowOnOverClass,DividendMovie.dividendArrowSidewaysClass=e.DividendMovie_DividendArrowSidewaysClass,DividendMovie.dividendArrowSidewaysOverClass=e.DividendMovie_DividendArrowSidewaysOverClass,DividendMovie}(e.SplitMovie);e.DividendMovie=i}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function DraggableHandle(e,i){var n=t.call(this)||this;return n.button=new flash.display.SimpleButton,n.button.overState=n.button.downState=new i,n.button.hitTestState=n.button.upState=new e,n.button.useHandCursor=!1,n.addChild(n.button),n}return __extends(DraggableHandle,t),DraggableHandle}(flash.display.Sprite);t.DraggableHandle=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){function EventFactory(){}return EventFactory.buildEvent=function(e,i,n,a,r,o){void 0===o&&(o=null);var s=new t.ChartEvent(e);return s.detailType=o,s.quote=i,s.period=n,s.interval=""+a,s.columns=r,s},EventFactory.getEvent=function(e,i,n){var a;if(t.Const.INDICATOR_ENABLED){var r=t.MainManager.paramsObj&&t.MainManager.paramsObj.delayedMinutes>=0?t.MainManager.paramsObj.delayedMinutes:0;switch(e){default:case t.ChartDetailTypes.GET_1Y_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_DATA,i,"1Y",t.Const.DAILY_INTERVAL,"d,c,v,o,h,l",e);break;case t.ChartDetailTypes.GET_5Y_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_DATA,i,"5Y",t.Const.WEEKLY_INTERVAL,"d,c,v,k,o,h,l",e);break;case t.ChartDetailTypes.GET_2Y_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_DATA,i,"2Y",t.Const.DAILY_INTERVAL,"d,c,v",e);break;case t.ChartDetailTypes.GET_5D_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_DATA,i,"5d",t.Const.INTRADAY_INTERVAL,"d,c,v,o,h,l",e);break;case t.ChartDetailTypes.GET_AH_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_AH_DATA,i,"5d",t.Const.INTRADAY_INTERVAL,"d,c,v,o,h,l",e);break;case t.ChartDetailTypes.MUTF_5D_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_MUTF_DATA,i,"5d",t.Const.DAILY_INTERVAL,"d,c,v",e);break;case t.ChartDetailTypes.GET_40Y_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_DATA,i,"40Y",t.Const.WEEKLY_INTERVAL,"d,c,v,k,o,h,l",e);break;case t.ChartDetailTypes.GET_10D_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_DATA,i,"10d",t.Const.FIVE_MINUTE_INTERVAL,"d,c,v,o,h,l",e);break;case t.ChartDetailTypes.GET_30D_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_DATA,i,"30d",t.Const.HALF_HOUR_INTERVAL,"d,c,v,o,h,l",e);break;case t.ChartDetailTypes.GET_RT_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_RT_DATA,i,r+10+"m",t.Const.INTRADAY_INTERVAL,"d,c,v,o,h,l",e);break;case t.ChartDetailTypes.GET_RT_AH_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_RT_AH_DATA,i,r+10+"m",t.Const.INTRADAY_INTERVAL,"d,c,v,o,h,l",e)}}else switch(e){default:case t.ChartDetailTypes.GET_1Y_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_DATA,i,"1Y",t.Const.DAILY_INTERVAL,"d,c,v");break;case t.ChartDetailTypes.GET_5Y_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_DATA,i,"5Y",t.Const.WEEKLY_INTERVAL,"d,c,v,k");break;case t.ChartDetailTypes.GET_2Y_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_DATA,i,"2Y",t.Const.DAILY_INTERVAL,"d,c,v");break;case t.ChartDetailTypes.GET_5D_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_DATA,i,"5d",t.Const.INTRADAY_INTERVAL,"d,c,v");break;case t.ChartDetailTypes.GET_AH_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_AH_DATA,i,"5d",t.Const.INTRADAY_INTERVAL,"d,c,v");break;case t.ChartDetailTypes.MUTF_5D_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_MUTF_DATA,i,"5d",t.Const.DAILY_INTERVAL,"d,c,v");break;case t.ChartDetailTypes.GET_40Y_DATA:a=EventFactory.buildEvent(t.ChartEventTypes.GET_DATA,i,"40Y",t.Const.WEEKLY_INTERVAL,"d,c,v,k")}return a.priority=n,a},EventFactory}();t.EventFactory=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){function GVizFormatConverter(){}return GVizFormatConverter.validateGVizData=function(t){var e=t?t[GVizFormatConverter.COLS_PROPERTY_NAME]:null;if(!e||0===e.length)return!1;if(e[0][GVizFormatConverter.TYPE_PROPERTY_NAME]!==GVizFormatConverter.DATETIME_TYPE)return!1;for(var i=1;i<e.length;i++)if(e[i][GVizFormatConverter.TYPE_PROPERTY_NAME]!==GVizFormatConverter.NUMBER_TYPE)return!1;return!0},GVizFormatConverter.convertGVizData=function(e,i,n,a){if(GVizFormatConverter.validateGVizData(e)){var r=n.getPointsInIntervalArray(i);if(r&&0!==r.length){for(var o=e[GVizFormatConverter.ROWS_PROPERTY_NAME],s=[],l=1;l<e[GVizFormatConverter.COLS_PROPERTY_NAME].length;l++)s.push(new t.DataSeries);for(var h=0,c=o;h<c.length;h++)for(var u=c[h],d=u[GVizFormatConverter.COL_PROPERTY_NAME][0][GVizFormatConverter.VALUE_PROPERTY_NAME],g=Date.parse(d.toString()),p=r[n.getTimestampIndex(g,r)],v=1;v<u[GVizFormatConverter.COL_PROPERTY_NAME].length;v++){var y=u[GVizFormatConverter.COL_PROPERTY_NAME][v][GVizFormatConverter.VALUE_PROPERTY_NAME];s[v-1].points.push(new t.indicator.IndicatorPoint(y,p))}a.clear(i);for(var f=0;f<s.length;f++)a.setDataSeries(i,s[f],f)}}},GVizFormatConverter.VALUE_PROPERTY_NAME="v",GVizFormatConverter.COLS_PROPERTY_NAME="cols",GVizFormatConverter.ROWS_PROPERTY_NAME="rows",GVizFormatConverter.TYPE_PROPERTY_NAME="type",GVizFormatConverter.COL_PROPERTY_NAME="c",GVizFormatConverter.NUMBER_TYPE="number",GVizFormatConverter.DATETIME_TYPE="datetime",GVizFormatConverter}();t.GVizFormatConverter=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){return function Position(){}}();t.Position=e;var i=function(i){function IndependentObjectsLayer(t,e){var n=i.call(this,t,e)||this;return n.movies=[],n.highlightCanvas=new flash.display.Sprite("highlightCanvas"),n.activeMovies=0,n.positioning=IndependentObjectsLayer.POSITION_CHART,t.addChildToTopCanvas(n.highlightCanvas),n}return __extends(IndependentObjectsLayer,i),IndependentObjectsLayer.prototype.resetCanvas=function(){for(var t=0,e=this.movies;t<e.length;t++){var i=e[t];this.removeChild(i)}this.movies.splice(0)},IndependentObjectsLayer.prototype.getYPos=function(t,e){var i=this.viewPoint;return i.miny+i.V_OFFSET+i.medPriceY-(e.close-t.medPrice)*i.maxPriceRangeViewSize/t.maxPriceRange},IndependentObjectsLayer.prototype.renderLayer=function(e){if(!isNaN(e.lastMinute)&&!isNaN(e.count)&&0!==e.count){var i=this.dataSource.objects[this.renderObj];if(i&&0!==i.length){var n=this.dataSource.data.units,a=this.viewPoint.getDetailLevel();this.activeMovies=0;var r=this.getFirstVisibleObject(i,n,e);if(-1!==r){var o=this.getLastVisibleObject(i,n,e),s=this.viewPoint.count/this.dataSource.data.marketDayLength;e[this.renderObj]=[];for(var l=0,h=r;h<=o;h++){var c=this.getPosition(i[h],n,a,e),u=this.putObject(i[h],c);if(s>IndependentObjectsLayer.HIDE_TEXT_THRESHOLD?(u.hideText(),u.setPersistentHide(!0)):u.setPersistentHide(!1),e[this.renderObj].push(u),this.avoidObj&&e[this.avoidObj]){for(;l<e[this.avoidObj].length-1&&e[this.avoidObj][l].x<u.x;)l++;if(l<e[this.avoidObj].length){var d=e[this.avoidObj][l];d.x===u.x&&(d.setOrientation(t.Orientations.SIDEWAYS+c.orientation),u.setOrientation(t.Orientations.SIDEWAYS+c.orientation))}}}for(var g=this.activeMovies;g<this.movies.length;g++)this.removeChild(this.movies[g]);this.movies.splice(this.activeMovies)}else this.resetCanvas()}else this.resetCanvas()}},IndependentObjectsLayer.prototype.getPosition=function(i,n,a,r){var o=new e,s=notnull(i.refDataSeries),l=this.viewPoint.getXPos(s.units[i.pos]),h=this.getYPos(r,s.units[i.pos]);if(this.positioning===IndependentObjectsLayer.POSITION_CHART)h>this.viewPoint.miny+40?(o.y=h-IndependentObjectsLayer.OBJECT_DISTANCE,o.orientation=t.Orientations.DOWN):(o.y=h+IndependentObjectsLayer.OBJECT_DISTANCE,o.orientation=t.Orientations.UP);else if(this.positioning===IndependentObjectsLayer.POSITION_BOTTOM){var c=this.viewPoint.getLayer("BottomBarLayer"),u=0;c&&(u=Number(c.bottomTextHeight)),o.y=this.viewPoint.maxy-u,o.orientation=t.Orientations.DOWN}return o.x=l,o},IndependentObjectsLayer.prototype.getLastVisibleObject=function(t,e,i){for(var n=i.lastMinute,a=t.length-1;a>=0;a--){var r=t[a];if(notnull(r.refDataSeries).units[r.pos].relativeMinutes<n)return a}return-1},IndependentObjectsLayer.prototype.putObject=function(e,i){var n;if(this.activeMovies>=this.movies.length){var a=void 0;switch(this.renderObj){case"split":a=t.SplitMovie;break;case"dividend":a=t.DividendMovie;break;case"stock_dividend":a=t.StockDividendMovie;break;default:throw new Error}n=new a,this.addChild(n)}else n=this.movies[this.activeMovies];if(n.x=i.x,n.y=i.y,n.setObject(e),e.originalObject._orientation)switch(e.originalObject._orientation){case"down":i.orientation=t.Orientations.DOWN;break;case"up":i.orientation=t.Orientations.UP}return n.setOrientation(i.orientation),n.setSupportingLayer(this),n.setHighlightCanvas(this.highlightCanvas),this.activeMovies>=this.movies.length&&this.movies.push(n),this.activeMovies++,n},IndependentObjectsLayer.prototype.getFirstVisibleObject=function(t,e,i){for(var n=i.lastMinute-i.count,a=0;a<t.length;a++){var r=t[a];if(notnull(r.refDataSeries).units[r.pos].relativeMinutes>n&&r.pos>0)return a}return-1},IndependentObjectsLayer.POSITION_BOTTOM="bottom",IndependentObjectsLayer.HIDE_TEXT_THRESHOLD=1500,IndependentObjectsLayer.POSITION_CHART="chart",IndependentObjectsLayer.TOP_DEPTH=16e3,IndependentObjectsLayer.MIN_PADDING=20,IndependentObjectsLayer.OBJECT_DISTANCE=6,IndependentObjectsLayer}(t.AbstractLayer);t.IndependentObjectsLayer=i}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){function Indicator(){this.hash={},this.intervals=[],this.clearAllOnAddData=!1}return Indicator.prototype.getDataSeriesArray=function(t){return this.hash["series"+t]},Indicator.prototype.setDataSeries=function(t,e,i){void 0===i&&(i=0),this.hasInterval(t)||(this.intervals.push(t),this.intervals.sort()),void 0===this.hash["series"+t]&&(this.hash["series"+t]=[]),this.hash["series"+t][i]=e,e.interval=t},Indicator.prototype.getAllDataSeriesArray=function(){for(var t=[],e=0,i=this.intervals;e<i.length;e++){var n=i[e],a=this.getDataSeries(n);a&&t.push(a)}return t},Indicator.prototype.clear=function(t){if(void 0===t&&(t=0),0===t){for(var e=0,i=this.intervals;e<i.length;e++){var n=i[e];delete this.hash["series"+n]}this.intervals=[]}else{delete this.hash["series"+t];var a=this.intervals.indexOf(t);-1!==a&&this.intervals.splice(a,1)}},Indicator.prototype.getDataSeries=function(e,i){return void 0===i&&(i=t.Intervals.INTRADAY),this.hash["series"+e]?this.hash["series"+e][i]:null},Indicator.prototype.hasInterval=function(t){for(var e=this.intervals.length;e>=0&&this.intervals[e]!==t;)e--;return-1!==e},Indicator}();t.Indicator=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){return function InfoDotInfo(){}}();t.InfoDotInfo=e;var i=function(t){function InfoDot(){var e=t.call(this)||this;return e.tickerText=new flash.text.TextField,e.valueText=new flash.text.TextField,e.tickerText.autoSize=flash.text.TextFieldAutoSize.LEFT,e.tickerText.selectable=!1,e.valueText.autoSize=flash.text.TextFieldAutoSize.LEFT,e.valueText.selectable=!1,e.addChild(e.tickerText),e.addChild(e.valueText),e}return __extends(InfoDot,t),InfoDot.prototype.setInfo=function(t){var e=t.quoteColor,i=this.graphics;i.clear(),i.lineStyle(10,e,1),i.moveTo(0,9),i.lineTo(.5,9),InfoDot.tickerFormat.color=e,this.tickerText.defaultTextFormat=InfoDot.tickerFormat,this.tickerText.x=this.tickerText.x+InfoDot.TEXT_SPACING,t.displayName?this.tickerText.text=t.displayName:this.tickerText.text=t.quote,InfoDot.valueFormat.color=t.valueColor,this.valueText.defaultTextFormat=InfoDot.valueFormat,this.valueText.text=t.value,this.valueText.y=this.tickerText.height-this.valueText.height,this.valueText.x=this.tickerText.width+this.tickerText.x-InfoDot.TEXT_SPACING},InfoDot.TEXT_SPACING=5,InfoDot.tickerFormat=new flash.text.TextFormat("Helvetica",12,0,!0,!1,!1),InfoDot.valueFormat=new flash.text.TextFormat("Helvetica",10,10066329,!1,!1,!1),InfoDot}(flash.display.Sprite);t.InfoDot=i}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function IntervalBasedAHChartLayer(t,i){var n=e.call(this,t,i)||this;return n.setEnabled(!0),n}return __extends(IntervalBasedAHChartLayer,e),IntervalBasedAHChartLayer.prototype.drawOhlcBars=function(t,e,i,n){for(var a=this.getAfterHoursBarWidth(),r=this.graphics,o=i;o>e;o--)if(!(isNaN(t[o].high)||isNaN(t[o].low)||isNaN(t[o].open))){var s=t[o],l=this.viewPoint.getXPos(s),h=this.getOhlcYPos(n,s);if(r.lineStyle(1,this.getOhlcColor(s,t[Math.max(o-1,0)])),!s.fake)if(Math.abs(h.highY-h.lowY)<=1){var c=(h.highY+h.lowY)/2;0===a?(r.moveTo(l,c-.5),r.lineTo(l,c+.5)):(r.moveTo(l-a/2,c),r.lineTo(l+a/2,c))}else r.moveTo(l-a/2,h.openY),r.lineTo(l,h.openY),r.moveTo(l,h.closeY),r.lineTo(l+a/2,h.closeY),r.moveTo(l,h.highY),r.lineTo(l,h.lowY)}},IntervalBasedAHChartLayer.prototype.renderLayer=function(e){this.graphics.clear();var i=this.viewPoint,n=i.getDetailLevelForTechnicalStyle(),a=i.getDisplayManager().getEnabledChartLayer();if(!(n>=t.Intervals.DAILY||n!==t.Intervals.INTRADAY&&a!==t.Const.LINE_CHART)){var r=this.getDataSeries().getPointsInIntervalArray(t.Const.INTRADAY_INTERVAL);if(r){this.visibleSessionsTimes=this.getVisibleSessionsTimes(e,r),this.localYOffset=i.miny+i.medPriceY+i.V_OFFSET,this.localYScale=i.maxPriceRangeViewSize/e.maxPriceRange,this.regionsXLimits=new t.IntervalSet;for(var o=0;o<this.visibleSessionsTimes.length();o++){var s=this.visibleSessionsTimes.getIntervalAt(o);this.drawAfterHoursSession(s.start,s.end,e,r)}}}},IntervalBasedAHChartLayer.prototype.highlightPoint=function(t,i,n){this.regionsXLimits&&this.regionsXLimits.containsValue(i)?e.prototype.highlightPoint.call(this,t,i,n):this.clearHighlight()},IntervalBasedAHChartLayer.prototype.getVisibleSessionsTimes=function(e,i){for(var n=new t.IntervalSet,a=this.dataSource.visibleExtendedHours,r=a.length()-1;r>=0;r--){var o=a.getIntervalAt(r),s=i[o.start],l=i[o.end];t.ViewPoint.sessionVisible(s,l,e)&&n.addInterval(s.time,l.time)}return n},IntervalBasedAHChartLayer.prototype.drawCandleSticks=function(t,e,i,n){for(var a=this.getAfterHoursBarWidth(),r=this.graphics,o=i;o>e;o--)if(!(isNaN(t[o].high)||isNaN(t[o].low)||isNaN(t[o].open))){var s=t[o],l=this.viewPoint.getXPos(s),h=this.getOhlcYPos(n,s),c=s.close>=s.open,u=this.getCandleStickColor(s);if(r.lineStyle(1,u),!s.fake){if(Math.abs(h.closeY-h.openY)<=1){var d=(h.closeY+h.openY)/2;0===a?(r.moveTo(l,d-.5),r.lineTo(l,d+.5)):(r.moveTo(l-a/2,d),r.lineTo(l+a/2,d))}else r.moveTo(l-a/2,c?Number(h.closeY):h.openY),c||r.beginFill(u),r.lineTo(l+a/2,c?Number(h.closeY):h.openY),r.lineTo(l+a/2,c?Number(h.openY):h.closeY),r.lineTo(l-a/2,c?Number(h.openY):h.closeY),r.lineTo(l-a/2,c?Number(h.closeY):h.openY),c||r.endFill();r.moveTo(l,h.lowY),r.lineTo(l,c?Number(h.openY):h.closeY),r.moveTo(l,c?Number(h.closeY):h.openY),r.lineTo(l,h.highY)}}},IntervalBasedAHChartLayer.prototype.getContext=function(t,i){return void 0===i&&(i=!1),this.dataSource.visibleExtendedHours.length()>0?e.prototype.getContext.call(this,t,i):t},IntervalBasedAHChartLayer.prototype.drawLines=function(e,i,n,a){var r=this.viewPoint.getXPos(e[n]),o=this.getCloseYPos(a,e[n]),s=this.graphics;s.lineStyle(0,0,0),s.beginFill(t.Const.ECN_LINE_CHART_FILL_COLOR,t.Const.ECN_LINE_CHART_FILL_VISIBILITY),s.moveTo(r,this.viewPoint.maxy-15),s.lineTo(r,o),s.lineStyle(t.Const.ECN_LINE_CHART_LINE_THICKNESS,t.Const.ECN_LINE_CHART_LINE_COLOR,t.Const.ECN_LINE_CHART_LINE_VISIBILITY);for(var l=n;l>i;l--)r=this.viewPoint.getXPos(e[l]),o=this.getCloseYPos(a,e[l]),s.lineTo(r,o);s.lineStyle(0,0,0),s.lineTo(r,this.viewPoint.maxy-15),s.endFill()},IntervalBasedAHChartLayer.prototype.getAfterHoursBarWidth=function(){var e=t.Const.BAR_WIDTH_RATIO*this.viewPoint.minutePix*2;return e%2==0?e:e-1},IntervalBasedAHChartLayer.prototype.getDataSeries=function(t){return this.dataSource.afterHoursData},IntervalBasedAHChartLayer.prototype.drawAfterHoursSession=function(e,i,n,a){var r=t.DataSource.getTimeIndex(i,a),o=t.DataSource.getTimeIndex(e,a),s=Math.min(r,this.getLastRealPointIndex(a));switch(this.viewPoint.getDisplayManager().getEnabledChartLayer()){case t.Const.CANDLE_STICK:this.drawCandleSticks(a,o,s,n);break;case t.Const.OHLC_CHART:this.drawOhlcBars(a,o,s,n);break;default:this.drawLines(a,o,s,n)}this.regionsXLimits.addInterval(this.viewPoint.getXPos(a[o]),this.viewPoint.getXPos(a[r]))},IntervalBasedAHChartLayer}(t.IntervalBasedChartLayer);t.IntervalBasedAHChartLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function IntervalBasedVolumeLayer(t,i){var n=e.call(this,t,i)||this;return n.highlightCanvas=new flash.display.Sprite("highlightCanvas"),n.addChild(n.highlightCanvas),n}return __extends(IntervalBasedVolumeLayer,e),IntervalBasedVolumeLayer.prototype.getYPos=function(t,e){return e.maxy-(t>=0?t:0)*this.localYScale},IntervalBasedVolumeLayer.prototype.findPointIndex=function(e){var i=notnull(this.getDataSeries()),n=this.viewPoint.getDetailLevelForTechnicalStyle(),a=t.Const.getDetailLevelInterval(n),r=i.getPointsInIntervalArray(a);if(!r)return-1;var o=this.viewPoint.getMinuteOfX(e),s=i.getRelativeMinuteIndex(o,r);if(s===r.length-2&&Math.abs(o-r[s].relativeMinutes)>Math.abs(o-r[s+1].relativeMinutes)&&s++,n===t.Intervals.WEEKLY)for(;s+1<r.length&&r[s+1].weeklyXPos<=e;)s++;for(;s>0&&(r[s].fake||r[s].duplicate||0===r[s].volumes[a]);)s--;return s},IntervalBasedVolumeLayer.prototype.clearHighlight=function(){this.highlightCanvas.graphics.clear()},IntervalBasedVolumeLayer.prototype.drawHorizontalLine=function(e){var i=this.graphics;i.lineStyle(0,t.Const.HORIZONTAL_GRID_COLOR,1),i.moveTo(this.viewPoint.minx+1,e),i.lineTo(this.viewPoint.maxx-1,e)},IntervalBasedVolumeLayer.prototype.drawOneBar=function(t,e,i,n,a,r){void 0===r&&(r=-1),i.maxy-e<1&&i.maxy-e>0?e=i.maxy-1:e<i.miny&&(e=i.miny);var o=n.graphics;-1!==r&&o.beginFill(r),o.drawRect(t-a/2,e,a,i.maxy-e),-1!==r&&o.endFill()},IntervalBasedVolumeLayer.prototype.drawOneLine=function(t,e,i,n){i.maxy-e<1&&i.maxy-e>0?e=i.maxy-1:e<i.miny&&(e=i.miny);var a=n.graphics;a.moveTo(t,e),a.lineTo(t,i.maxy)},IntervalBasedVolumeLayer.prototype.getContext=function(e,i){void 0===i&&(i=!1);var n=notnull(this.getDataSeries(e)),a=this.viewPoint.getDetailLevelForTechnicalStyle(e.lastMinute,e.count),r=t.Const.getDetailLevelInterval(a),o=n.getPointsInIntervalArray(r);if(!o)return e;var s=e.lastMinute-e.count,l=n.getRelativeMinuteIndex(s,o)-1;l<0&&(l=0);var h=n.getRelativeMinuteIndex(e.lastMinute,o)+1;h>=o.length&&(h=o.length-1);for(var c=o[h].volumes[r],u=h-1;u>=l;u--)c=t.Utils.extendedMax(c,o[u].volumes[r]);for(var d=NaN,g=1;g<t.Const.VOLUME_SCALES.length&&(d=t.Const.VOLUME_SCALES[g],!(Math.floor(c/d)<10));g++);var p=(Math.floor(c/d)+1)*d;return e.maxVolume=t.Utils.extendedMax(e.maxVolume,p),e},IntervalBasedVolumeLayer.prototype.renderLayer=function(e){var i=notnull(this.getDataSeries()),n=this.viewPoint,a=this.graphics;a.clear();var r=n.getDetailLevelForTechnicalStyle(),o=t.Const.getDetailLevelInterval(r),s=i.getPointsInIntervalArray(o);if(s&&0!==s.length&&void 0!==e.maxVolume){this.localYScale=(n.maxy-n.miny-t.Const.BOTTOM_VIEWPOINT_HEADER_HEIGHT)/e.maxVolume;var l=Math.max(i.getRelativeMinuteIndex(n.getFirstMinute(),s)-1,0),h=Math.min(i.getRelativeMinuteIndex(n.getLastMinute(),s)+1,this.getLastRealPointIndex(s)),c=n.getDisplayManager().getEnabledChartLayer(),u=Number.MAX_VALUE;if(t.Const.VOLUME_PLUS_ENABLED&&-1!==t.Const.VOLUME_PLUS_CHART_TYPE.indexOf(c))for(var d=this.getBarWidth(r,i),g=h;g>=l;g--){var p=s[g];if(!isNaN(p.open)&&(p.close>=p.open?a.lineStyle(1,t.Const.POSITIVE_DIFFERENCE_COLOR):a.lineStyle(1,t.Const.NEGATIVE_DIFFERENCE_COLOR),!i.minuteIsStartOfDataSession(p.dayMinute))){var v=void 0;r===t.Intervals.WEEKLY&&c!==t.Const.LINE_CHART?u=v=this.getWeeklyBarXPos(p,u):v=n.getXPos(p);var y=this.getYPos(p.volumes[o],n);this.drawOneBar(v,y,n,this,d,p.close>=p.open?-1:t.Const.NEGATIVE_DIFFERENCE_COLOR)}}else{a.lineStyle(1,t.Const.LINE_CHART_LINE_COLOR);for(g=h;g>=l;g--){p=s[g];if(!i.minuteIsStartOfDataSession(p.dayMinute)){v=void 0;r===t.Intervals.WEEKLY&&c!==t.Const.LINE_CHART?u=v=this.getWeeklyBarXPos(p,u):v=n.getXPos(p);y=this.getYPos(p.volumes[o],n);this.drawOneLine(v,y,n,this)}}}this.drawHorizontalLine(n.miny+t.Const.BOTTOM_VIEWPOINT_HEADER_HEIGHT)}},IntervalBasedVolumeLayer.prototype.highlightPoint=function(e,i,n){if(!n.ahsetter){var a=notnull(this.getDataSeries()),r=this.viewPoint,o=this.findPointIndex(i),s=r.getDetailLevelForTechnicalStyle(),l=t.Const.getDetailLevelInterval(s),h=a.getPointsInIntervalArray(l);if(h&&-1!==o){var c=h[o];this.clearHighlight();var u=isNaN(c.weeklyXPos)?r.getXPos(c):Number(c.weeklyXPos),d=this.getYPos(c.volumes[l],r),g=r.getDisplayManager().getEnabledChartLayer(),p=this.highlightCanvas.graphics;t.Const.VOLUME_PLUS_ENABLED&&-1!==t.Const.VOLUME_PLUS_CHART_TYPE.indexOf(g)?(p.lineStyle(5,t.Const.DOT_COLOR,1),p.moveTo(u,d-.2),p.lineTo(u,d+.2)):(p.lineStyle(2,t.Const.VOLUME_HIGHLIGHT_COLOR,1),this.drawOneLine(u,d,r,this.highlightCanvas)),n[t.SpaceText.VOLUME_STR]=c.volumes[l],n.volumesetter=this}}},IntervalBasedVolumeLayer}(t.AbstractDrawingLayer);t.IntervalBasedVolumeLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function IntervalBasedAHVolumeLayer(){return null!==e&&e.apply(this,arguments)||this}return __extends(IntervalBasedAHVolumeLayer,e),IntervalBasedAHVolumeLayer.prototype.highlightPoint=function(e,i,n){if(this.clearHighlight(),this.regionsXLimits&&this.regionsXLimits.containsValue(i)){n.volumesetter&&n.volumesetter.clearHighlight();var a=this.getDataSeries(),r=this.viewPoint,o=this.findPointIndex(i),s=r.getDetailLevelForTechnicalStyle(),l=t.Const.getDetailLevelInterval(s),h=a.getPointsInIntervalArray(l);if(h&&-1!==o){var c=h[o],u=r.getXPos(c),d=this.getYPos(c.volumes[l],r);this.highlightCanvas.graphics.lineStyle(2,t.Const.VOLUME_HIGHLIGHT_COLOR,1),this.drawOneLine(u,d,r,this.highlightCanvas),n[t.SpaceText.VOLUME_STR]=c.volumes[l],n.ahsetter=this}}},IntervalBasedAHVolumeLayer.prototype.renderLayer=function(i){this.graphics.clear();var n=this.viewPoint;if(n.getDetailLevelForTechnicalStyle()===t.Intervals.INTRADAY){var a=this.getDataSeries().getPointsInIntervalArray(t.Const.INTRADAY_INTERVAL);if(a){var r=this.dataSource.visibleExtendedHours;if(0!==r.length()){this.regionsXLimits=new t.IntervalSet;for(var o=0;o<r.length();o++){var s=r.getIntervalAt(o),l=a[s.start],h=a[s.end];if(t.ViewPoint.sessionVisible(l,h,i)){var c=n.getXPos(l),u=n.getXPos(h);this.regionsXLimits.addInterval(c,u)}}e.prototype.renderLayer.call(this,i)}}}},IntervalBasedAHVolumeLayer.prototype.getDataSeries=function(t){return this.dataSource.afterHoursData},IntervalBasedAHVolumeLayer}(t.IntervalBasedVolumeLayer);t.IntervalBasedAHVolumeLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function IntervalBasedChartManagerLayer(i,n){var a=e.call(this,i,n)||this;a.chartLayers=[],IntervalBasedChartManagerLayer.enabledChartLayerName||(IntervalBasedChartManagerLayer.enabledChartLayerName=t.Const.DEFAULT_CHART_STYLE_NAME);for(var r=0,o=t.Const.CHART_STYLE_NAMES;r<o.length;r++){var s=o[r],l=new(getDefinitionByName("com.google.finance."+s))(i,n);l.name=s,l.layerId=s,l.setLayerName(s),a.chartLayers.push(l),s===IntervalBasedChartManagerLayer.enabledChartLayerName&&(l.setEnabled(!0),a.enabledChartLayer=l),a.addChild(l)}return a}return __extends(IntervalBasedChartManagerLayer,e),IntervalBasedChartManagerLayer.getEnabledChartLayerName=function(){return IntervalBasedChartManagerLayer.enabledChartLayerName},IntervalBasedChartManagerLayer.prototype.getEnabledLayerName=function(){return this.enabledChartLayer?this.enabledChartLayer.getLayerName():""},IntervalBasedChartManagerLayer.prototype.setEnabledLayer=function(t){if(this.getEnabledLayerName()!==t){this.enabledChartLayer&&(this.enabledChartLayer.setEnabled(!1),this.enabledChartLayer=null,IntervalBasedChartManagerLayer.enabledChartLayerName=null);for(var e=0,i=this.chartLayers;e<i.length;e++){var n=i[e];if(n.getLayerName()===t){n.setEnabled(!0),this.enabledChartLayer=n,IntervalBasedChartManagerLayer.enabledChartLayerName=t;break}}}},IntervalBasedChartManagerLayer.prototype.getContext=function(t,e){return void 0===e&&(e=!1),this.enabledChartLayer?this.enabledChartLayer.getContext(t,e):t},IntervalBasedChartManagerLayer.prototype.renderLayer=function(t){this.enabledChartLayer&&this.enabledChartLayer.renderLayer(t)},IntervalBasedChartManagerLayer.prototype.highlightPoint=function(t,e,i){this.enabledChartLayer&&this.enabledChartLayer.highlightPoint(t,e,i)},IntervalBasedChartManagerLayer.prototype.clearHighlight=function(){this.enabledChartLayer&&this.enabledChartLayer.clearHighlight()},IntervalBasedChartManagerLayer}(t.AbstractDrawingLayer);t.IntervalBasedChartManagerLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function IntervalBasedIndependentObjectsLayer(t,i){var n=e.call(this,t,i)||this;return n.movies=[],n.activeMovies=0,n.positioning=IntervalBasedIndependentObjectsLayer.POSITION_CHART,n.highlightCanvas=new flash.display.Sprite("highlightCanvas"),n.viewPoint.addChildToTopCanvas(n.highlightCanvas),n}return __extends(IntervalBasedIndependentObjectsLayer,e),IntervalBasedIndependentObjectsLayer.prototype.resetCanvas=function(){for(var t=0,e=this.movies;t<e.length;t++){var i=e[t];this.removeChild(i)}this.movies.splice(0)},IntervalBasedIndependentObjectsLayer.prototype.getDataUnit=function(t,e){var i=notnull(t.posInInterval);return notnull(i[e].refDataSeries).getPointsInIntervalArray(e)[i[e].position]},IntervalBasedIndependentObjectsLayer.prototype.getYPos=function(t,e){var i=this.viewPoint;return i.miny+i.V_OFFSET+i.medPriceY-(e.close-t.medPrice)*i.maxPriceRangeViewSize/t.maxPriceRange},IntervalBasedIndependentObjectsLayer.prototype.renderLayer=function(e){if(!isNaN(e.lastMinute)&&!isNaN(e.count)&&0!==e.count){var i=this.dataSource.objects[this.renderObj];if(i&&0!==i.length){var n=this.viewPoint.getDetailLevelForTechnicalStyle(),a=t.Const.getDetailLevelInterval(n);this.activeMovies=0;var r=this.getFirstVisibleObject(i,a,e);if(-1!==r){var o=this.getLastVisibleObject(i,a,e),s=this.viewPoint.count/this.dataSource.data.marketDayLength;e[this.renderObj]=[];for(var l=0,h=r;h<=o;h++){var c=i[h];if(notnull(c.posInInterval)[a]){var u=this.getPosition(c,a,e),d=this.putObject(c,u);if(s>IntervalBasedIndependentObjectsLayer.HIDE_TEXT_THRESHOLD?(d.hideText(),d.setPersistentHide(!0)):d.setPersistentHide(!1),e[this.renderObj].push(d),this.avoidObj&&e[this.avoidObj]){for(;l<e[this.avoidObj].length-1&&e[this.avoidObj][l].x<d.x;)l++;if(l<e[this.avoidObj].length){var g=e[this.avoidObj][l];g.x===d.x&&(g.setOrientation(t.Orientations.SIDEWAYS+u.orientation),d.setOrientation(t.Orientations.SIDEWAYS+u.orientation))}}}}for(var p=this.activeMovies;p<this.movies.length;p++)this.removeChild(this.movies[p]);this.movies.splice(this.activeMovies)}else this.resetCanvas()}else this.resetCanvas()}},IntervalBasedIndependentObjectsLayer.prototype.getPosition=function(e,i,n){var a=new t.Position,r=this.getDataUnit(e,i),o=isNaN(r.weeklyXPos)?this.viewPoint.getXPos(r):Number(r.weeklyXPos),s=this.getYPos(n,r);if(this.positioning===IntervalBasedIndependentObjectsLayer.POSITION_CHART)s>this.viewPoint.miny+40?(a.y=s-IntervalBasedIndependentObjectsLayer.OBJECT_DISTANCE,a.orientation=t.Orientations.DOWN):(a.y=s+IntervalBasedIndependentObjectsLayer.OBJECT_DISTANCE,a.orientation=t.Orientations.UP);else if(this.positioning===IntervalBasedIndependentObjectsLayer.POSITION_BOTTOM){var l=this.viewPoint.getLayer("BottomBarLayer"),h=0;l&&(h=Number(l.bottomTextHeight)),a.y=this.viewPoint.maxy-h,a.orientation=t.Orientations.DOWN}return a.x=o,a},IntervalBasedIndependentObjectsLayer.prototype.getLastVisibleObject=function(t,e,i){for(var n=i.lastMinute,a=t.length-1;a>=0;a--)if(notnull(t[a].posInInterval)[e]){var r=this.getDataUnit(t[a],e);if(r&&r.relativeMinutes<n)return a}return-1},IntervalBasedIndependentObjectsLayer.prototype.putObject=function(e,i){var n;if(this.activeMovies>=this.movies.length){var a=void 0;switch(this.renderObj){case"split":a=t.SplitMovie;break;case"dividend":a=t.DividendMovie;break;case"stock_dividend":a=t.StockDividendMovie;break;default:throw new Error}n=new a,this.addChild(n)}else n=this.movies[this.activeMovies];if(n.x=i.x,n.y=i.y,n.setObject(e),e.originalObject._orientation)switch(e.originalObject._orientation){case"down":i.orientation=t.Orientations.DOWN;break;case"up":i.orientation=t.Orientations.UP}return n.setOrientation(i.orientation),n.setSupportingLayer(this),n.setHighlightCanvas(this.highlightCanvas),this.activeMovies>=this.movies.length&&this.movies.push(n),this.activeMovies++,n},IntervalBasedIndependentObjectsLayer.prototype.getFirstVisibleObject=function(t,e,i){for(var n=i.lastMinute-i.count,a=0;a<t.length;a++)if(notnull(t[a].posInInterval)[e]){var r=this.getDataUnit(t[a],e);if(r&&r.relativeMinutes>n)return a}return-1},IntervalBasedIndependentObjectsLayer.POSITION_BOTTOM="bottom",IntervalBasedIndependentObjectsLayer.HIDE_TEXT_THRESHOLD=1500,IntervalBasedIndependentObjectsLayer.POSITION_CHART="chart",IntervalBasedIndependentObjectsLayer.TOP_DEPTH=16e3,IntervalBasedIndependentObjectsLayer.MIN_PADDING=20,IntervalBasedIndependentObjectsLayer.OBJECT_DISTANCE=6,IntervalBasedIndependentObjectsLayer}(t.AbstractLayer);t.IntervalBasedIndependentObjectsLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function IntervalBasedLineChartLayer(){return null!==e&&e.apply(this,arguments)||this}return __extends(IntervalBasedLineChartLayer,e),IntervalBasedLineChartLayer.prototype.drawLine=function(e,i,n,a,r,o,s){var l=NaN,h=this.graphics;switch(e){case t.Intervals.DAILY:case t.Intervals.WEEKLY:if(isNaN(s)){var c=this.viewPoint.getXPos(n[r]);h.moveTo(c,this.viewPoint.maxy),h.lineStyle(0,0,0),h.lineTo(c,this.getCloseYPos(i,n[r])),r--}else{for(;r>=a&&this.viewPoint.getXPos(n[r])>=o;)r--;if(r<a)return o;h.moveTo(o,this.viewPoint.maxy),h.lineStyle(0,0,0),h.lineTo(o,s)}h.lineStyle(this.lineThickness,this.lineColor,this.lineVisibility);for(var u=r;u>=a;u--)l=this.viewPoint.getXPos(n[u]),h.lineTo(l,this.getCloseYPos(i,n[u]));return l;case t.Intervals.INTRADAY:case t.Intervals.FIVE_MINUTES:case t.Intervals.HALF_HOUR:for(;r>=a&&this.viewPoint.getXPos(n[r])>=o;)r--;if(r<a)return o;l=this.viewPoint.getXPos(n[r]),h.moveTo(l,this.viewPoint.maxy);for(var d=r,g=0===this.dataSource.visibleExtendedHours.length(),p=this.dataSource.data.marketDayLength;d>a;){h.lineStyle(0,0,0),l=this.viewPoint.getXPos(n[d]),h.lineTo(l,this.viewPoint.maxy),h.lineTo(l,this.getCloseYPos(i,n[d]));var v=notnull(this.getDataSeries());for(h.lineStyle(this.lineThickness,this.lineColor,this.lineVisibility);d>a&&n[d].dayMinute!==v.marketOpenMinute;)d--,l=this.viewPoint.getXPos(n[d]),h.lineTo(l,this.getCloseYPos(i,n[d]));if(h.lineStyle(0,0,0),h.lineTo(l,this.viewPoint.maxy),d--,g&&d>a){var y=n[d].relativeMinutes,f=n[d+1].relativeMinutes;if(f>y+p){var T=this.getCloseYPos(i,n[d]);l=this.viewPoint.getMinuteXPos(f-1),h.lineTo(l,this.viewPoint.maxy),h.lineTo(l,T),h.lineStyle(this.lineThickness,this.lineColor,this.lineVisibility),l=this.viewPoint.getMinuteXPos(y+1),h.lineTo(l,T),h.lineStyle(0,0,0),h.lineTo(l,this.viewPoint.maxy)}}}return this.viewPoint.getXPos(n[a]);default:return-1}},IntervalBasedLineChartLayer.prototype.renderLayer=function(e){if(this.isEnabled()){var i=this.viewPoint,n=notnull(this.getDataSeries());this.localYOffset=i.miny+i.medPriceY+i.V_OFFSET,this.localYScale=i.maxPriceRangeViewSize/e.maxPriceRange,this.lineThickness=t.Const.LINE_CHART_LINE_THICKNESS,this.lineColor=t.Const.LINE_CHART_LINE_COLOR,this.lineVisibility=t.Const.LINE_CHART_LINE_VISIBILITY;var a=i.getDetailLevelForTechnicalStyle(),r=0,o=Number.MAX_VALUE,s=NaN,l=!0,h=this.graphics;h.clear();do{var c=t.Const.getDetailLevelInterval(a),u=n.getPointsInIntervalArray(c);if(u&&0!==u.length){r=Math.max(n.getRelativeMinuteIndex(i.getFirstMinute(),u)-1,0);var d=Math.min(n.getRelativeMinuteIndex(i.getLastMinute(),u)+1,this.getLastRealPointIndex(u)),g=u[u.length-1];if(l&&a>=t.Intervals.DAILY&&d===u.length-1&&g.relativeMinutes<i.getLastMinute()){var p=n.getPointsInIntervalArray(t.Const.INTRADAY_INTERVAL);if(p&&p.length>0){var v=p[p.length-1],y=i.getXPos(v),f=this.getCloseYPos(e,v);h.beginFill(t.Const.LINE_CHART_FILL_COLOR,t.Const.LINE_CHART_FILL_VISIBILITY),h.moveTo(y,i.maxy),h.lineStyle(0,0,0),h.lineTo(y,f),y=i.getXPos(g),f=this.getCloseYPos(e,g),h.lineStyle(this.lineThickness,this.lineColor,this.lineVisibility),h.lineTo(y,f),h.lineStyle(0,0,0),h.lineTo(y,i.maxy),h.endFill()}}h.beginFill(t.Const.LINE_CHART_FILL_COLOR,t.Const.LINE_CHART_FILL_VISIBILITY),o=this.drawLine(a,e,u,r,d,o,s),s=this.getCloseYPos(e,u[r]),h.lineStyle(0,0,0),h.lineTo(o,i.maxy),h.endFill(),l=!1,a++}else a++}while(a<=t.Intervals.WEEKLY&&0===r)}},IntervalBasedLineChartLayer}(t.IntervalBasedChartLayer);t.IntervalBasedLineChartLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function IntervalBasedPinPointsLayer(i,n){var a=e.call(this,i,n)||this;return a.localYOffset=0,a.localYScale=0,a.pinPointYWhenContentDisplayed=0,a.activeMovies=0,a.pinMovies=[],a.pinPointContentMovie=new t.PinPointContentMovie(i),i.addChildToTopCanvas(a.pinPointContentMovie),a}return __extends(IntervalBasedPinPointsLayer,e),IntervalBasedPinPointsLayer.prototype.getDataUnit=function(t,e){var i=notnull(t.posInInterval);return notnull(i[e].refDataSeries).getPointsInIntervalArray(e)[i[e].position]},IntervalBasedPinPointsLayer.prototype.getLastVisibleFlagIndex=function(t,e,i){for(var n=e.length-1;n>=0;n--){var a=e[n];if(notnull(a.posInInterval)[i]&&this.getDataUnit(a,i).relativeMinutes<=t.lastMinute)return n}return-1},IntervalBasedPinPointsLayer.prototype.getFirstVisibleFlagIndex=function(t,e,i){for(var n=0;n<e.length;n++){var a=e[n];if(notnull(a.posInInterval)[i]&&this.getDataUnit(a,i).relativeMinutes>t.lastMinute-t.count)return n}return e.length-1},IntervalBasedPinPointsLayer.prototype.getPinPointMovieClip=function(e){var i,n=e.originalObject._color?e.originalObject._color:"gray";this.activeMovies>=this.pinMovies.length?(i="orange"===n?new t.OrangePinPointMovie:new t.PinPointMovie,this.addChild(i),this.pinMovies.push(i)):((i=this.pinMovies[this.activeMovies])instanceof t.OrangePinPointMovie?"orange":"gray")!==n&&(i="orange"===n?new t.OrangePinPointMovie:new t.PinPointMovie,this.removeChild(this.pinMovies[this.activeMovies]),this.pinMovies[this.activeMovies].clearReferences(),delete this.pinMovies[this.activeMovies],this.pinMovies[this.activeMovies]=i);return i.setPinPointContentMovie(this.pinPointContentMovie),this.activeMovies++,i},IntervalBasedPinPointsLayer.prototype.removePinMovies=function(t){for(var e=t;e<this.pinMovies.length;e++)this.removeChild(this.pinMovies[e]),this.pinMovies[e].clearReferences(),delete this.pinMovies[e];this.pinMovies.splice(t)},IntervalBasedPinPointsLayer.prototype.getYPos=function(t,e){return this.localYOffset-(e.getCloseLogValue(t.verticalScaling)-t.medPrice)*this.localYScale},IntervalBasedPinPointsLayer.prototype.renderLayer=function(e){if(!isNaN(e.lastMinute)&&!isNaN(e.count)&&0!==e.count){var i=this.viewPoint,n=this.dataSource.objects.newspin;if(this.activeMovies=0,this.pinPointContentMovie.clearMovie(),n&&0!==n.length){var a="orange"!==n[0].originalObject._color;if(t.Const.DISPLAY_NEWS_PINS||!a){this.localYOffset=i.miny+i.medPriceY+i.V_OFFSET,this.localYScale=i.maxPriceRangeViewSize/e.maxPriceRange;var r=i.getLayer("BottomBarLayer");this.pinPointYWhenContentDisplayed=i.maxy-(r?r.bottomTextHeight:0);var o=i.getDetailLevelForTechnicalStyle(),s=t.Const.getDetailLevelInterval(o),l=this.getFirstVisibleFlagIndex(e,n,s),h=this.getLastVisibleFlagIndex(e,n,s);this.lastAbsoluteHeightMin=0,this.lastAbsoluteHeightMax=0,this.renderFlagGroups(e,n,l,h,s),this.removePinMovies(this.activeMovies),a||this.pinPointContentMovie.renderMovie()}else this.removePinMovies(0)}else this.removePinMovies(0)}},IntervalBasedPinPointsLayer.prototype.renderFlagGroups=function(e,i,n,a,r){for(var o=0,s=[],l=[],h=[],c=[],u=n;u<=a;u+=o){s.push(u),o=this.getFlagGroupCount(e,i,u,r),l.push(o);var d=this.getDataUnit(i[u],r);h.push(Math.floor(isNaN(d.weeklyXPos)?this.viewPoint.getXPos(d):Number(d.weeklyXPos))),c.push(this.getYPos(e,d))}if(s.length>0){for(var g=[],p=s.length-1;p>=0;p--)(0===g.length||g[g.length-1]===t.PinOrientations.LEFT_ORIENTATION)&&h[p]+(s.length-p)*IntervalBasedPinPointsLayer.MIN_FLAGS_DIST>this.viewPoint.maxx?g.push(t.PinOrientations.LEFT_ORIENTATION):g.push(t.PinOrientations.RIGHT_ORIENTATION);g.reverse();for(p=0;p<s.length;p++)this.renderFlagsGroup(e,r,h[p],c[p],s[p],l[p],i,IntervalBasedPinPointsLayer.FLAG_POLE_HEIGHT+IntervalBasedPinPointsLayer.FLAG_HEIGHT,g[p])}},IntervalBasedPinPointsLayer.prototype.renderFlag=function(t,e,i,n,a,r){void 0===r&&(r=1);var o=this.getPinPointMovieClip(n);this.addChild(o),o.x=t,o.y=this.pinPointYWhenContentDisplayed,o.setCount(r),o.setObj(n),o.setOrientation(e),o.setHeight(i)},IntervalBasedPinPointsLayer.prototype.getFlagGroupCount=function(t,e,i,n){var a=1,r=notnull(e[i].posInInterval)[n];if(!r)return a;for(;i+a<e.length;){var o=notnull(e[i+a].posInInterval)[n];if(!o||r.position!==o.position||r.refDataSeries!==o.refDataSeries)break;a++}return a},IntervalBasedPinPointsLayer.prototype.renderFlagsGroup=function(e,i,n,a,r,o,s,l,h){this.lastAbsoluteHeightMin=a-l+IntervalBasedPinPointsLayer.FLAG_HEIGHT;for(var c,u=!1,d=r;d<r+o;d++)u=u||s[d].active||s[d].forceExpandInGroup;if(o>1&&u||!Boolean(t.Const.ENABLE_COMPACT_FLAGS)){c=l+(o-1)*IntervalBasedPinPointsLayer.FLAG_HEIGHT;for(d=r;d<r+o;d++){var g=l+(d-r)*IntervalBasedPinPointsLayer.FLAG_HEIGHT;this.renderFlag(n,h,g,s[d]),s[d].active&&this.pinPointContentMovie.setActivePinPoint(s[d],n,this.pinPointYWhenContentDisplayed-c)}}else{var p=2*Math.min(o,t.PinPointMovie.MAX_SHOWN_GROUP_COUNT);c=l+p,this.renderFlag(n,h,l+p,s[r+o-1],s[r],o),s[r].active&&this.pinPointContentMovie.setActivePinPoint(s[r],n,this.pinPointYWhenContentDisplayed-c)}this.lastAbsoluteHeightMax=a-this.pinMovies[this.activeMovies-1].getHeight()},IntervalBasedPinPointsLayer.FLAG_HEIGHT=14,IntervalBasedPinPointsLayer.MIN_FLAGS_DIST=10,IntervalBasedPinPointsLayer.FLAG_POLE_HEIGHT=10,IntervalBasedPinPointsLayer}(t.AbstractLayer);t.IntervalBasedPinPointsLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){function IntervalSet(){this.intervals=[]}return IntervalSet.prototype.getIntervalForValue=function(t){for(var e=this.intervals.length-1;e>=0&&this.intervals[e].start>t;)e--;return-1===e||this.intervals[e].end<t?null:this.intervals[e]},IntervalSet.prototype.addInterval=function(e,i){this.addPair(new t.StartEndPair(e,i))},IntervalSet.prototype.getClosestEarlierIntervalForValue=function(t){if(0===this.intervals.length)return null;for(var e=null,i=0,n=this.intervals;i<n.length;i++){var a=n[i];if(a.start<=t&&t<=a.end)return a;a.end<t&&(!e||e.end<a.end)&&(e=a)}return e||this.getEarliestInterval()},IntervalSet.prototype.toString=function(){return this.intervals.join(",")},IntervalSet.prototype.length=function(){return this.intervals.length},IntervalSet.prototype.getEarliestInterval=function(){return 0===this.intervals.length?null:this.intervals[0]},IntervalSet.prototype.containsValue=function(t){return!!this.getIntervalForValue(t)},IntervalSet.prototype.allIntervalsLength=function(){for(var t=0,e=0,i=this.intervals;e<i.length;e++){var n=i[e];t=Number(t+(n.end-n.start))}return t},IntervalSet.prototype.getIntervalAt=function(t){return this.intervals[t]},IntervalSet.prototype.addPair=function(t){if(!(t.start>t.end)){for(var e=0;e<this.intervals.length;){if(t.end<this.intervals[e].start)return void this.intervals.splice(e,0,t);t.start<=this.intervals[e].end?(t.start=Math.min(t.start,this.intervals[e].start),t.end=Math.max(t.end,this.intervals[e].end),this.intervals.splice(e,1)):e++}e===this.intervals.length&&this.intervals.push(t)}},IntervalSet.prototype.equals=function(t){if(!(t instanceof IntervalSet))return!1;if(t.intervals.length!==this.intervals.length)return!1;for(var e=0;e<this.intervals.length;e++)if(!this.intervals[e].equals(t.intervals[e]))return!1;return!0},IntervalSet}();t.IntervalSet=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){function JSProxy(e){this.mainManager=e,this.javascriptRequestMade=!1,this.javascriptNotified=!1,!t.MainManager.paramsObj.disableExternalInterface&&flash.external.ExternalInterface.available&&(e.stage.element.callAsFunction=flash.display.Stage.bind(this.callAsFunction,this)),e.stage.addEventListener(MouseEvents.MOUSE_WHEEL,flash.display.Stage.bind(this.playerMouseWheelHandler,this))}return JSProxy.isPlayingInBrowser=function(){return!0},JSProxy.prototype.addObject=function(e,i,n,a,r){e=t.Utils.adjustNasdToNasdaq(e),this.mainManager.addObject({_qname:e,_type:i,_date:n,_id:r,_letter:a})},JSProxy.prototype.removeLayerFromStyle=function(t,e){this.mainManager.layersManager.removeLayerFromStyle(t,e)},JSProxy.prototype.initIndicators=function(){this.shouldSkipExternalInterfaceCall()||t.Const.INDICATOR_ENABLED&&flash.external.ExternalInterface.call("google.finance.initTechnicals")},JSProxy.prototype.handleMouseWheel=function(t){this.mainManager.displayManager.mainController.handleMouseWheel(t)},JSProxy.prototype.logIntervalButtonClick=function(t){this.shouldSkipExternalInterfaceCall()||flash.external.ExternalInterface.call("_GF_click","","chs_in",t.replace(/\\/g,"\\\\"),"")},JSProxy.prototype.changePrimaryTicker=function(e,i,n){void 0===n&&(n=!1),e=t.Utils.adjustNasdToNasdaq(e),this.mainManager.changePrimaryTicker(e,i,n)},JSProxy.prototype.getIndicatorInstanceArray=function(e,i){try{for(var n=getDefinitionByName("com.google.finance.indicator."+e+"IndicatorLayer").getParameterNames(),a=[],r=1;r<i.length;){for(var o={},s=!0,l=0,h=n;l<h.length;l++){var c=h[l];r===i.length&&(s=!1),o[c]=i[r++]}s&&a.push(o)}return 0===a.length?a=t.Const.INDICATOR_PARAMETERS[e]:t.Const.INDICATOR_PARAMETERS[e]=a,a}catch(i){return t.Const.INDICATOR_PARAMETERS[e]}},JSProxy.prototype.importGVizData=function(e,i,n){var a=this.mainManager.layersManager.getFirstDataSource();a&&(a.indicators[i]||(a.indicators[i]=new t.Indicator),t.GVizFormatConverter.convertGVizData(e,n,a.data,a.indicators[i]))},JSProxy.prototype.updateLastPrice=function(e,i){var n=this.mainManager.layersManager.getFirstDataSource(),a=this.mainManager.displayManager;n&&this.updateLastPriceInDataSeries(e?n.afterHoursData:n.data,i)&&a.getDetailLevel()===t.Intervals.INTRADAY&&a.update(!0)},JSProxy.prototype.playerMouseWheelHandler=function(t){var e=t.deltaY<0?3:-3;this.handleMouseWheel(e),t.preventDefault(),t.stopPropagation()},JSProxy.prototype.firstDataIsHere=function(){this.shouldSkipExternalInterfaceCall()||this.javascriptNotified||(this.javascriptNotified=!0,flash.external.ExternalInterface.call("_firstDataIsHere"))},JSProxy.prototype.setChartFocus=function(t){this.shouldSkipExternalInterfaceCall()||flash.external.ExternalInterface.call("_setChartFocus",t)},JSProxy.prototype.resetChartHeight=function(t){this.shouldSkipExternalInterfaceCall()||flash.external.ExternalInterface.call("_setChartSize",t+"px")},JSProxy.prototype.setJsCurrentViewParam=function(t,e){this.shouldSkipExternalInterfaceCall()||flash.external.ExternalInterface.call("_setCurrentViewParam",encodeURIComponent(t),encodeURIComponent(e.toString()))},JSProxy.prototype.toggleIndicator=function(e,i){var n=this.mainManager.layersManager,a=this.mainManager.displayManager,r=i.split("*");if(-1!==t.Const.DEPENDENT_INDICATOR_NAMES.indexOf(e)||-1!==t.Const.VOLUME_DEPENDENT_INDICATOR_NAMES.indexOf(e)){var o=-1!==t.Const.DEPENDENT_INDICATOR_NAMES.indexOf(e)?t.Const.MAIN_VIEW_POINT_NAME:t.Const.BOTTOM_VIEW_POINT_NAME;Boolean(r[0])?(a.enableIndicatorConfig(e,!0),a.enableIndicatorLayer(e,o,!0),a.setIndicatorInstanceArray(e,this.getIndicatorInstanceArray(e,r))):(a.enableIndicatorConfig(e,!1),a.enableIndicatorLayer(e,o,!1))}else if(-1!==t.Const.INDEPENDENT_INDICATOR_NAMES.indexOf(e)){Boolean(r[0])?a.isIndicatorConfigEnabled(e)||(this.mainManager.layersManager.chartHeightInStyle[t.LayersManager.SINGLE]=this.mainManager.layersManager.chartHeightInStyle[t.LayersManager.SINGLE]+t.Const.TECHNICAL_INDICATOR_HEIGHT,a.enableIndicatorConfig(e,!0),n.unhideViewPoint(e,t.LayersManager.SINGLE),a.setIndicatorInstanceArray(e,this.getIndicatorInstanceArray(e,r)),t.Const.MOVIE_HEIGHT=this.mainManager.stage.stageHeight):a.isIndicatorConfigEnabled(e)&&(this.mainManager.layersManager.chartHeightInStyle[t.LayersManager.SINGLE]=this.mainManager.layersManager.chartHeightInStyle[t.LayersManager.SINGLE]-t.Const.TECHNICAL_INDICATOR_HEIGHT,a.enableIndicatorConfig(e,!1),n.hideViewPoint(e,t.LayersManager.SINGLE),t.Const.MOVIE_HEIGHT=this.mainManager.stage.stageHeight);var s=a.getMainViewPoint();s&&s.checkEvents(),a.update()}},JSProxy.prototype.removeCompareTo=function(e){this.mainManager.layersManager.getFirstDataSource()&&(e=t.Utils.adjustNasdToNasdaq(e),this.mainManager.removeCompareTo(e))},JSProxy.prototype.addCompareTo=function(e,i,n){void 0===n&&(n=!1),this.mainManager.layersManager.getFirstDataSource()&&(e=t.Utils.adjustNasdToNasdaq(e),this.mainManager.addCompareTo(e,i,n))},JSProxy.prototype.getData=function(e,i){this.shouldSkipExternalInterfaceCall()||(e=t.Utils.adjustNasdToNasdaq(e),this.javascriptRequestMade||(this.javascriptRequestMade=!0,flash.external.ExternalInterface.call("_sendAllDataToChart",encodeURIComponent(e),"flash")))},JSProxy.prototype.setLineStyle=function(e){if(this.mainManager.layersManager.getStyle()===t.LayersManager.SINGLE){var i=this.mainManager.displayManager,n=i.getEnabledChartLayer(),a=e+"ChartLayer";i.setEnabledChartLayer(""),i.mainController.toggleZoomIntervalButtons(n,a),i.setEnabledChartLayer(a),this.setJsCurrentViewParam("lineStyle",e)}},JSProxy.prototype.removeObject=function(e,i,n){e=t.Utils.adjustNasdToNasdaq(e),this.mainManager.removeObject(e,Number(i),n)},JSProxy.prototype.expandChart=function(){this.shouldSkipExternalInterfaceCall()||(flash.external.ExternalInterface.call("_expandChart"),flash.external.ExternalInterface.call("_GF_click","","chs_ec","",""))},JSProxy.prototype.addLayerToStyle=function(t,e){this.mainManager.layersManager.addLayerToStyle(t,e)},JSProxy.prototype.setParameter=function(e,i){var n=this.mainManager.layersManager,a=this.mainManager.displayManager;if(t.MainManager.paramsObj[e]=i,"displayNewsPins"===e&&(t.Const.DISPLAY_NEWS_PINS="true"===i),"displayVolume"===e&&(Boolean(i)?n.unhideViewPoint("BottomViewPoint","single"):n.hideViewPoint("BottomViewPoint","single"),a.windowResized(t.Const.MOVIE_WIDTH,t.Const.MOVIE_HEIGHT)),"displayExtendedHours"===e&&"false"!==t.MainManager.paramsObj.hasExtendedHours){Boolean(i)?a.setAfterHoursDisplay(!0):a.setAfterHoursDisplay(!1);var r=a.getMainViewPoint();r&&this.setJsCurrentViewParam("defaultDisplayMinutes",r.count);var o=n.getFirstDataSource();o&&this.setForceDisplayExtendedHours(o)}"minZoomDays"===e&&a.mainController.setMinDisplayDays(Number(i)),a.update()},JSProxy.prototype.addData=function(e,i,n,a,r){e=t.Utils.adjustNasdToNasdaq(e);var o=this.mainManager.dataManager,s=t.EventFactory.getEvent(t.ChartEventTypes.GET_DATA,e,t.ChartEventPriorities.OPTIONAL);o.addData(s,decodeURIComponent(n)),r&&o.addData(s,decodeURIComponent(r))},JSProxy.prototype.setJsChartType=function(t){this.shouldSkipExternalInterfaceCall()||flash.external.ExternalInterface.call("_setChartType",encodeURIComponent(t))},JSProxy.prototype.callAsFunction=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];switch(t){case"addCompareTo":this.addCompareTo.apply(this,e[0]);break;case"addLayerToStyle":this.addLayerToStyle.apply(this,e[0]);break;case"addObjectArray":this.addObjectArray.apply(this,e[0]);break;case"changePrimaryTicker":this.changePrimaryTicker.apply(this,e[0]);break;case"clearAllPins":this.clearAllPins.apply(this,e[0]);break;case"enableIndicator":this.toggleIndicator.apply(this,e[0]);break;case"handleMouseWheel":this.handleMouseWheel.apply(this,e[0]);break;case"htmlClicked":this.htmlClicked.apply(this,e[0]);break;case"removeCompareTo":this.removeCompareTo.apply(this,e[0]);break;case"removeLayerFromStyle":this.removeLayerFromStyle.apply(this,e[0]);break;case"setLineStyle":this.setLineStyle.apply(this,e[0]);break;case"setParameter":this.setParameter.apply(this,e[0]);break;case"updateLastPrice":this.updateLastPrice.apply(this,e[0]);break;case"importGVizData":this.importGVizData.apply(this,e[0])}},JSProxy.prototype.updateLastPriceInDataSeries=function(e,i){var n=e.getPointsInIntervalArray(t.Const.INTRADAY_INTERVAL),a=t.Utils.getLastRealPointIndex(n);if(a>=0){var r=n[a];return r.close=i,r.low=t.Utils.extendedMin(r.low,i),r.high=t.Utils.extendedMax(r.high,i),r.realtime=!0,!0}return!1},JSProxy.prototype.clearAllPins=function(e){e=t.Utils.adjustNasdToNasdaq(e),this.mainManager.clearAllPins(e)},JSProxy.prototype.removeObjectArray=function(e){t.Utils.adjustExchangeNameOfArray(e,"_quote"),this.mainManager.removeObjectArray(e)},JSProxy.prototype.shrinkChart=function(){this.shouldSkipExternalInterfaceCall()||(flash.external.ExternalInterface.call("_shrinkChart"),flash.external.ExternalInterface.call("_GF_click","","chs_sc","",""))},JSProxy.prototype.addObjectArray=function(e){var i=e;if(i)try{return t.Utils.adjustExchangeNameOfArray(i,"_quote"),t.MainManager.paramsObj.differentDividendCurrency=t.MainManager.paramsObj.differentDividendCurrency||t.Utils.hasDifferentDividendCurrency(t.MainManager.paramsObj.companyCurrency,i),void this.mainManager.addObjectArray(i)}catch(t){return}},JSProxy.prototype.shouldSkipExternalInterfaceCall=function(){return!JSProxy.isPlayingInBrowser()||!flash.external.ExternalInterface.available||t.MainManager.paramsObj.disableExternalInterface},JSProxy.prototype.HTMLnotify=function(t,e,i,n,a){void 0===a&&(a=!1),this.shouldSkipExternalInterfaceCall()||flash.external.ExternalInterface.call("_visibleChartRangeChanged",t,e,i,n,a)},JSProxy.prototype.htmlClicked=function(e,i){e=t.Utils.adjustNasdToNasdaq(e),this.mainManager.htmlClicked(e,i)},JSProxy.prototype.setForceDisplayExtendedHours=function(t){var e=0!==t.visibleExtendedHours.length();this.setJsCurrentViewParam("forceDisplayExtendedHours",e)},JSProxy.prototype.iClicked=function(t,e,i,n){this.shouldSkipExternalInterfaceCall()||(flash.external.ExternalInterface.call("_flashClicked",i),flash.external.ExternalInterface.call("_GF_click","","newspin"===e?"n-f-":"n-fp-",n?n.replace(/\\/g,"\\\\"):i,""),this.mainManager.htmlClicked(t,i,n))},JSProxy.prototype.logZoomButtonClick=function(t){this.shouldSkipExternalInterfaceCall()||flash.external.ExternalInterface.call("_GF_click","","chs_zl",t.replace(/\\/g,"\\\\"),"")},JSProxy}();t.JSProxy=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function LastDayLineLayer(){var t=null!==e&&e.apply(this,arguments)||this;return t.dashSize=7,t}return __extends(LastDayLineLayer,e),LastDayLineLayer.prototype.drawLine=function(e){var i=this.graphics;i.clear(),i.lineStyle(0,t.Const.LAST_DAY_CLOSE_LINE_COLOR,1);var n=this.dataSource.data.units,a=this.dataSource.data.days,r=n[a[a.length-2]],o=n[n.length-1];if(t.Const.INDICATOR_ENABLED){var s=r.getCloseLogValue(e.verticalScaling);if(s>e.maxPrice||s<e.minPrice)return}var l=this.viewPoint,h=l.getXPos(r),c=l.getXPos(o),u=l.getDetailLevel();if(h<this.viewPoint.maxx&&u===t.Intervals.INTRADAY){var d=this.getYPos(r,e),g=0;do{i.moveTo(h+g*this.dashSize,d),i.lineTo(h+(g+1)*this.dashSize,d),g=Number(g+2)}while(h+g*this.dashSize<c)}},LastDayLineLayer.prototype.getYPos=function(t,e){return this.viewPoint.miny+this.viewPoint.V_OFFSET+this.viewPoint.medPriceY-(t.getCloseLogValue(e.verticalScaling)-e.medPrice)*this.viewPoint.maxPriceRangeViewSize/e.maxPriceRange},LastDayLineLayer.prototype.renderLayer=function(t){this.drawLine(t)},LastDayLineLayer}(t.AbstractLayer);t.LastDayLineLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){return function LayerInfo(){}}();t.LayerInfo=e;var i=function(){return function LayerConfig(){}}();t.LayerConfig=i;var n=function(){function LayersManager(e,n){this.displayManager=e,this.mainManager=n,this.lineColors=[14432530,16750848,32768,4801228,10027161],this.comparedTickers=[],this.takenColors=[],this.dataSources=[],this.style_=LayersManager.SINGLE,this.fullRedrawWithNextData_=!1,this.refuseDataSources={},this.chartHeightInStyle={},this.config={},this.layers=[],this.displayManager.layersManager=this;var a=t.MainManager.paramsObj,r=t.Utils.decodeObjects(a.single_layers),o=t.Utils.decodeObjects(a.single_viewpoints);this.config[LayersManager.SINGLE]=new i,this.config[LayersManager.SINGLE].layers=r,this.config[LayersManager.SINGLE].viewpoints=o,this.config[LayersManager.SINGLE].hiddenViewpoints=[],this.config[LayersManager.SINGLE].lastMinute=0,this.separateHiddenViewPoints(this.config[LayersManager.SINGLE]);var s=t.Utils.decodeObjects(a.compare_layers),l=t.Utils.decodeObjects(a.compare_viewpoints);this.config[LayersManager.COMPARISON]=new i,this.config[LayersManager.COMPARISON].layers=s,this.config[LayersManager.COMPARISON].viewpoints=l,this.config[LayersManager.COMPARISON].hiddenViewpoints=[],this.config[LayersManager.COMPARISON].lastMinute=0,this.separateHiddenViewPoints(this.config[LayersManager.COMPARISON]),this.config[LayersManager.PERCENT]=new i,this.config[LayersManager.PERCENT].layers=t.Utils.decodeObjects(a.percent_layers),this.config[LayersManager.PERCENT].viewpoints=t.Utils.decodeObjects(a.percent_viewpoints),this.config[LayersManager.PERCENT].hiddenViewpoints=[],this.config[LayersManager.PERCENT].lastMinute=0,this.separateHiddenViewPoints(this.config[LayersManager.PERCENT]),this.chartHeightInStyle[LayersManager.SINGLE]=t.Const.MOVIE_HEIGHT,this.chartHeightInStyle[LayersManager.COMPARISON]=t.Const.MOVIE_HEIGHT,this.chartHeightInStyle[LayersManager.PERCENT]=t.Const.MOVIE_HEIGHT}return LayersManager.moveVolumeBelowPrice=function(e){var i=LayersManager.getViewPointIndex(t.Const.MAIN_VIEW_POINT_NAME,e,"name"),n=LayersManager.getViewPointIndex(t.Const.BOTTOM_VIEW_POINT_NAME,e,"name");if(i>=0&&n>=0&&n>i+1){var a=e[n];e.splice(n,1),e.splice(i+1,0,a)}},LayersManager.getViewPointIndex=function(t,e,i){for(var n=e.length-1;n>=0&&e[n][i]!==t;)n--;return n},LayersManager.prototype.removeLayerFromStyle=function(e,i){if(void 0!==this.config[i]){for(var n=-1,a=0;a<this.config[i].layers.length;a++)t.Utils.isSubset(e,this.config[i].layers[a])&&(n=a);-1!==n&&(this.config[i].layers.splice(n,1),-1!==(n=this.getLayerModelIndex(e))&&this.layers.splice(n,1),this.displayManager.removeLayer(this.getLayerId(e),e.vp))}},LayersManager.prototype.deleteDataSources=function(){this.dataSources.splice(1)},LayersManager.prototype.getNextColor=function(e){if(this.mainManager.quote===e)return t.Const.LINE_CHART_LINE_COLOR;for(var i=0,n=this.takenColors;i<n.length;i++){var a=n[i];if(a.quote===e)return a.color}for(var r=0,o=this.lineColors;r<o.length;r++){for(var s=o[r],l=!1,h=0;h<this.takenColors.length;h++)this.takenColors[h].color===s&&(l=!0),h++;if(!l)return this.takenColors.push({quote:e,color:s}),s}return 0},LayersManager.prototype.removeViewPoints=function(t,e){for(var i=0,n=t;i<n.length;i++){var a=n[i];-1===LayersManager.getViewPointIndex(a.name,e,"name")&&this.displayManager.removeViewPoint(a.name)}},LayersManager.prototype.applyStartEndToViewPoints=function(t){for(var e=0,i=this.displayManager.getViewPoints();e<i.length;e++){var n=i[e];n.lastMinute=t.end,n.setNewCount(t.end-t.start)}},LayersManager.prototype.addIndicatorLayer=function(e,i,n,a,r){switch(e){case"Volume":if(o=this.displayManager.addLayer(t.Const.VOLUME_CHART,n,a,i))return o.setIndicator("Volume",t.VolumeCalculator.computeInterval,a.data),o.lineColor=t.Const.LINE_CHART_LINE_COLOR,o;break;case"ECNVolume":if(o=this.displayManager.addLayer(t.Const.AH_VOLUME_LAYER,n,a,i))return o.setIndicator("AfterHoursVolume",t.VolumeCalculator.computeInterval,a.afterHoursData),o.lineColor=10066329,o;break;default:if(t.Const.INDICATOR_ENABLED){var o,s="indicator."+e+"IndicatorLayer";if(o=this.displayManager.addLayer(s,n,a,i))return o.setIndicator(e,a.data),o}}return null},LayersManager.prototype.getAnyLayerModelIndexForDatasource=function(t){for(var e=0;e<this.layers.length;e++)if(t===this.layers[e].ds)return e;return-1},LayersManager.prototype.syncDataSources=function(e,i,n){void 0===n&&(n=!1);var a=this.mainManager.dataManager,r=this.displayManager.mainController,o=this.displayManager.getMainViewPoint();this.updateColors(e),this.deleteDataSources();var s=this.displayManager.isDifferentMarketSessionComparison(),l=o.lastMinute,h=o.count,c=s;if(s&&!i?c=this.isDifferentMarketSessionComparison(e):i&&n&&(c=!0),this.displayManager.setDifferentMarketSessionComparison(c),0===e.length||1===e.length&&this.dataSources.length>0&&e[0]===this.dataSources[0].quoteName){this.setStyle(this.style_===LayersManager.PERCENT?LayersManager.PERCENT:LayersManager.SINGLE),(u=t.Const.INDICATOR_ENABLED?this.displayManager.getEnabledChartLayer():"")!==t.Const.CANDLE_STICK&&u!==t.Const.OHLC_CHART||(r.toggleZoomIntervalButtons(t.Const.LINE_CHART,u),Boolean(t.MainManager.paramsObj.displayExtendedHours)&&this.displayManager.toggleAllAfterHoursSessions(r.currentIntervalLevel===t.Intervals.INTRADAY))}else{var u;(u=t.Const.INDICATOR_ENABLED?this.displayManager.getEnabledChartLayer():"")!==t.Const.CANDLE_STICK&&u!==t.Const.OHLC_CHART||r.toggleZoomIntervalButtons(u,t.Const.LINE_CHART),this.setStyle(this.style_===LayersManager.PERCENT?LayersManager.PERCENT:LayersManager.COMPARISON);for(var d=0,g=e;d<g.length;d++){var p=g[d];if(a.hasNonEmptyDataSource(p)||a.dataUnavailableOnServer(p)){var v=a.dataSources[p];v.getRelativeMinutesState()!==t.DataSource.RELATIVE_MINUTES_READY&&this.displayManager.computeRelativeTimes(v),this.newData(v)}else this.mainManager.getQuote(p)}}var y=this.getFirstDataSource(),f=y?Number(y.data.marketDayLength+1):t.Const.MARKET_DAY_LENGTH;if(s&&!c){for(var T=0,I=e;T<I.length;T++){p=I[T];this.displayManager.computeRelativeTimes(this.mainManager.dataManager.dataSources[p])}r.resetZoomButtons(t.Const.MIN_DISPLAY_DAYS),r.jumpTo(l*f,h*f,!0),this.displayManager.HTMLnotify(t.Const.MAIN_VIEW_POINT_NAME)}else c&&(this.displayManager.computeRelativeTimesForDiffSessionComparison(),s||(r.resetZoomButtons(t.Const.DIF_MKT_COMPARISON_MIN_DISPLAY_DAYS),r.jumpTo(l/f,h/f,!0),this.displayManager.HTMLnotify(t.Const.MAIN_VIEW_POINT_NAME)));this.displayManager.showContextualStaticInfo()},LayersManager.prototype.getLayerId=function(t){switch(t.name){case"SimpleMovingAverage":return t.name+"-"+t.length;case"IndependentObjectsLayer":case"IntervalBasedIndependentObjectsLayer":return"Objects"+t.renderObj;default:return t.name}},LayersManager.prototype.removeAllLayers=function(t){for(var e=0,i=t;e<i.length;e++){i[e].removeAllLayers()}this.layers=[]},LayersManager.prototype.updateColors=function(t){if(0!==this.takenColors.length){var e=0;do{for(var i=!1,n=0,a=t;n<a.length;n++){a[n]===this.takenColors[e].quote&&(i=!0)}i?e++:this.takenColors.splice(e,1)}while(e<this.takenColors.length)}},LayersManager.prototype.removeCompareTo=function(e){var i=[],n=t.Utils.findValueInArray(e,this.comparedTickers);-1!==n&&(this.comparedTickers.splice(n,1),this.refuseDataSources[e]=!0),this.dataSources.length>0&&i.push(this.dataSources[0].quoteName),i=i.concat(this.comparedTickers),this.syncDataSources(i,!1)},LayersManager.prototype.getLayerModelIndex=function(t,e){for(var i=this.getLayerId(t),n=this.layers.length-1;n>=0;n--){var a=this.layers[n];if(this.getLayerId(a)===i&&a.vp===t.vp&&(!e||e===a.ds))return n}return-1},LayersManager.prototype.numComparedTickers=function(){return this.comparedTickers.length},LayersManager.prototype.addLayerToStyle=function(t,e){if(void 0===this.config[e]&&(this.config[e]=new i),void 0===this.config[e].layers&&(this.config[e].layers=[]),this.config[e].layers.push(t),this.style_===e)for(var n=0,a=this.dataSources;n<a.length;n++){var r=a[n];this.addLayer(t,r)}this.displayManager.update()},LayersManager.prototype.dataSourcePos=function(t){for(var e=0;e<this.dataSources.length;e++)if(this.dataSources[e]===t)return e;return 0},LayersManager.prototype.addLayer=function(i,n){if(-1===("Unique"===i.arity?Number(this.getLayerModelIndex(i)):"MultipleNonPrimary"===i.arity?Number(this.getAnyLayerModelIndexForDatasource(n)):Number(this.getLayerModelIndex(i,n)))){var a=null,r=this.getLayerId(i);switch(i.type){case"simple":a=this.displayManager.addLayer(i.name,i.vp,n,r);break;case"indicator":for(var o=new e,s=0,l=Object.keys(i);s<l.length;s++){"name"!==(d=l[s])&&"vp"!==d&&"arity"!==d&&"type"!==d&&(o[d]=i[d])}a=this.addIndicatorLayer(i.name,r,i.vp,n,o)}if(!a)return;"Multiple"!==i.arity&&"MultipleNonPrimary"!==i.arity&&"PrecalculatedPercentLineChartLayer"!==i.name||(a.lineColor=this.getNextColor(n.quoteName),a.lineThickness=t.Const.LINE_CHART_LINE_THICKNESS,a.lineVisibility=t.Const.LINE_CHART_LINE_VISIBILITY);var h=new e;h.name=i.name,h.type=i.type,h.vp=i.vp,h.layer=a,h.ds=n,h.id=r;for(var c=0,u=Object.keys(i);c<u.length;c++){var d;"name"!==(d=u[c])&&"vp"!==d&&"arity"!==d&&(a[d]=i[d],h[d]=i[d])}this.layers.push(h)}},LayersManager.prototype.isDifferentMarketSessionComparison=function(t){if(t.length<=1)return!1;var e=this.mainManager.dataManager.dataSources[t[0]];if(!e||e.isEmpty())return!1;for(var i=1;i<t.length;i++){var n=this.mainManager.dataManager.dataSources[t[i]];if(n&&!n.isEmpty()&&!e.data.dataSessions.equals(n.data.dataSessions))return!0}return!1},LayersManager.prototype.addCompareTo=function(e,i){void 0===i&&(i=!1);var n=[];-1===t.Utils.findValueInArray(e,this.comparedTickers)&&(this.comparedTickers.push(e),this.dataSources.length>0&&n.push(this.dataSources[0].quoteName),n=n.concat(this.comparedTickers),delete this.refuseDataSources[e],this.syncDataSources(n,!0,i),this.displayManager.getMainViewPoint().checkEvents())},LayersManager.prototype.figureOutDefaultLastMinute=function(t){var e=this.displayManager.getMainViewPoint();this.displayManager.setLastMinute(e.getNewestMinute())},LayersManager.prototype.addLayers=function(i){var n=t.Const.SPARKLINE_VIEW_POINT_NAME;if(i.quoteName===this.mainManager.quote){var a=new e;a.name=t.Const.WINDOW_LAYER,a.arity="Unique",a.type="simple",a.vp=n,this.displayManager.addLayer(t.Const.WINDOW_LAYER,n,i,this.getLayerId(a))}for(var r=0,o=this.config[this.style_].layers;r<o.length;r++){var s=o[r];this.addLayer(s,i)}},LayersManager.prototype.hideViewPoint=function(t,e){var i=this.config[e].viewpoints,n=this.config[e].hiddenViewpoints;this.moveViewPointBtArrays(t,i,n),this.setStyle(this.style_)},LayersManager.prototype.getComparedTickers=function(){return this.comparedTickers},LayersManager.prototype.unhideViewPoint=function(t,e){var i=this.config[e].viewpoints,n=this.config[e].hiddenViewpoints;this.moveViewPointBtArrays(t,n,i),this.setStyle(this.style_)},LayersManager.prototype.replaceFirstDataSource=function(t){this.dataSources[0]=t},LayersManager.prototype.getContextualStaticInfo=function(){for(var e={},i=this.displayManager.getViewPoints(),n=1;n<i.length;n++){var a=i[n];a.highlightPoint(t.Const.MOVIE_WIDTH,e),a.clearPointInformation()}return e},LayersManager.prototype.moveViewPointBtArrays=function(t,e,i){var n=LayersManager.getViewPointIndex(t,e,"name");-1!==n&&(i.push(e[n]),e.splice(n,1))},LayersManager.prototype.addViewPoints=function(t,e,i){for(var n=this.displayManager.getMainViewPoint(),a=0,r=t;a<r.length;a++){var o=r[a];if(-1===LayersManager.getViewPointIndex(o.name,e,"name"))this.displayManager.addViewPoint("ViewPoint",o.name,0,o.height,Number(o.topMargin),this.mainManager.stage.stageWidth,this.mainManager.stage.stageHeight,n);else this.displayManager.getViewPoint(o.name).topMargin=Number(o.topMargin)}},LayersManager.prototype.newData=function(e){if(this.haveDataSource(e))for(var i=0,n=this.displayManager.getViewPoints();i<n.length;i++){n[i].precomputeContexts()}else{if(this.refuseDataSources[e.quoteName])return void delete this.refuseDataSources[e.quoteName];if(e.isEmpty()||this.addLayers(e),e.isEmpty()&&0===this.dataSources.length)return this.displayManager.addLayer(LayersManager.NO_DATA_AVAILABLE_LAYER,t.Const.MAIN_VIEW_POINT_NAME,e,LayersManager.NO_DATA_AVAILABLE_LAYER),this.displayManager.addLayer(t.Const.WINDOW_LAYER,t.Const.SPARKLINE_VIEW_POINT_NAME,e,t.Const.WINDOW_LAYER),this.displayManager.makeBorderLayerTop(),void this.displayManager.update();if(e.quoteName===this.mainManager.quote&&0!==this.dataSources.length){var a=this.dataSources[0];this.dataSources[0]=e,this.dataSources.push(a)}else this.dataSources.push(e);if(0!==this.dataSources.length&&e.quoteName!==this.mainManager.quote||(this.figureOutDefaultLastMinute(e),this.applyStartEndToViewPoints(this.getDefaultZoomPair(e))),t.Const.INDICATOR_ENABLED&&e.quoteName===this.mainManager.quote&&t.Const.DEFAULT_CHART_STYLE_NAME!==t.Const.LINE_CHART&&this.displayManager.mainController.currentIntervalLevel===t.Intervals.INVALID){this.displayManager.mainController.enableIntervalButtons(t.Const.DEFAULT_D),this.displayManager.mainController.currentIntervalLevel=t.Const.DEFAULT_D;var r=0;if(!isNaN(t.MainManager.paramsObj.defaultEndTime)){var o=t.MainManager.paramsObj.defaultEndTime;if(o>0){var s=t.Const.getDetailLevelInterval(t.Const.DEFAULT_D),l=e.data.getPointsInIntervalArray(s),h=t.DataSource.getTimeIndex(o,l);-1!==h&&(r=Number(l[h].relativeMinutes))}}var c=t.Const.INTERVAL_PERIODS[t.Const.DEFAULT_D].days*(e.data.marketDayLength+1);-1!==t.Const.DEFAULT_DISPLAY_MINUTES&&(c=t.Const.DEFAULT_DISPLAY_MINUTES),this.displayManager.mainController.animateTo(r,c,1),t.MainManager.jsProxy.setJsCurrentViewParam("defaultDisplayInterval",t.Const.getDetailLevelInterval(t.Const.DEFAULT_D))}}e===this.getFirstDataSource()&&this.displayManager.mainController.syncZoomLevel(),this.fullRedrawWithNextData_?(this.fullRedrawWithNextData_=!1,this.setStyle(this.style_)):(this.displayManager.update(),this.displayManager.topBorderLayer.update())},LayersManager.prototype.haveDataSource=function(t){for(var e=0,i=this.dataSources;e<i.length;e++){if(i[e]===t)return!0}return!1},LayersManager.prototype.setStyle=function(e){t.Const.INDICATOR_ENABLED&&t.MainManager.jsProxy.resetChartHeight(this.chartHeightInStyle[e]);var i=this.config[e].viewpoints,n=this.displayManager.getViewPoints(),a=this.displayManager.getMainViewPoint();a.clearAllChildrenFromTopCanvas(),this.config[this.style_].lastMinute=a.lastMinute,this.style_=e,this.removeAllLayers(n.slice(1)),this.removeViewPoints(n.slice(1),i),this.displayManager.mainController.removeAllBounds(),this.addViewPoints(i,n,this.config[this.style_].lastMinute),LayersManager.moveVolumeBelowPrice(n),this.displayManager.makeBorderLayerTop();for(var r=0,o=this.dataSources;r<o.length;r++){var s=o[r];this.addLayers(s)}if(e===LayersManager.COMPARISON)this.displayManager.toggleAllAfterHoursSessions(!1);else if(e===LayersManager.SINGLE){var l=t.Const.INDICATOR_ENABLED?this.displayManager.getEnabledChartLayer():"";(this.displayManager.mainController.currentIntervalLevel!==t.Intervals.INVALID||l!==t.Const.CANDLE_STICK&&l!==t.Const.OHLC_CHART?t.Const.INDICATOR_ENABLED?a.getDetailLevelForTechnicalStyle():a.getDetailLevel():t.Const.DEFAULT_D)===t.Intervals.INTRADAY&&Boolean(t.MainManager.paramsObj.displayExtendedHours)&&this.displayManager.toggleAllAfterHoursSessions(!0)}this.displayManager.windowResized(this.displayManager.stage.stageWidth,this.displayManager.stage.stageHeight)},LayersManager.prototype.resetLayersForNewQuote=function(e,i){this.style_=i,this.fullRedrawWithNextData_=!0;for(var n=[],a=0,r=this.displayManager.getViewPoints();a<r.length;a++){var o=r[a];o.name===t.Const.MAIN_VIEW_POINT_NAME?n.push(o):o.name===t.Const.SPARKLINE_VIEW_POINT_NAME&&o.replaceSparklineDataSource(e)}this.removeAllLayers(n)},LayersManager.prototype.separateHiddenViewPoints=function(t){for(var e=t.viewpoints,i=t.hiddenViewpoints,n=0;n<e.length;n++)"hidden"===e[n].display&&(this.moveViewPointBtArrays(e[n].name,e,i),n--)},LayersManager.prototype.getDefaultZoomPair=function(e){var i=0,n=t.MainManager.paramsObj;if(void 0!==n.defaultEndTime&&!isNaN(n.defaultEndTime)){var a=Number(n.defaultEndTime);if(a>0){var r=t.DataSource.getTimeIndex(a,e.data.units),o=e.data.units[r];if(i=Number(o.relativeMinutes),e.data.minuteIsEndOfDataSession(o.dayMinute)&&e.afterHoursData&&e.afterHoursData.units.length>0){var s=t.DataSource.getTimeIndex(a,e.afterHoursData.units),l=e.afterHoursData.units[s].relativeMinutes;i<l&&(r===e.data.units.length-1||l<e.data.units[r+1].relativeMinutes)&&(i=Number(l))}}}var h=-1;return-1===h&&(h=-1!==t.Const.DEFAULT_DISPLAY_MINUTES?Number(t.Const.DEFAULT_DISPLAY_MINUTES):Number(this.displayManager.mainController.getCountForDays(e,t.Const.DEFAULT_DISPLAY_DAYS,0))),new t.StartEndPair(i-h,i)},LayersManager.prototype.getStyle=function(){return this.style_},LayersManager.prototype.getFirstDataSource=function(){return this.dataSources.length?this.dataSources[0]:null},LayersManager.NO_DATA_AVAILABLE_LAYER="NoDataAvailableLayer",LayersManager.PERCENT="percent",LayersManager.SINGLE="single",LayersManager.COMPARISON="compare",LayersManager}();t.LayersManager=n}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function LoadingMessage(){var t=e.call(this)||this;return t.intervalId=null,t.loadingText=new flash.text.TextField,t.currentState=-1,t.padding=3,t.backgroundColor=8439386,t.loadingText.defaultTextFormat=LoadingMessage.LOADING_TEXT_FORMAT,t.loadingText.autoSize=flash.text.TextFieldAutoSize.LEFT,t.loadingText.x=0,t.loadingText.y=0,t.rollMessage(),t.addChild(t.loadingText),t.drawBackground(),t}return __extends(LoadingMessage,e),LoadingMessage.prototype.rollMessage=function(){this.currentState=(this.currentState+1)%LoadingMessage.states.length,this.loadingText.text=t.Message.getMsg(t.Messages.LOADING_MESSAGE)+LoadingMessage.states[this.currentState]},LoadingMessage.prototype.drawBackground=function(){var t=this.graphics;t.beginFill(3381555,1),t.drawRect(0,0,this.loadingText.width,this.loadingText.height),t.endFill()},Object.defineProperty(LoadingMessage.prototype,"visible",{set:function(t){this.element.style.visibility=t?"":"hidden",t&&!this.intervalId?this.intervalId=setInterval(flash.display.Stage.bind(this.rollMessage,this),500):!t&&this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)},enumerable:!0,configurable:!0}),LoadingMessage.LOADING_TEXT_FORMAT=new flash.text.TextFormat("Helvetica",12,16777215),LoadingMessage.states=["...",".",".."],LoadingMessage}(flash.display.Sprite);t.LoadingMessage=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(e){var i=function(i){function MainManager(t){var n=i.call(this)||this;return n.firstDataNotified=!1,t.addChild(n),MainManager.paramsObj=window.loaderInfo.parameters,MainManager.jsProxy=new e.JSProxy(n),0===n.stage.stageWidth?n.waitSizeIntId=setInterval(flash.display.Stage.bind(n.checkSize,n),20):n.init(),n}return __extends(MainManager,i),MainManager.prototype.dataIsHere=function(t,i){if(!(t.countEvents(e.ChartEventPriorities.REQUIRED)+t.countEvents(e.ChartEventPriorities.EXPECTED)>0)){var n=this.displayManager.getDetailLevel();this.shouldToggleAfterHours(n)?this.displayManager.toggleAllAfterHoursSessions(!0,t):this.displayManager.toggleAllAfterHoursSessions(!1,t),Boolean(MainManager.paramsObj.forceDisplayExtendedHours)&&(MainManager.paramsObj.forceDisplayExtendedHours="false"),this.displayManager.isDifferentMarketSessionComparison()||this.displayManager.computeRelativeTimes(t),this.layersManager.getFirstDataSource()&&(this.dataManager.syncDataSources(t,this.displayManager),this.displayManager.mainController.syncZoomLevel()),this.displayManager.isDifferentMarketSessionComparison()&&this.displayManager.computeRelativeTimesForDiffSessionComparison(),this.layersManager.newData(t),!1===this.firstDataNotified&&(this.firstDataNotified=!0,MainManager.jsProxy.firstDataIsHere(),this.displayManager.HTMLnotify(e.Const.MAIN_VIEW_POINT_NAME))}},MainManager.prototype.parseSettingString=function(t,e){var i=t?t.split(";"):null;if(!i||i.length!==e)return null;for(var n=0;n<i.length;n++)""===i[n]&&(i[n]=null);return i},MainManager.prototype.needAfterHoursData=function(t){return t===this.quote&&(Boolean(MainManager.paramsObj.forceDisplayExtendedHours)||Boolean(MainManager.paramsObj.displayExtendedHours))?e.EventFactory.getEvent(e.ChartDetailTypes.GET_AH_DATA,t,e.ChartEventPriorities.REQUIRED):null},MainManager.prototype.init=function(){this.stage.align=flash.display.StageAlign.TOP_LEFT,this.stage.scaleMode=flash.display.StageScaleMode.NO_SCALE,this.stage.addEventListener(Events.RESIZE,flash.display.Stage.bind(this.onResize,this)),e.Const.MOVIE_HEIGHT=this.stage.stageHeight,e.Const.MOVIE_WIDTH=this.stage.stageWidth,this.quote=MainManager.paramsObj.q||e.Const.DEFAULT_Q,this.quoteType=e.Const.getQuoteType(this.quote),this.startTime=MainManager.paramsObj.startTime||NaN,this.endTime=MainManager.paramsObj.endTime||NaN,this.weekdayBitmap=MainManager.paramsObj.weekdayBitmap||e.Const.DEFAULT_WEEKDAY_BITMAP;var t=window.loaderInfo.url,i=t.substring(0,t.indexOf("/finance/"));MainManager.paramsObj.u?-1===MainManager.paramsObj.u.indexOf("/finance/")?this.url=i+"/finance/"+MainManager.paramsObj.u:this.url=i+MainManager.paramsObj.u.substring(MainManager.paramsObj.u.indexOf("/finance/")):(this.url="about:blank",console.log("ERROR: No URL was provided!")),this.stickyArgs=void 0===MainManager.paramsObj.sa?"":MainManager.paramsObj.sa,MainManager.console=new e.Console(this),this.checkParameters(),this.displayManager=new e.DisplayManager(this),this.addChild(this.displayManager),this.addChild(MainManager.console),this.dataManager=new e.DataManager(this,this.startTime,this.endTime),this.displayManager.init(this.stage.stageWidth,this.stage.stageHeight),this.layersManager=new e.LayersManager(this.displayManager,this);var n=MainManager.paramsObj.compareTo&&MainManager.paramsObj.compareToDiffMarketSessions&&-1!==MainManager.paramsObj.compareToDiffMarketSessions.indexOf("1");this.getQuote(this.quote,MainManager.paramsObj.displayName,e.Const.getDefaultDisplayDays(n),!0),this.addDefaultCompareToTickers(),MainManager.mouseCursor=new e.MouseCursor,this.addChild(MainManager.mouseCursor),MainManager.mouseCursor.initListeners(),MainManager.jsProxy.initIndicators(),flash.display.Graphics.cleanupPending()},MainManager.prototype.checkParameters=function(){var i=MainManager.paramsObj.lineStyle||"IntervalBasedLine";e.Const.DEFAULT_CHART_STYLE_NAME=i+"ChartLayer",e.Const.INTRADAY_INTERVAL=MainManager.paramsObj.intradayInterval||e.Const.INTRADAY_INTERVAL,e.Const.MIN_DISPLAY_DAYS=MainManager.paramsObj.minZoomDays||e.Const.MIN_DISPLAY_DAYS,e.Const.DEFAULT_DISPLAY_DAYS=MainManager.paramsObj.defaultZoomDays||e.Const.DEFAULT_DISPLAY_DAYS,MainManager.paramsObj.defaultDisplayInterval?e.Const.DEFAULT_D=e.Const.getIntervalDetailLevel(MainManager.paramsObj.defaultDisplayInterval):MainManager.paramsObj.defaultInterval&&(e.Const.DEFAULT_D=e.Const.getIntervalDetailLevel(MainManager.paramsObj.defaultInterval)),e.Const.DEFAULT_DISPLAY_MINUTES=MainManager.paramsObj.defaultDisplayMinutes||e.Const.DEFAULT_DISPLAY_MINUTES,e.Const.DEFAULT_DISPLAY_DAYS<e.Const.MIN_DISPLAY_DAYS&&(e.Const.DEFAULT_DISPLAY_DAYS=e.Const.MIN_DISPLAY_DAYS),MainManager.paramsObj.sparklineType=MainManager.paramsObj.sparklineType||e.Const.DYNAMIC,MainManager.paramsObj.snapping=e.Utils.checkUndefined(MainManager.paramsObj.snapping,"true"),MainManager.paramsObj.displayExtendedHours=e.Utils.checkUndefined(MainManager.paramsObj.displayExtendedHours,"true"),MainManager.paramsObj.hasExtendedHours=e.Utils.checkUndefined(MainManager.paramsObj.hasExtendedHours,"false"),MainManager.paramsObj.displayExtendedHours=e.Utils.checkUndefined(MainManager.paramsObj.displayExtendedHours,"false"),Boolean(MainManager.paramsObj.hasExtendedHours)||(MainManager.paramsObj.displayExtendedHours="false"),e.Const.INFO_TEXT_ALIGN=MainManager.paramsObj.infoTextAlign||e.Const.INFO_TEXT_ALIGN,e.Const.INFO_TEXT_TOP_PADDING=MainManager.paramsObj.infoTextTopPadding||e.Const.INFO_TEXT_TOP_PADDING,e.Const.DISPLAY_DIVIDENDS_UNITS=MainManager.paramsObj.displayDividendsUnits||e.Const.DISPLAY_DIVIDENDS_UNITS,e.Const.POSITIVE_DIFFERENCE_COLOR=MainManager.paramsObj.positiveColor||e.Const.POSITIVE_DIFFERENCE_COLOR,e.Const.NEGATIVE_DIFFERENCE_COLOR=MainManager.paramsObj.negativeColor||e.Const.NEGATIVE_DIFFERENCE_COLOR,e.Const.ENABLE_CUSTOM_DATE_ENTRY=e.Utils.checkUndefined(MainManager.paramsObj.enableCustomDateEntry,"false"),e.Const.ENABLE_COMPACT_FLAGS=e.Utils.checkUndefined(MainManager.paramsObj.enableCompactFlags,"true"),e.Const.INDICATOR_ENABLED="true"===String(e.Utils.checkUndefined(MainManager.paramsObj.enableIndicator,!1)),e.Const.REALTIME_CHART_ENABLED="true"===String(e.Utils.checkUndefined(MainManager.paramsObj.enableRealtimeChart,!1)),void 0!==MainManager.paramsObj.displayNewsPins&&(e.Const.DISPLAY_NEWS_PINS="true"===String(MainManager.paramsObj.displayNewsPins)),e.Const.INDICATOR_ENABLED&&(e.Const.SPARKLINE_HEIGHT-=20),e.Const.VOLUME_PLUS_ENABLED="true"===String(e.Utils.checkUndefined(MainManager.paramsObj.enableVolumePlus,e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale()))),e.Const.CHART_TYPE_BUTTONS_ENABLED="true"===String(e.Utils.checkUndefined(MainManager.paramsObj.enableChartTypeButtons,e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale()))),e.Const.APPLY_CHINESE_STYLE_MACD="true"===String(e.Utils.checkUndefined(MainManager.paramsObj.applyChineseStyleMacd,t.i18n.locale.DateTimeLocale.getLocale()===e.Const.ZH_CN_LOCALE)),e.Const.EXPAND_BUTTON_ENABLED="true"===String(e.Utils.checkUndefined(MainManager.paramsObj.expandButtonEnabled,!1)),e.Const.SHRINK_BUTTON_ENABLED="true"===String(e.Utils.checkUndefined(MainManager.paramsObj.shrinkButtonEnabled,!1)),void 0!==MainManager.paramsObj.lclc&&(e.Const.LINE_CHART_LINE_COLOR=MainManager.paramsObj.lclc),void 0!==MainManager.paramsObj.lcfc&&(e.Const.LINE_CHART_FILL_COLOR=MainManager.paramsObj.lcfc),void 0!==MainManager.paramsObj.salc&&(e.Const.SPARK_ACTIVE_LINE_COLOR=MainManager.paramsObj.salc),void 0!==MainManager.paramsObj.safc&&(e.Const.SPARK_ACTIVE_FILL_COLOR=MainManager.paramsObj.safc),void 0!==MainManager.paramsObj.silc&&(e.Const.SPARK_INACTIVE_LINE_COLOR=MainManager.paramsObj.silc),void 0!==MainManager.paramsObj.sifc&&(e.Const.SPARK_INACTIVE_FILL_COLOR=MainManager.paramsObj.sifc),void 0!==MainManager.paramsObj.tbg&&(e.Const.TEXT_BACKGROUND_COLOR=MainManager.paramsObj.tbg),void 0!==MainManager.paramsObj.rtc&&(e.Const.RANGE_TEXT_COLOR=MainManager.paramsObj.rtc),void 0!==MainManager.paramsObj.dc&&(e.Const.DOT_COLOR=MainManager.paramsObj.dc),void 0!==MainManager.paramsObj.vc&&(e.Const.VOLUME_HIGHLIGHT_COLOR=MainManager.paramsObj.vc),void 0!==MainManager.paramsObj.ecnlc&&(e.Const.ECN_LINE_CHART_LINE_COLOR=MainManager.paramsObj.ecnlc),void 0!==MainManager.paramsObj.ecnfc&&(e.Const.ECN_LINE_CHART_FILL_COLOR=MainManager.paramsObj.ecnfc)},MainManager.prototype.removeCompareTo=function(t){this.layersManager.removeCompareTo(t)},MainManager.prototype.addCompareTo=function(t,e,i){void 0===i&&(i=!1),this.dataManager.checkDataSourceExistance(t,e),this.layersManager.addCompareTo(t,i)},MainManager.prototype.getQuoteType=function(){return this.quoteType},MainManager.prototype.checkSize=function(){0!==this.stage.stageWidth&&(clearInterval(this.waitSizeIntId),this.init())},MainManager.prototype.clearAllPins=function(t){this.dataManager.clearAllObjects(t,"newspin"),this.displayManager.getMainViewPoint().updateObjectLayers()},MainManager.prototype.removeObjectArray=function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];this.dataManager.removeObject(n._quote,n._type,n._id.toString())}this.displayManager.getMainViewPoint().updateObjectLayers()},MainManager.prototype.addObject=function(t){this.dataManager.addObject(t),this.displayManager.getMainViewPoint().updateObjectLayers()},MainManager.prototype.addDefaultCompareToTickers=function(){if(""!==this.quote&&MainManager.paramsObj.compareTo)for(var t=MainManager.paramsObj.compareTo.split(";"),i=this.parseSettingString(MainManager.paramsObj.compareToDisplayName,t.length),n=this.parseSettingString(MainManager.paramsObj.compareToDiffMarketSessions,t.length),a=0;a<t.length;a++){var r=e.Utils.adjustNasdToNasdaq(t[a]);""!==r&&r!==this.quote&&this.addCompareTo(r,i&&i[a]||void 0,n&&"1"===n[a]||void 0)}},MainManager.prototype.getQuote=function(t,i,n,a){var r;void 0===n&&(n=NaN),void 0===a&&(a=!1);var o=notnull(this.displayManager.getMainViewPoint()),s=this.layersManager.getFirstDataSource();this.dataManager.checkDataSourceExistance(t,i),r=isNaN(n)?!isNaN(o.count)&&s?o.count/(this.displayManager.isDifferentMarketSessionComparison()?1:s.data.marketDayLength):e.Const.getDefaultDisplayDays():n,e.Const.INDICATOR_ENABLED&&e.Const.DEFAULT_CHART_STYLE_NAME!==e.Const.LINE_CHART&&this.layersManager.getStyle()===e.LayersManager.SINGLE?this.getQuoteForBarChart(t,r,a):this.getQuoteForLineChart(t,r,a)},MainManager.prototype.getQuoteForBarChart=function(t,i,n){var a,r=e.EventFactory.getEvent(e.ChartDetailTypes.GET_5D_DATA,t,e.ChartEventPriorities.REQUIRED);a=MainManager.paramsObj.sparklineType===e.Const.STATIC||i>e.Const.SCALE_INTERVALS[e.ScaleTypes.SCALE_1Y].days?e.EventFactory.getEvent(e.ChartDetailTypes.GET_40Y_DATA,t,e.ChartEventPriorities.REQUIRED):e.EventFactory.getEvent(e.ChartDetailTypes.GET_5Y_DATA,t,e.ChartEventPriorities.REQUIRED);var o=null,s=null;switch(e.Const.DEFAULT_D){case e.Intervals.INTRADAY:s=this.needAfterHoursData(t);break;case e.Intervals.FIVE_MINUTES:o=e.EventFactory.getEvent(e.ChartDetailTypes.GET_1Y_DATA,t,e.ChartEventPriorities.REQUIRED),s=e.EventFactory.getEvent(e.ChartDetailTypes.GET_10D_DATA,t,e.ChartEventPriorities.REQUIRED);break;case e.Intervals.HALF_HOUR:o=e.EventFactory.getEvent(e.ChartDetailTypes.GET_1Y_DATA,t,e.ChartEventPriorities.REQUIRED),s=e.EventFactory.getEvent(e.ChartDetailTypes.GET_30D_DATA,t,e.ChartEventPriorities.REQUIRED);break;case e.Intervals.DAILY:s=e.EventFactory.getEvent(e.ChartDetailTypes.GET_1Y_DATA,t,e.ChartEventPriorities.REQUIRED)}this.dataManager.expectEvent(r),this.dataManager.expectEvent(o),this.dataManager.expectEvent(a),this.dataManager.expectEvent(s),this.dataManager.eventHandler(r,!n),this.dataManager.eventHandler(o,!n),this.dataManager.eventHandler(a,!n),this.dataManager.eventHandler(s,!n)},MainManager.prototype.shouldToggleAfterHours=function(t){return!!Boolean(MainManager.paramsObj.forceDisplayExtendedHours)||"true"===MainManager.paramsObj.displayExtendedHours&&this.layersManager.getStyle()===e.LayersManager.SINGLE&&!!(t===e.Intervals.INTRADAY||e.Const.INDICATOR_ENABLED&&t<e.Intervals.DAILY&&this.displayManager.getEnabledChartLayer()===e.Const.LINE_CHART)},MainManager.prototype.changePrimaryTicker=function(t,i,n){void 0===n&&(n=!1);var a=String(e.Utils.checkUndefined(t,this.quote));if(a!==this.quote){this.quote=a,this.quoteType=e.Const.getQuoteType(this.quote),this.dataManager.checkDataSourceExistance(this.quote,i),this.layersManager.replaceFirstDataSource(this.dataManager.dataSources[this.quote]);var r=this.layersManager.numComparedTickers()>0?e.LayersManager.COMPARISON:e.LayersManager.SINGLE,o=n?e.LayersManager.PERCENT:r;this.layersManager.resetLayersForNewQuote(this.dataManager.dataSources[this.quote],o),this.dataManager.dataSources[this.quote].isEmpty()?this.getQuote(this.quote,i):(this.layersManager.setStyle(o),this.displayManager.update())}},MainManager.prototype.removeObject=function(t,e,i){this.dataManager.removeObject(t,e,i),this.displayManager.getMainViewPoint().updateObjectLayers()},MainManager.prototype.getQuoteForLineChart=function(t,i,n){var a=null,r=null,o=null,s=null,l=null;i>e.Const.INTRADAY_DAYS?(r=e.EventFactory.getEvent(e.ChartDetailTypes.GET_1Y_DATA,t,e.ChartEventPriorities.REQUIRED),e.Const.INDICATOR_ENABLED&&this.quoteType!==e.QuoteTypes.COMPANY||(a=e.EventFactory.getEvent(e.ChartDetailTypes.GET_5D_DATA,t,e.ChartEventPriorities.REQUIRED),this.dataManager.expectEvent(a))):r=this.quoteType===e.QuoteTypes.MUTUAL_FUND?e.EventFactory.getEvent(e.ChartDetailTypes.MUTF_5D_DATA,t,e.ChartEventPriorities.REQUIRED):e.EventFactory.getEvent(e.ChartDetailTypes.GET_5D_DATA,t,e.ChartEventPriorities.REQUIRED),this.layersManager.getStyle()===e.LayersManager.SINGLE&&e.Const.INDICATOR_ENABLED&&this.quoteType===e.QuoteTypes.COMPANY&&(i<=e.Const.HALF_HOUR_DAYS&&i>e.Const.FIVE_MINUTE_DAYS&&(l=e.EventFactory.getEvent(e.ChartDetailTypes.GET_30D_DATA,t,e.ChartEventPriorities.REQUIRED)),i<=e.Const.FIVE_MINUTE_DAYS&&i>e.Const.INTRADAY_DAYS&&(l=e.EventFactory.getEvent(e.ChartDetailTypes.GET_10D_DATA,t,e.ChartEventPriorities.REQUIRED))),o=MainManager.paramsObj.sparklineType===e.Const.STATIC||i>e.Const.SCALE_INTERVALS[e.ScaleTypes.SCALE_1Y].days?e.EventFactory.getEvent(e.ChartDetailTypes.GET_40Y_DATA,t,e.ChartEventPriorities.REQUIRED):e.EventFactory.getEvent(e.ChartDetailTypes.GET_5Y_DATA,t,e.ChartEventPriorities.REQUIRED),e.Const.INDICATOR_ENABLED?i<=e.Const.HALF_HOUR_DAYS&&(s=this.needAfterHoursData(t)):s=this.needAfterHoursData(t),this.dataManager.expectEvent(r),this.dataManager.expectEvent(l),this.dataManager.expectEvent(o),this.dataManager.expectEvent(s),this.dataManager.eventHandler(a,!n),this.dataManager.eventHandler(r,!n),this.dataManager.eventHandler(l,!n),this.dataManager.eventHandler(o,!n),this.dataManager.eventHandler(s,!n)},MainManager.prototype.onResize=function(t){0!==this.stage.stageWidth&&(e.Const.MOVIE_WIDTH=this.stage.stageWidth),0!==this.stage.stageHeight&&(e.Const.MOVIE_HEIGHT=this.stage.stageHeight),0!==e.Const.MOVIE_WIDTH&&0!==this.stage.stageWidth&&(this.displayManager.windowResized(e.Const.MOVIE_WIDTH,e.Const.MOVIE_HEIGHT),MainManager.console.positionLoadingMessage(),this.displayManager.getMainViewPoint().checkEvents())},MainManager.prototype.addObjectArray=function(t){var e=0,i=t;if(0!==i.length){try{e=0;for(var n=null;e<i.length;)(n=i[e])&&this.dataManager.addObject(n),e++;n=i[0],this.dataManager.sortObjects(n._quote,n._type)}catch(t){}this.displayManager.getMainViewPoint().updateObjectLayers()}},MainManager.prototype.htmlClicked=function(t,e,i){var n=this.dataManager.selectObject(t,"newspin",e,i);this.displayManager.getMainViewPoint().updateObjectLayers(),this.displayManager.animateToSelectedPin(n)},MainManager}(flash.display.Sprite);e.MainManager=i}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){function StartEndPair(t,e){this.start=t,this.end=e}return StartEndPair.prototype.toString=function(){return"["+this.start+", "+this.end+"]"},StartEndPair.prototype.equals=function(t){return t instanceof StartEndPair&&(this.start===t.start&&this.end===t.end)},StartEndPair}();t.StartEndPair=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function MarketSessionPair(e,i,n){var a=t.call(this,e,i)||this;return a.name=n,a}return __extends(MarketSessionPair,t),MarketSessionPair.prototype.toString=function(){return"["+this.start+", "+this.end+", "+this.name+"]"},MarketSessionPair.prototype.equals=function(e){return e instanceof MarketSessionPair&&(this.name===e.name&&t.prototype.equals.call(this,e))},MarketSessionPair}(t.StartEndPair);t.MarketSessionPair=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e;!function(t){t[t.H_ARROWS=4]="H_ARROWS",t[t.OPENED_HAND=2]="OPENED_HAND",t[t.HIDDEN=0]="HIDDEN",t[t.CLASSIC=1]="CLASSIC",t[t.V_ARROWS=5]="V_ARROWS",t[t.CLOSED_HAND=3]="CLOSED_HAND"}(e=t.MouseCursors||(t.MouseCursors={}));var i=function(t){function MouseCursor(){var i=t.call(this)||this;return i.currentType=e.CLASSIC,i.mouseEnabled=!1,i.setCursor(e.OPENED_HAND),i}return __extends(MouseCursor,t),MouseCursor.prototype.onMouseLeave=function(t){this.setCursor(e.CLASSIC)},MouseCursor.prototype.initListeners=function(){},MouseCursor.prototype.lockOnDisplayObject=function(t){this.displayObjectLockedOn=t},MouseCursor.prototype.setCursor=function(t){switch(t){default:case e.CLASSIC:this.element.style.cursor="auto";break;case e.HIDDEN:this.element.style.cursor="none";break;case e.OPENED_HAND:this.element.style.cursor="grab";break;case e.CLOSED_HAND:this.element.style.cursor="grabbing";break;case e.H_ARROWS:this.element.style.cursor="ew-resize"}},MouseCursor.prototype.unlock=function(){this.displayObjectLockedOn=null},MouseCursor.prototype.onMouseMove=function(t){this.cursor.x=this.mouseX-this.cursor.width/2,this.cursor.y=this.mouseY-this.cursor.height/2},MouseCursor.DRAGGABLE_CURSOR=e.OPENED_HAND,MouseCursor}(flash.display.Sprite);t.MouseCursor=i}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function MouseCursor_CursorClosedHand(){return null!==t&&t.apply(this,arguments)||this}return __extends(MouseCursor_CursorClosedHand,t),MouseCursor_CursorClosedHand}(flash.display.Bitmap);t.MouseCursor_CursorClosedHand=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function MouseCursor_CursorHorizontalArrows(){return null!==t&&t.apply(this,arguments)||this}return __extends(MouseCursor_CursorHorizontalArrows,t),MouseCursor_CursorHorizontalArrows}(flash.display.Bitmap);t.MouseCursor_CursorHorizontalArrows=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function MouseCursor_CursorOpenedHand(){return null!==t&&t.apply(this,arguments)||this}return __extends(MouseCursor_CursorOpenedHand,t),MouseCursor_CursorOpenedHand}(flash.display.Bitmap);t.MouseCursor_CursorOpenedHand=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function NoDataAvailableLayer(){return null!==e&&e.apply(this,arguments)||this}return __extends(NoDataAvailableLayer,e),NoDataAvailableLayer.prototype.renderLayer=function(e){this.text||(this.text=new flash.text.TextField,this.text.defaultTextFormat=new flash.text.TextFormat("Arial",12,0,!1,!1,!1),this.text.autoSize=flash.text.TextFieldAutoSize.CENTER,this.text.selectable=!1,this.text.text=t.Message.getMsg(t.Messages.NO_DATA_AVAILABLE)),this.contains(this.text)&&this.removeChild(this.text),this.text.x=(this.viewPoint.maxx-this.viewPoint.minx)/2-this.text.width/2,this.text.y=(this.viewPoint.maxy-this.viewPoint.miny)/2,this.addChild(this.text)},NoDataAvailableLayer}(t.AbstractLayer);t.NoDataAvailableLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function OhlcChartLayer(){return null!==t&&t.apply(this,arguments)||this}return __extends(OhlcChartLayer,t),OhlcChartLayer.prototype.drawBarAtDataUnit=function(t,e,i){var n=e[i];if(!n.fake){var a=isNaN(n.weeklyXPos)?this.viewPoint.getXPos(n):n.weeklyXPos,r=this.getOhlcYPos(t,n),o=this.getOhlcColor(n,e[Math.max(i-1,0)]),s=this.graphics;if(s.lineStyle(1,o),Math.abs(r.highY-r.lowY)<=1){var l=(r.highY+r.lowY)/2;0===this.barWidth?(s.moveTo(a,l-.5),s.lineTo(a,l+.5)):(s.moveTo(a-this.barWidth/2,l),s.lineTo(a+this.barWidth/2,l))}else s.moveTo(a-this.barWidth/2,r.openY),s.lineTo(a,r.openY),s.moveTo(a,r.closeY),s.lineTo(a+this.barWidth/2,r.closeY),s.moveTo(a,r.highY),s.lineTo(a,r.lowY)}},OhlcChartLayer}(t.IntervalBasedBarChartLayer);t.OhlcChartLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e;!function(t){t[t.RIGHT_ORIENTATION=0]="RIGHT_ORIENTATION",t[t.LEFT_ORIENTATION=1]="LEFT_ORIENTATION"}(e=t.PinOrientations||(t.PinOrientations={}));var i=function(i){function PinPointMovie(){var e=i.call(this)||this;return e.initImageClasses(),e.initFlagComponents(),PinPointMovie.activeTextFormat.color=16777215,PinPointMovie.passiveTextFormat.color=4473924,PinPointMovie.overPassiveTextFormat.color=0,PinPointMovie.overActiveTextFormat.color=15658734,e.pinButton.addEventListener(MouseEvents.MOUSE_DOWN,function(i){if(!e.object)throw new Error;e.object.active?(e.object.active=!1,e.object.forceExpandInGroup=!0,e.pinPointContentMovie.clearMovie()):t.MainManager.jsProxy.iClicked(e.object.qname,e.getPinPointType(),e.object.id,e.object.letter)}),e.pinButton.addEventListener(MouseEvents.MOUSE_OVER,function(i){t.MainManager.mouseCursor.setCursor(t.MouseCursors.CLASSIC),t.MainManager.mouseCursor.lockOnDisplayObject(e.pinButton),e.letter.defaultTextFormat=e.object&&e.object.active?PinPointMovie.overActiveTextFormat:PinPointMovie.overPassiveTextFormat}),e.pinButton.addEventListener(MouseEvents.MOUSE_OUT,function(i){t.MainManager.mouseCursor.unlock(),e.letter.defaultTextFormat=e.object&&e.object.active?PinPointMovie.activeTextFormat:PinPointMovie.passiveTextFormat}),e}return __extends(PinPointMovie,i),PinPointMovie.prototype.getPinPointType=function(){return"newspin"},PinPointMovie.prototype.setCount=function(t){t=Math.min(t,PinPointMovie.MAX_SHOWN_GROUP_COUNT);var e=0;if(this.borders.length>t-1){for(e=t-1;e<this.borders.length;){try{this.removeChild(this.borders[e])}catch(t){}e++}this.borders.splice(t-1,this.borders.length-t+1)}else if(this.borders.length<t-1)for(e=this.borders.length;e<t-1;){var i=new this.ExtraFlagBorder;i.x=0,this.borders.push(i),this.addChild(i),e++}},PinPointMovie.prototype.initFlagComponents=function(){this.pinButton=new flash.display.SimpleButton("pinButton");var t=new this.FlagImg,e=new this.FlagOverImg;this.pinButton.overState=e,this.pinButton.downState=e,this.pinButton.hitTestState=t,this.pinButton.upState=t,this.pinButton.useHandCursor=!0,this.addChild(this.pinButton),this.flagline=new this.FlagPoleImg,this.flagline.x=-1,this.addChildAt(this.flagline,0),this.letter=new flash.text.TextField,this.letter.autoSize="left",this.letter.selectable=!1,this.letter.defaultTextFormat=PinPointMovie.letterTextFormat,this.letter.mouseEnabled=!1,this.addChild(this.letter),this.activeOverlay=new this.FlagActiveImg,this.borders=[]},PinPointMovie.prototype.setPinPointContentMovie=function(t){this.pinPointContentMovie=t},PinPointMovie.prototype.setOrientation=function(t){if(t===e.LEFT_ORIENTATION){this.activeOverlay.scaleX=-1,this.activeOverlay.x=1,this.pinButton.scaleX=-1,this.pinButton.x=1,this.flagline.x=-2,this.letter.x=-14;for(var i=0,n=this.borders;i<n.length;i++){n[i].scaleX=-1}}else{this.activeOverlay.scaleX=1,this.activeOverlay.x=-1,this.pinButton.scaleX=1,this.pinButton.x=-1,this.flagline.x=-1,this.letter.x=3;for(var a=0,r=this.borders;a<r.length;a++){r[a].scaleX=1}}},PinPointMovie.prototype.setHeight=function(t){this.flagline.height=t-2,this.flagline.y=2-t,this.letter.y=-t,this.pinButton.y=-t,this.activeOverlay.y=-t;for(var e=0;e<this.borders.length;e++)this.borders[e].y=this.pinButton.y+this.pinButton.height-4+2*e,this.borders[e].y=Math.min(-this.borders[e].height,this.borders[e].y)},PinPointMovie.prototype.getHeight=function(){return-this.pinButton.y},PinPointMovie.prototype.setObj=function(t){this.object=t,this.letter.text!==t.letter&&(this.letter.text=t.letter),t.active?(this.contains(this.activeOverlay)||(this.activeOverlay.x=this.pinButton.x,this.activeOverlay.y=this.pinButton.y,this.addChildAt(this.activeOverlay,this.numChildren-1)),this.letter.setTextFormat(PinPointMovie.activeTextFormat)):(this.contains(this.activeOverlay)&&this.removeChild(this.activeOverlay),this.letter.setTextFormat(PinPointMovie.passiveTextFormat))},PinPointMovie.prototype.initImageClasses=function(){this.FlagImg=t.PinPointMovie_LocalFlagImg,this.FlagOverImg=t.PinPointMovie_LocalFlagOverImg,this.FlagActiveImg=t.PinPointMovie_LocalFlagActiveImg,this.FlagPoleImg=t.PinPointMovie_LocalFlagPoleImg,this.ExtraFlagBorder=t.PinPointMovie_LocalExtraFlagBorder},PinPointMovie.prototype.clearReferences=function(){this.object=null},PinPointMovie.MAX_SHOWN_GROUP_COUNT=7,PinPointMovie.letterTextFormat=new flash.text.TextFormat("Arial",12,0,!0),PinPointMovie.passiveTextFormat=new flash.text.TextFormat,PinPointMovie.activeTextFormat=new flash.text.TextFormat,PinPointMovie.overPassiveTextFormat=new flash.text.TextFormat,PinPointMovie.overActiveTextFormat=new flash.text.TextFormat,PinPointMovie}(flash.display.Sprite);t.PinPointMovie=i}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function OrangePinPointMovie(){return null!==e&&e.apply(this,arguments)||this}return __extends(OrangePinPointMovie,e),OrangePinPointMovie.prototype.getPinPointType=function(){return"feedpin"},OrangePinPointMovie.prototype.initImageClasses=function(){this.FlagImg=t.OrangePinPointMovie_LocalFlagImg,this.FlagOverImg=t.OrangePinPointMovie_LocalFlagOverImg,this.FlagActiveImg=t.OrangePinPointMovie_LocalFlagActiveImg,this.FlagPoleImg=t.OrangePinPointMovie_LocalFlagPoleImg,this.ExtraFlagBorder=t.OrangePinPointMovie_LocalExtraFlagBorder},OrangePinPointMovie}(t.PinPointMovie);t.OrangePinPointMovie=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function OrangePinPointMovie_LocalExtraFlagBorder(){return null!==t&&t.apply(this,arguments)||this}return __extends(OrangePinPointMovie_LocalExtraFlagBorder,t),OrangePinPointMovie_LocalExtraFlagBorder}(flash.display.Bitmap);t.OrangePinPointMovie_LocalExtraFlagBorder=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function OrangePinPointMovie_LocalFlagActiveImg(){return null!==t&&t.apply(this,arguments)||this}return __extends(OrangePinPointMovie_LocalFlagActiveImg,t),OrangePinPointMovie_LocalFlagActiveImg}(flash.display.Bitmap);t.OrangePinPointMovie_LocalFlagActiveImg=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function OrangePinPointMovie_LocalFlagImg(){return null!==t&&t.apply(this,arguments)||this}return __extends(OrangePinPointMovie_LocalFlagImg,t),OrangePinPointMovie_LocalFlagImg}(flash.display.Bitmap);t.OrangePinPointMovie_LocalFlagImg=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function OrangePinPointMovie_LocalFlagOverImg(){return null!==t&&t.apply(this,arguments)||this}return __extends(OrangePinPointMovie_LocalFlagOverImg,t),OrangePinPointMovie_LocalFlagOverImg}(flash.display.Bitmap);t.OrangePinPointMovie_LocalFlagOverImg=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function OrangePinPointMovie_LocalFlagPoleImg(){return null!==t&&t.apply(this,arguments)||this}return __extends(OrangePinPointMovie_LocalFlagPoleImg,t),OrangePinPointMovie_LocalFlagPoleImg}(flash.display.Bitmap);t.OrangePinPointMovie_LocalFlagPoleImg=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function PassiveLineLayer(i,n){var a=e.call(this,i,n)||this;return a.localYOffset=0,a.localYScale=0,a.lineColor=t.Const.LINE_CHART_LINE_COLOR,a}return __extends(PassiveLineLayer,e),PassiveLineLayer.prototype.highlightPoint=function(e,i,n){this.clearHighlight();var a=this.originalDataSeries;if(!(i<this.viewPoint.getXPos(a.units[0]))){var r;r=i>this.viewPoint.maxx?notnull(this.viewPoint.getLastDataUnit(a)):notnull(this.getPoint(a,i)),void 0===n.points&&(n.points=[]);var o=this.getFormattedClosePrice(r.close),s=this.getTechnicalsNameElseQuote(this.dataSource.quoteName),l=new t.InfoDotInfo;l.quote=s,l.quoteColor=this.lineColor,l.value=o,l.valueColor=this.lineColor,l.displayName="",this.dataSource.displayName&&(l.displayName=this.dataSource.displayName),n.points.push(l),n.setter=this}},PassiveLineLayer.prototype.getFormattedClosePrice=function(t){var e="";Math.floor(t)!==t?e+=Math.floor(100*t)%100%10==0?" "+t+"0":" "+t:e+=" "+t+".00";return e},PassiveLineLayer.prototype.drawLine_=function(e,i,n,a,r,o){var s=o.units,l=o.days,h=e.graphics;h.lineStyle(t.Const.LINE_CHART_LINE_THICKNESS,this.lineColor,t.Const.LINE_CHART_LINE_VISIBILITY);for(var c=o.getNextDayStart(n),u=l[c];u>i&&s[u].fake;)u--;var d=a.getXPos(s[u])+1,g=this.getYPos(r,s[l[c]]);h.moveTo(d,this.viewPoint.maxy),h.lineStyle(0,0,0),h.lineTo(d,g),h.lineStyle(t.Const.LINE_CHART_LINE_THICKNESS,this.lineColor,t.Const.LINE_CHART_LINE_VISIBILITY);var p=this.viewPoint;switch(p.getDetailLevel()){case t.Intervals.INTRADAY:for(;l[c]>0&&l[c]>=i&&l[c]!==l[c-1]+1;)this.drawDayLine_(e,c,a,i,n,r,o),c--;break;case t.Intervals.DAILY:var v=n;d=a.getXPos(s[v]);for(var y=a.minutePix*(this.dataSource.data.marketDayLength+2);v>=i&&v>0;)g=this.getYPos(r,s[v]),h.lineTo(d,g),v--,d-=y;break;case t.Intervals.WEEKLY:for(var f=a.getSkipInterval(),T=o.fridays.length-1;o.fridays[T]>o.days[c];)T--;for(T+=(o.fridays.length-1-T)%f.skip,T=Math.min(T,o.fridays.length-1);T>=0&&o.fridays[T]>=i;){var I=o.units[o.fridays[T]];d=p.getXPos(I),g=this.getYPos(r,I),h.lineTo(d,g),T-=f.skip}}},PassiveLineLayer.prototype.getPoint=function(t,e){return t.units[this.getPointIndex(t,e)]},PassiveLineLayer.prototype.drawDayLine_=function(t,e,i,n,a,r,o){var s,l=o.units,h=o.days;s=e>0?h[e-1]:0;var c=h[e];if(l[c].fake&&c===l.length-1)for(;l[c].fake;)c--;for(;c>a&&c>n;)c--;for(var u=i.getXPos(l[c]),d=i.getSkipInterval(r.count,r.lastMinute),g=i.getIntervalLength(d.interval/60),p=t.graphics;c>=s&&c>=n;)p.lineTo(u,this.localYOffset-(o.points[c].value-r.medPrice)*this.localYScale),c--,u-=g;var v=i.getXPos(l[s]),y=this.getYPos(r,l[s]);p.lineTo(v,y)},PassiveLineLayer.prototype.getTechnicalsNameElseQuote=function(t){var e=t.split("@");return e.length>1?e[1]:t},PassiveLineLayer.prototype.setIndicator=function(e,i,n,a){this.dataSource.indicators[e]=new t.Indicator,this.indicator=this.dataSource.indicators[e],this.computer=i,this.indicatorParams=a,this.originalDataSeries=n},PassiveLineLayer.prototype.getYPos=function(t,e){return this.localYOffset-(e.getCloseLogValue(t.verticalScaling)-t.medPrice)*this.localYScale},PassiveLineLayer.prototype.getDataSeries=function(t){if(!t)return null;var e=this.viewPoint.getSkipInterval(t.count,t.lastMinute);return this.computer?(this.computer(e.interval,this.indicator,this.originalDataSeries,this.indicatorParams),this.indicator.getDataSeries(e.interval)):null},PassiveLineLayer.prototype.renderLayer=function(t){var e=this.viewPoint,i=this.getDataSeries(t);if(i&&0!==i.points.length){this.graphics.clear();var n=i.getRelativeMinuteIndex(e.getLastMinute());n<i.points.length-1&&n++;var a=i.getRelativeMinuteIndex(e.getFirstMinute())-1;a<0&&(a=0),this.localYOffset=e.miny+e.medPriceY+e.V_OFFSET,this.localYScale=e.maxPriceRangeViewSize/t.maxPriceRange,this.drawLine_(this,a,n,e,t,i)}},PassiveLineLayer.prototype.getPointIndex=function(e,i){for(var n=this.viewPoint.getMinuteOfX(i),a=e.getRelativeMinuteIndex(n);e.units[a].fake&&a>0;)a--;var r=this.viewPoint.getSkipInterval(),o=r.skip;if(r.interval<t.Const.DAILY_INTERVAL){var s=e.getNextDayStart(a);return a+(e.days[s]-a)%o}return e.days[e.getNextDayStart(a+1)]},PassiveLineLayer}(t.AbstractDrawingLayer);t.PassiveLineLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function PercentLineChartLayer(){var t=null!==e&&e.apply(this,arguments)||this;return t.localStartPrice=0,t}return __extends(PercentLineChartLayer,e),PercentLineChartLayer.prototype.calculatePercentChangeBase=function(t){return void 0===t&&(t=0),this.getDataSeries().units[t].close},PercentLineChartLayer.prototype.getYPos=function(e,i){return this.localYOffset+e.plusSize-(t.Utils.getLogScaledValue(i.close/this.localStartPrice,e.verticalScaling)-t.Utils.getLogScaledValue(1,e.verticalScaling))*this.localYScale},PercentLineChartLayer.prototype.getQuoteText=function(e){var i=t.Utils.getSymbolFromTicker(e);switch(i){case".INX":return"S&P500";case".DJI":return"Dow";case".IXIC":return"Nasd";default:return i}},PercentLineChartLayer.prototype.getRange=function(t,e){var i=this.getDataSeries();if(!i)return null;var n=i.units;if(!n||0===n.length)return null;var a=i.getRelativeMinuteIndex(t-e),r=i.getRelativeMinuteIndex(t)+1;r<=a+1&&(r=a+2),r=Math.min(r,n.length-1);for(var o=n[a].close,s=n[a].close,l=a;l<=r;l++)n[l].close<o?o=n[l].close:n[l].close>s&&(s=n[l].close);return{startPrice:this.calculatePercentChangeBase(a),minPrice:o,maxPrice:s}},PercentLineChartLayer.prototype.getContext=function(e,i){void 0===i&&(i=!1);var n=this.viewPoint,a=this.getRange(e.lastMinute,e.count);if(!a)return e;var r=t.Utils.getLogScaledValue(a.maxPrice/a.startPrice,e.verticalScaling);e.plusVariation=t.Utils.extendedMax(r,e.plusVariation);var o=t.Utils.getLogScaledValue(a.minPrice/a.startPrice,e.verticalScaling);return e.minusVariation=t.Utils.extendedMin(o,e.minusVariation),e.scaleVariation=e.plusVariation-e.minusVariation,e.localYAdjustment=e.plusVariation-t.Utils.getLogScaledValue(1,e.verticalScaling),e.plusSize=e.localYAdjustment*(n.maxPriceRangeViewSize-20)/e.scaleVariation,e},PercentLineChartLayer.prototype.renderLayer=function(e){var i=this.viewPoint,n=this.getDataSeries(),a=n.points,r=this.graphics;r.clear();var o=n.getRelativeMinuteIndex(i.getLastMinute())+1;o=Math.min(o,a.length-1);var s=n.getRelativeMinuteIndex(i.getFirstMinute());s=Math.max(s,0),this.localYOffset=i.miny+t.ViewPoint.MIN_EDGE_DISTANCE/2,this.localYScale=(i.maxPriceRangeViewSize-20)/e.scaleVariation,this.localStartPrice=this.calculatePercentChangeBase(s);var l=this.drawLine(this,s,o,i,e),h=new flash.display.Point(l,i.maxy);r.lineStyle(0,0,0),r.lineTo(h.x,h.y)},PercentLineChartLayer.prototype.highlightPoint=function(e,i,n){this.clearHighlight();var a=this.getDataSeries();if(!(i<this.viewPoint.getXPos(a.units[0]))){var r;r=i>this.viewPoint.maxx?notnull(this.viewPoint.getLastDataUnit(a)):notnull(this.getPoint(a,i));var o=this.viewPoint.getMinuteXPos(r.relativeMinutes),s=this.getYPos(e,r),l=this.highlightCanvas.graphics;l.lineStyle(5,this.lineColor,1),l.moveTo(o,s-.2),l.lineTo(o,s+.2),void 0===n.points&&(n.points=[]);var h=Math.round(1e4*(r.close/this.localStartPrice-1))/100,c=" "+this.getPercentText(h)+"%",u=t.Const.POSITIVE_DIFFERENCE_COLOR;h<0&&(u=t.Const.NEGATIVE_DIFFERENCE_COLOR);var d=this.getQuoteText(this.dataSource.quoteName),g=new t.InfoDotInfo;g.quote=d,g.quoteColor=this.lineColor,g.value=c,g.valueColor=u,this.dataSource.displayName&&(g.displayName=this.dataSource.displayName),n.points.push(g),n.setter=this}},PercentLineChartLayer.prototype.getPercentText=function(e){var i="";i+=e>0?"+":"-",e=Math.abs(e);var n=Math.floor(e);return i+=n,i+=".",i+=t.Utils.numberToMinTwoChars(Math.floor(100*(e-n)))},PercentLineChartLayer}(t.LineChartLayer);t.PercentLineChartLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function PriceLinesLayer(){return null!==e&&e.apply(this,arguments)||this}return __extends(PriceLinesLayer,e),PriceLinesLayer.prototype.getLinePosAndLabelToFillGap=function(t,e,i){var n=this.getValueForYPos(t,e),a=this.getIncreaseInterval(n),r=a*Math.ceil(n/a);return{yPos:this.getYPos(r,e),label:r}},PriceLinesLayer.prototype.getMinLineValue=function(t){var e=this.inverseLogTransform(t.medPrice-t.maxPriceRange/2,t.verticalScaling);return Math.floor(e/this.distanceBetweenLines)*this.distanceBetweenLines},PriceLinesLayer.prototype.getDistanceBetweenLines=function(e){var i,n=t.Const.YSCALE_INTERVALS.length-1,a=this.getMaxDisplayRange(e),r=this.viewPoint.maxy-this.viewPoint.miny-t.ViewPoint.MIN_EDGE_DISTANCE-t.ViewPoint.MAX_EDGE_DISTANCE;do{i=t.Const.YSCALE_INTERVALS[n]*r/a,n--}while(i>t.ViewPoint.MIN_DISTANCE_BETWEEN_H_LINES&&n>=0);return this.adjustDistanceBetweenLines(e,n)},PriceLinesLayer.prototype.adjustDistanceBetweenLines=function(e,i){var n=t.Const.YSCALE_INTERVALS[i+1];if(e.verticalScaling===t.Const.LOG_VSCALE||e.verticalScaling===t.Const.NEW_LOG_VSCALE){var a=void 0,r=0,o=this.getMaxY(e,n);do{if((a=Math.floor(o/n))>2){var s=(a-1)*n,l=(a-2)*n,h=Number(this.getYPos(s,e)),c=Number(this.getYPos(l,e));(r=Number(Math.abs(h-c)))<t.ViewPoint.MIN_DISTANCE_BETWEEN_LOG_H_LINES&&(this.additionalDistanceBetweenLines=this.getIncreaseInterval(t.Const.YSCALE_INTERVALS[i+1]),n+=this.additionalDistanceBetweenLines,i<t.Const.YSCALE_INTERVALS.length-1&&n===t.Const.YSCALE_INTERVALS[i+2]&&i++)}}while(a>2&&i<t.Const.YSCALE_INTERVALS.length&&r<t.ViewPoint.MIN_DISTANCE_BETWEEN_LOG_H_LINES)}return n},PriceLinesLayer.prototype.getTextForValue=function(t){var e="",i="";t<0&&(i="-",t=Math.abs(t));for(var n=1;this.distanceBetweenLines*n%1!=0;)n=Number(10*n);for(t=Math.round(t*n);n>1;)e=String(t-10*Math.floor(t/10))+e,t=Math.floor(t/10),n=Number(Math.floor(n/10));return e=""!==e?i+String(Math.floor(t))+"."+e:i+String(Math.floor(t))},PriceLinesLayer.prototype.getInitialLinesList_=function(t){var e=this.viewPoint.getLayer("BottomBarLayer").bottomTextHeight;return[this.viewPoint.maxy-e-1]},PriceLinesLayer.prototype.getMaxDisplayRange=function(e){return e.verticalScaling===t.Const.LOG_VSCALE||e.verticalScaling===t.Const.NEW_LOG_VSCALE?this.inverseLogTransform(e.maxRangeUpperBound,e.verticalScaling)-this.inverseLogTransform(e.maxRangeLowerBound,e.verticalScaling):e.maxPriceRange},PriceLinesLayer.prototype.getYPos=function(e,i){return this.viewPoint.miny+this.viewPoint.V_OFFSET+this.viewPoint.medPriceY-(t.Utils.getLogScaledValue(e,i.verticalScaling)-i.medPrice)*this.viewPoint.maxPriceRangeViewSize/i.maxPriceRange},PriceLinesLayer.prototype.getMaxY=function(t,e){var i=(this.viewPoint.V_OFFSET+this.viewPoint.medPriceY)*t.maxPriceRange/this.viewPoint.maxPriceRangeViewSize+t.medPrice;return this.inverseLogTransform(i,t.verticalScaling)},PriceLinesLayer.prototype.drawHorizontalMidLine=function(t,e,i,n,a){var r=Math.floor(t/e),o=Math.ceil(r/2);o=o===r/2?Number(1.2*o):o;var s=this.getLinePosAndLabelToFillGap(i-o*e,a,n),l=i-s.yPos,h=t-l;e<.95*h&&h<.95*l&&this.drawSingleHorizontalLine(s,n)},PriceLinesLayer.prototype.getValueForYPos=function(t,e){return this.inverseLogTransform(e.medPrice-(t-this.viewPoint.miny-this.viewPoint.V_OFFSET-this.viewPoint.medPriceY)*e.maxPriceRange/this.viewPoint.maxPriceRangeViewSize,e.verticalScaling)},PriceLinesLayer.prototype.drawHorizontalLines=function(e){var i;this.graphics.lineStyle(0,t.Const.HORIZONTAL_GRID_COLOR,1);var n=this.viewPoint.maxx-t.Const.BORDER_WIDTH,a=this.getMinLineValue(e),r=this.viewPoint.getLayer("BottomBarLayer").bottomTextHeight,o=this.getInitialLinesList_(e);do{(i=this.getYPos(a,e))>this.viewPoint.miny&&i<this.viewPoint.maxy-r&&(this.drawSingleHorizontalLine({yPos:i,label:a},n),a>=0&&(o[o.length]=i)),a+=this.distanceBetweenLines}while(i>this.viewPoint.miny);if(o[o.length]=this.viewPoint.miny,(e.verticalScaling===t.Const.LOG_VSCALE||e.verticalScaling===t.Const.NEW_LOG_VSCALE)&&o.length>4){var s=o[0]-o[o.length-1],l=o[0]-o[1],h=o[1]-o[2];if(l/s>.4){var c=this.getLinePosAndLabelToFillGap(o[0],e,n);this.drawSingleHorizontalLine(c,n),l=c.yPos-o[1],this.drawHorizontalMidLine(l,h,c.yPos,n,e)}else h/s>.4&&this.drawHorizontalMidLine(h,o[2]-o[3],o[1],n,e)}},PriceLinesLayer.prototype.renderLayer=function(t){this.valueSuffix="",this.additionalDistanceBetweenLines=0,this.graphics.clear(),this.distanceBetweenLines=this.getDistanceBetweenLines(t),this.drawHorizontalLines(t)},PriceLinesLayer.prototype.drawSingleHorizontalLine=function(e,i){this.graphics.moveTo(this.viewPoint.minx+1,e.yPos),this.graphics.lineTo(this.viewPoint.maxx-1,e.yPos);var n=this.getTextForValue(e.label)+this.valueSuffix,a=e.yPos-t.ViewPoint.TEXT_VERTICAL_OFFSET+t.ViewPoint.GRID_TEXT_VERTICAL_OFFSET-t.ViewPoint.TEXT_FIELD_HEIGHT;t.ViewPoint.addTextField(this.textCanvas,n,i,a,0,t.ViewPoint.TEXT_FIELD_HEIGHT,"right",this.viewPoint.priceTextFormat,flash.text.TextFieldAutoSize.RIGHT)},PriceLinesLayer.prototype.getIncreaseInterval=function(t){var e=Math.log(t)/Math.LN10;return Math.pow(10,Math.floor(e))},PriceLinesLayer.prototype.inverseLogTransform=function(e,i){if(i===t.Const.LOG_VSCALE||i===t.Const.NEW_LOG_VSCALE){var n=Math.pow(t.Const.LOG_SCALE,e);return e<1&&(n=10*(n-1)/9),n}return e},PriceLinesLayer}(t.AbstractLayer);t.PriceLinesLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function PercentLinesLayer(){return null!==e&&e.apply(this,arguments)||this}return __extends(PercentLinesLayer,e),PercentLinesLayer.prototype.computeLocalVars=function(e){this.localYOffset=this.viewPoint.miny+t.ViewPoint.MIN_EDGE_DISTANCE/2,this.localYScale=(this.viewPoint.maxPriceRangeViewSize-20)/e.scaleVariation,this.distanceBetweenLines=this.getDistanceBetweenLines(e)},PercentLinesLayer.prototype.drawZeroLine=function(e){var i=this.graphics;i.lineStyle(0,t.Const.ZERO_PERCENT_LINE_COLOR,1);var n=this.getYPos(0,e);i.moveTo(this.viewPoint.minx+1,n),i.lineTo(this.viewPoint.maxx-1,n)},PercentLinesLayer.prototype.getMinLineValue=function(t){for(var e=0,i=100*(this.inverseLogTransform(t.minusVariation,t.verticalScaling)-1);e>i;)e=Number(e-this.distanceBetweenLines);return e=Number(Math.floor(e/this.distanceBetweenLines)*this.distanceBetweenLines)},PercentLinesLayer.prototype.getMaxDisplayRange=function(t){return 100*(this.inverseLogTransform(t.plusVariation,t.verticalScaling)-this.inverseLogTransform(t.minusVariation,t.verticalScaling))},PercentLinesLayer.prototype.getMaxY=function(t,e){var i=100*(this.inverseLogTransform(t.plusVariation,t.verticalScaling)-1),n=0;do{n=Number(this.getYPos(i,t)),i+=e}while(n>this.viewPoint.miny);return i},PercentLinesLayer.prototype.getInitialLinesList=function(t){return[this.getYPos(0,t)]},PercentLinesLayer.prototype.getValueForYPos=function(e,i){if(i.verticalScaling===t.Const.LOG_VSCALE||i.verticalScaling===t.Const.NEW_LOG_VSCALE){var n=i.localYAdjustment-(e-this.localYOffset)/this.localYScale+t.Utils.logTransform(1);return 100*(this.inverseLogTransform(n,i.verticalScaling)-1)}return 100*(i.localYAdjustment-(e-this.localYOffset)/this.localYScale)},PercentLinesLayer.prototype.getYPos=function(e,i){var n=0;if(i.verticalScaling===t.Const.LOG_VSCALE||i.verticalScaling===t.Const.NEW_LOG_VSCALE){if(1+e/100<0)return 2*this.viewPoint.maxy;n=Number(t.Utils.logTransform(1+e/100)-t.Utils.logTransform(1))}else n=Number(e/100);return this.localYOffset+(i.localYAdjustment-n)*this.localYScale},PercentLinesLayer.prototype.renderLayer=function(t){this.valueSuffix="%",this.graphics.clear(),this.computeLocalVars(t),this.drawHorizontalLines(t),this.drawZeroLine(t)},PercentLinesLayer}(t.PriceLinesLayer);t.PercentLinesLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function PinPoint(e,i,n,a,r,o,s,l){var h=t.call(this,e,i,n,a,r,o,s)||this;return h.letter=l,h.forceExpandInGroup=!1,h}return __extends(PinPoint,t),PinPoint}(t.StockAssociatedObject);t.PinPoint=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(e){var i=function(i){function PinPointContentMovie(t){var n=i.call(this)||this;n.closeButton=new flash.display.SimpleButton("closeButton"),n.content=new flash.text.TextField,n.viewPoint=t,n.content.defaultTextFormat=new flash.text.TextFormat("Arial",11),n.content.selectable=!1,n.content.addEventListener(MouseEvents.MOUSE_OVER,function(t){e.MainManager.mouseCursor.setCursor(e.MouseCursors.CLASSIC),e.MainManager.mouseCursor.lockOnDisplayObject(n.content)}),n.content.addEventListener(MouseEvents.MOUSE_OUT,function(t){e.MainManager.mouseCursor.unlock()});var a=new(0,e.PinPointContentMovie_BubbleCloseButton);return n.closeButton.overState=a,n.closeButton.downState=a,n.closeButton.hitTestState=a,n.closeButton.upState=a,n.closeButton.useHandCursor=!0,n.closeButton.addEventListener(MouseEvents.MOUSE_OVER,function(t){e.MainManager.mouseCursor.setCursor(e.MouseCursors.CLASSIC),e.MainManager.mouseCursor.lockOnDisplayObject(n.closeButton)}),n.closeButton.addEventListener(MouseEvents.MOUSE_OUT,function(t){e.MainManager.mouseCursor.unlock()}),n.closeButton.addEventListener(MouseEvents.CLICK,function(t){var e=notnull(n.activePinPoint);e.active=!1,e.forceExpandInGroup=!0,n.clearMovie(),n.viewPoint&&n.viewPoint.updateObjectLayers()}),n}return __extends(PinPointContentMovie,i),PinPointContentMovie.prototype.setActivePinPoint=function(t,e,i){this.activePinPoint=t,this.movieLeftX=e,this.movieBottomY=i},PinPointContentMovie.prototype.renderBackground=function(){var t=this.graphics;t.lineStyle(2,6710886,1),t.beginFill(16777215,1),t.drawRoundRect(this.content.x-PinPointContentMovie.TEXT_FIELD_PADDING,this.content.y-PinPointContentMovie.TEXT_FIELD_PADDING,this.content.width+2*PinPointContentMovie.TEXT_FIELD_PADDING,this.content.height+2*PinPointContentMovie.TEXT_FIELD_PADDING,10,10),t.endFill()},PinPointContentMovie.prototype.renderContent=function(){this.content.wordWrap=!1,this.content.autoSize=flash.text.TextFieldAutoSize.LEFT,this.content.htmlText=this.getContentHtmlText(),this.content.width>PinPointContentMovie.MAX_CONTENT_WIDTH?(this.content.width=PinPointContentMovie.MAX_CONTENT_WIDTH,this.content.wordWrap=!0):this.content.width<PinPointContentMovie.MIN_CONTENT_WIDTH&&(this.content.width=PinPointContentMovie.MIN_CONTENT_WIDTH,this.content.wordWrap=!0);var t=this.movieLeftX+this.content.width+2*PinPointContentMovie.TEXT_FIELD_PADDING-e.Const.MOVIE_WIDTH;this.content.x=this.movieLeftX-Math.max(0,t),this.content.y=Math.max(this.viewPoint.miny+PinPointContentMovie.TEXT_FIELD_PADDING+2,this.movieBottomY-this.content.textHeight-2*PinPointContentMovie.TEXT_FIELD_PADDING),this.addChild(this.content),this.closeButton.x=this.content.x+this.content.width-this.closeButton.width-PinPointContentMovie.TEXT_FIELD_PADDING/2,this.closeButton.y=this.content.y+PinPointContentMovie.TEXT_FIELD_PADDING/2,this.addChild(this.closeButton)},PinPointContentMovie.prototype.getLetterHtml=function(t){return"<b>"+this.escapeHtml(t)+"</b>"},PinPointContentMovie.prototype.getAuthorHtml=function(t){return"<font color='#6B6B6B' size='12'>"+this.escapeHtml(t)+"</font>"},PinPointContentMovie.prototype.getTitleHtml=function(t,e,i){var n="";i?(n+='<a href="javascript:'+("_GF_click('', 'n-cn-', '"+encodeURIComponent(t)+"', '');")+("self.location='"+encodeURIComponent(i)+"';")+"'>",n+="<u><font color='#0000CC' size='12'>"):n+="<font size='12'>";return n+=this.escapeHtml(e),n+=i?"</font></u></a>":"</font>"},PinPointContentMovie.prototype.escapeHtml=function(t){throw new Error("not implemented")},PinPointContentMovie.prototype.getDateHtml=function(i){var n=e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale())?"yyyy-MM-dd HH:mm":"MMM dd, yyyy h:mma";return"<font color='#0B6CDE'>"+t.i18n.locale.DateTimeLocale.formatDateTime(n,i,!0)+"</font>"},PinPointContentMovie.prototype.renderMovie=function(){this.activePinPoint&&(this.renderContent(),this.renderBackground())},PinPointContentMovie.prototype.clearMovie=function(){this.activePinPoint=null,this.contains(this.content)&&this.removeChild(this.content),this.contains(this.closeButton)&&this.removeChild(this.closeButton),this.graphics.clear()},PinPointContentMovie.prototype.getContentHtmlText=function(){var t=notnull(this.activePinPoint),e=t.originalObject,i=this.getLetterHtml(t.letter);return t.exchangeDateInUTC&&(i+=" "+this.getDateHtml(t.exchangeDateInUTC)),e._title&&""!==e._title&&(i+="\n"+this.getTitleHtml(t.letter,e._title,e._url)),e._author&&""!==e._author?i+="\n"+this.getAuthorHtml(e._author):e._snippet&&""!==e._snippet&&(i+="\n"+this.getAuthorHtml(e._snippet)),i},PinPointContentMovie.prototype.getSnippetHtml=function(t){return"<font color='#6B6B6B' size='12'>"+this.escapeHtml(t)+"</font>"},PinPointContentMovie.TEXT_FIELD_PADDING=8,PinPointContentMovie.MIN_CONTENT_WIDTH=140,PinPointContentMovie.MAX_CONTENT_WIDTH=250,PinPointContentMovie}(flash.display.Sprite);e.PinPointContentMovie=i}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function PinPointContentMovie_BubbleCloseButton(){return null!==t&&t.apply(this,arguments)||this}return __extends(PinPointContentMovie_BubbleCloseButton,t),PinPointContentMovie_BubbleCloseButton}(flash.display.Bitmap);t.PinPointContentMovie_BubbleCloseButton=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function PinPointMovie_LocalExtraFlagBorder(){return null!==t&&t.apply(this,arguments)||this}return __extends(PinPointMovie_LocalExtraFlagBorder,t),PinPointMovie_LocalExtraFlagBorder}(flash.display.Bitmap);t.PinPointMovie_LocalExtraFlagBorder=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function PinPointMovie_LocalFlagActiveImg(){return null!==t&&t.apply(this,arguments)||this}return __extends(PinPointMovie_LocalFlagActiveImg,t),PinPointMovie_LocalFlagActiveImg}(flash.display.Bitmap);t.PinPointMovie_LocalFlagActiveImg=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function PinPointMovie_LocalFlagImg(){return null!==t&&t.apply(this,arguments)||this}return __extends(PinPointMovie_LocalFlagImg,t),PinPointMovie_LocalFlagImg}(flash.display.Bitmap);t.PinPointMovie_LocalFlagImg=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function PinPointMovie_LocalFlagOverImg(){return null!==t&&t.apply(this,arguments)||this}return __extends(PinPointMovie_LocalFlagOverImg,t),PinPointMovie_LocalFlagOverImg}(flash.display.Bitmap);t.PinPointMovie_LocalFlagOverImg=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function PinPointMovie_LocalFlagPoleImg(){return null!==t&&t.apply(this,arguments)||this}return __extends(PinPointMovie_LocalFlagPoleImg,t),PinPointMovie_LocalFlagPoleImg}(flash.display.Bitmap);t.PinPointMovie_LocalFlagPoleImg=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function PinPointsLayer(i,n){var a=e.call(this,i,n)||this;return a.localYOffset=0,a.localYScale=0,a.pinPointYWhenContentDisplayed=0,a.activeMovies=0,a.pinMovies=[],a.pinPointContentMovie=new t.PinPointContentMovie(i),i.addChildToTopCanvas(a.pinPointContentMovie),a}return __extends(PinPointsLayer,e),PinPointsLayer.prototype.getFlagGroupCount=function(e,i,n,a){var r=1,o=i[n];if(a===t.Intervals.INTRADAY)for(;n+r<i.length&&i[n+r].pos===o.pos&&i[n+r].refDataSeries===o.refDataSeries;)r++;else for(;n+r<i.length&&i[n+r].dayPos===o.dayPos&&i[n+r].refDataSeries===o.refDataSeries;)r++;return r},PinPointsLayer.prototype.getLastVisibleFlagIndex=function(t,e){for(var i=e.length-1;i>=0;i--){var n=e[i];if(notnull(n.refDataSeries).units[n.pos].relativeMinutes<=t.lastMinute)return i}return-1},PinPointsLayer.prototype.getFirstVisibleFlagIndex=function(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(notnull(n.refDataSeries).units[n.pos].relativeMinutes>t.lastMinute-t.count)return i}return e.length-1},PinPointsLayer.prototype.getPinPointMovieClip=function(e){var i,n=e.originalObject._color?e.originalObject._color:"gray";this.activeMovies>=this.pinMovies.length?(i="orange"===n?new t.OrangePinPointMovie:new t.PinPointMovie,this.addChild(i),this.pinMovies.push(i)):((i=this.pinMovies[this.activeMovies])instanceof t.OrangePinPointMovie?"orange":"gray")!==n&&(i="orange"===n?new t.OrangePinPointMovie:new t.PinPointMovie,this.removeChild(this.pinMovies[this.activeMovies]),this.pinMovies[this.activeMovies].clearReferences(),delete this.pinMovies[this.activeMovies],this.pinMovies[this.activeMovies]=i);return i.setPinPointContentMovie(this.pinPointContentMovie),this.activeMovies++,i},PinPointsLayer.prototype.removePinMovies=function(t){for(var e=t;e<this.pinMovies.length;e++)this.removeChild(this.pinMovies[e]),this.pinMovies[e].clearReferences(),delete this.pinMovies[e];this.pinMovies.splice(t)},PinPointsLayer.prototype.getYPos=function(t,e){return this.localYOffset-(e.getCloseLogValue(t.verticalScaling)-t.medPrice)*this.localYScale},PinPointsLayer.prototype.renderLayer=function(e){if(!isNaN(e.lastMinute)&&!isNaN(e.count)&&0!==e.count){var i=this.dataSource.objects.newspin;if(this.activeMovies=0,this.pinPointContentMovie.clearMovie(),i&&0!==i.length){var n="orange"!==i[0].originalObject._color;if(t.Const.DISPLAY_NEWS_PINS||!n){var a=this.viewPoint;this.localYOffset=a.miny+a.medPriceY+a.V_OFFSET,this.localYScale=a.maxPriceRangeViewSize/e.maxPriceRange;var r=a.getLayer("BottomBarLayer");this.pinPointYWhenContentDisplayed=a.maxy-(r?r.bottomTextHeight:0);var o=this.getFirstVisibleFlagIndex(e,i),s=this.getLastVisibleFlagIndex(e,i);this.lastAbsoluteHeightMin=0,this.lastAbsoluteHeightMax=0;var l=a.getDetailLevel(e.count,e.lastMinute);this.renderFlagGroups(e,i,o,s,l),this.removePinMovies(this.activeMovies),n||this.pinPointContentMovie.renderMovie()}else this.removePinMovies(0)}else this.removePinMovies(0)}},PinPointsLayer.prototype.renderFlagGroups=function(e,i,n,a,r){for(var o=[],s=[],l=[],h=[],c=n;c<=a;){o.push(c);var u=this.getFlagGroupCount(e,i,c,r);s.push(u);var d=this.getVisibleDataUnit(i[c]);l.push(Math.floor(this.viewPoint.getXPos(d))),h.push(this.getYPos(e,d)),c+=u}if(o.length>0){for(var g=[],p=o.length-1;p>=0;p--)(0===g.length||g[g.length-1]===t.PinOrientations.LEFT_ORIENTATION)&&l[p]+(o.length-p)*PinPointsLayer.MIN_FLAGS_DIST>this.viewPoint.maxx?g.push(t.PinOrientations.LEFT_ORIENTATION):g.push(t.PinOrientations.RIGHT_ORIENTATION);g.reverse();for(p=0;p<o.length;p++)this.renderFlagsGroup(e,r,l[p],h[p],o[p],s[p],i,PinPointsLayer.FLAG_POLE_HEIGHT+PinPointsLayer.FLAG_HEIGHT,g[p])}},PinPointsLayer.prototype.renderFlag=function(t,e,i,n,a,r){void 0===r&&(r=1);var o=this.getPinPointMovieClip(n);this.addChild(o),o.x=t,o.y=this.pinPointYWhenContentDisplayed,o.setCount(r),o.setObj(n),o.setOrientation(e),o.setHeight(i)},PinPointsLayer.prototype.getVisibleDataUnit=function(e){var i=notnull(e.refDataSeries),n=this.viewPoint.getSkipInterval(),a=0;return a=n.interval>=t.Const.WEEKLY_INTERVAL?Number(i.fridays[i.getNextWeekEnd(e.pos)]):n.interval>=t.Const.DAILY_INTERVAL?Number(e.dayPos):Number(e.pos+(notnull(e.dayPos)-e.pos)%n.skip),i.units[a]},PinPointsLayer.prototype.renderFlagsGroup=function(e,i,n,a,r,o,s,l,h){this.lastAbsoluteHeightMin=a-l+PinPointsLayer.FLAG_HEIGHT;for(var c=!1,u=r;u<r+o;u++)c=c||s[u].active||s[u].forceExpandInGroup;if(o>1&&c||!Boolean(t.Const.ENABLE_COMPACT_FLAGS)){var d=l+(o-1)*PinPointsLayer.FLAG_HEIGHT;for(u=r;u<r+o;u++){var g=l+(u-r)*PinPointsLayer.FLAG_HEIGHT;this.renderFlag(n,h,g,s[u]),s[u].active&&this.pinPointContentMovie.setActivePinPoint(s[u],n,this.pinPointYWhenContentDisplayed-d)}}else{var p=2*Math.min(o,t.PinPointMovie.MAX_SHOWN_GROUP_COUNT);d=l+p;this.renderFlag(n,h,l+p,s[r+o-1],s[r],o),s[r].active&&this.pinPointContentMovie.setActivePinPoint(s[r],n,this.pinPointYWhenContentDisplayed-d)}this.lastAbsoluteHeightMax=a-this.pinMovies[this.activeMovies-1].getHeight()},PinPointsLayer.FLAG_HEIGHT=14,PinPointsLayer.MIN_FLAGS_DIST=10,PinPointsLayer.FLAG_POLE_HEIGHT=10,PinPointsLayer}(t.AbstractLayer);t.PinPointsLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function PrecalculatedPercentLineChartLayer(){return null!==t&&t.apply(this,arguments)||this}return __extends(PrecalculatedPercentLineChartLayer,t),PrecalculatedPercentLineChartLayer.prototype.calculatePercentChangeBase=function(t){return void 0===t&&(t=0),1},PrecalculatedPercentLineChartLayer}(t.PercentLineChartLayer);t.PrecalculatedPercentLineChartLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function ScrollSlider_ScrollBarGrip(){return null!==t&&t.apply(this,arguments)||this}return __extends(ScrollSlider_ScrollBarGrip,t),ScrollSlider_ScrollBarGrip}(flash.display.Bitmap);t.ScrollSlider_ScrollBarGrip=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function ScrollSlider_ScrollBarBg(){return null!==t&&t.apply(this,arguments)||this}return __extends(ScrollSlider_ScrollBarBg,t),ScrollSlider_ScrollBarBg}(flash.display.Bitmap);t.ScrollSlider_ScrollBarBg=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function ScrollSlider(t){var i=e.call(this,t)||this;return i.middle=new ScrollSlider.ScrollBarGrip,i.bg=new ScrollSlider.ScrollBarBg,i.addChild(i.bg),i.addChild(i.middle),i}return __extends(ScrollSlider,e),ScrollSlider.prototype.setWidth=function(t){t<ScrollSlider.MIN_WIDTH&&(t=ScrollSlider.MIN_WIDTH),this.middle.x=Math.floor(t/2)-this.middle.width/2,this.bg.width=t-2},ScrollSlider.MIN_WIDTH=18,ScrollSlider.ScrollBarGrip=t.ScrollSlider_ScrollBarGrip,ScrollSlider.ScrollBarBg=t.ScrollSlider_ScrollBarBg,ScrollSlider}(flash.display.Sprite);t.ScrollSlider=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(e){var i=function(i){function SpaceText(t){var n=i.call(this)||this;n.displayManager=t,n.returnText="",n.negativeTextFormat=new flash.text.TextFormat("Verdana",9,e.Const.NEGATIVE_DIFFERENCE_COLOR),n.infoDots=[],n.datesTextFormats=[],n.grayText=new flash.text.TextFormat("Verdana",9,7829367),n.bg=new flash.display.Sprite("bg"),n.blackText=new flash.text.TextFormat("Verdana",9,0),n.datesText="",n.positiveTextFormat=new flash.text.TextFormat("Verdana",9,e.Const.POSITIVE_DIFFERENCE_COLOR),n.bg.graphics.beginFill(16777215,1),n.bg.graphics.drawRect(0,0,e.Const.MOVIE_WIDTH,e.Const.SPACE_HEIGHT+e.Const.INFO_TEXT_TOP_PADDING),n.bg.graphics.endFill(),n.addChild(n.bg),n.blackText.align=flash.text.TextFormatAlign.RIGHT,n.negativeTextFormat.align=flash.text.TextFormatAlign.RIGHT,n.positiveTextFormat.align=flash.text.TextFormatAlign.RIGHT,n.grayText.align=flash.text.TextFormatAlign.RIGHT;var a=e.Const.MOVIE_WIDTH-SpaceText.RIGHT_PADDING,r=e.Const.SPACE_HEIGHT/2-SpaceText.TEXT_HEIGHT/2+e.Const.INFO_TEXT_TOP_PADDING;return n.infoText=n.newTextField(a,r),n.addChild(n.infoText),n.changeText=n.newTextField(a,r),n.addChild(n.changeText),n.startDate=n.newDateTextField(a,r,0),n.addChild(n.startDate),n.registerDateTextFieldListeners(n.startDate),n.endDate=n.newDateTextField(a,r,1),n.addChild(n.endDate),n.registerDateTextFieldListeners(n.endDate),n.setDateEntryState(SpaceText.DISPLAY_DATES),n}return __extends(SpaceText,i),SpaceText.prototype.setReturnInfo=function(t){var e=t.getLastNotVisibleDataUnit(),i=t.getLastDataUnit(),n=t.getBaseDataSource();this.clearComparisonInfo(),this.returnText=this.getReturnText(e,i,n),this.updateInfoText()},SpaceText.prototype.setSize=function(t,i){this.updateAlignAndPadding(),this.positionInfoText(),this.positionComparisonInfoDots(),this.bg.width=t,this.bg.height=i+e.Const.INFO_TEXT_TOP_PADDING},SpaceText.prototype.getHumanReadableVolume=function(i){var n="",a=1e3;if(e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale())&&(a=1e4),i>3*a*a)switch(n+=e.Utils.numberToString(i/(a*a),2,5),a){case 1e3:n+=e.Message.getMsg(e.Messages.MILLION_ONE_LETTER);break;case 1e4:n+=e.Message.getMsg(e.Messages.HUNDRED_MILLION_ONE_LETTER)}else if(i>a)switch(n+=e.Utils.numberToString(i/a,2,5),a){case 1e3:n+=e.Message.getMsg(e.Messages.THOUSAND_ONE_LETTER);break;case 1e4:n+=e.Message.getMsg(e.Messages.TEN_THOUSAND_ONE_LETTER)}else n+=i;return n},SpaceText.prototype.setDateEntryState=function(t){this.dateEntryState=t;var e=this.dateEntryState===SpaceText.EDIT_DATES;this.startDate.setHighlighted(e),this.endDate.setHighlighted(e)},SpaceText.prototype.clearComparisonInfo=function(){for(var t=0,e=this.infoDots;t<e.length;t++){var i=e[t];this.removeChild(i)}this.infoDots.splice(0)},SpaceText.prototype.newTextField=function(t,e){var i=new flash.text.TextField;return i.defaultTextFormat=this.blackText,i.selectable=!1,i.autoSize=flash.text.TextFieldAutoSize.LEFT,i.x=t,i.y=e,i},SpaceText.prototype.appendOhlcText=function(t,e,i){this.datesText+=t;var n=this.normalizePrice(e);-1!==i&&(e>i?this.datesTextFormats.push({start:this.datesText.length,end:this.datesText.length+n.length,format:this.positiveTextFormat}):e<i&&this.datesTextFormats.push({start:this.datesText.length,end:this.datesText.length+n.length,format:this.negativeTextFormat})),this.datesText+=n},SpaceText.prototype.setPointInfo=function(t){void 0!==t[SpaceText.POINT_STR]?this.setSinglePointInfo(t):void 0!==t[SpaceText.POINTS_STR]&&this.setComparisonInfo(t)},SpaceText.prototype.updateAlignAndPadding=function(){var t=this.displayManager.mainController.getButtonsWidth(),i=0;i=Number(i+(this.startDate.visible?this.startDate.width+3:0)),i=Number(i+(this.endDate.visible?this.endDate.width+3:0)),i=Number(i+(this.infoText.width+2)),i=Number(i+(this.changeText.visible?this.changeText.width:0)),e.Const.INDICATOR_ENABLED&&(i=Number(i+160)),e.Const.EXPAND_BUTTON_ENABLED||e.Const.SHRINK_BUTTON_ENABLED||i+t>e.Const.MOVIE_WIDTH?(e.Const.INFO_TEXT_ALIGN="left",e.Const.INFO_TEXT_TOP_PADDING=17):(e.Const.INFO_TEXT_ALIGN="right",e.Const.INFO_TEXT_TOP_PADDING=0)},SpaceText.prototype.processChangedDateFields=function(){this.setDateEntryState(SpaceText.DISPLAY_DATES),this.startDate.parseUtcDate()&&this.endDate.parseUtcDate()&&this.startDate.parsedDate&&this.endDate.parsedDate&&(this.endDate.parsedDate.setUTCHours(23,59,0,0),this.needToAnimate()&&this.displayManager.mainController.animateToCustomLevel(this.startDate.parsedDate,this.endDate.parsedDate)),this.updateInfoText()},SpaceText.prototype.setSinglePointInfo=function(i){var n=i[SpaceText.POINT_STR];switch(i.extraText){case e.Const.PRE_MARKET_DISPLAY_NAME:this.datesText=e.Message.getMsg(e.Messages.PREMARKET)+": ";break;case e.Const.AFTER_HOURS_DISPLAY_NAME:this.datesText=e.Message.getMsg(e.Messages.AFTER_HOURS)+": ";break;default:this.datesText=""}this.datesTextFormats=[];var a=this.getSinglePointDateFormat(n),r=n.exchangeDateInUTC;this.datesText+=t.i18n.locale.DateTimeLocale.formatDateTime(a,r,!0),i[SpaceText.OHLC_INFO_FLAG_STR]?(this.appendOhlcText(SpaceText.OPEN_TEXT,n.open,i[SpaceText.OHLC_BASE_PRICE_STR]),this.appendOhlcText(SpaceText.HIGH_TEXT,n.high,i[SpaceText.OHLC_BASE_PRICE_STR]),this.appendOhlcText(SpaceText.LOW_TEXT,n.low,i[SpaceText.OHLC_BASE_PRICE_STR]),this.appendOhlcText(SpaceText.CLOSE_TEXT,n.close,i[SpaceText.OHLC_BASE_PRICE_STR])):(this.datesText+=SpaceText.PRICE_TEXT,i[SpaceText.SETTER_STR]&&i[SpaceText.SETTER_STR].dataSource&&i[SpaceText.SETTER_STR].dataSource.tickerName&&0===i[SpaceText.SETTER_STR].dataSource.tickerName.indexOf("CURRENCY:")?this.datesText+=Math.round(1e4*n.close)/1e4:this.datesText+=this.normalizePrice(n.close)),isNaN(i[SpaceText.VOLUME_STR])||(this.datesText+=" "+e.Message.getMsg(e.Messages.VOLUME_SHORT)+": ",this.datesText+=this.getHumanReadableVolume(i.volume)),this.returnText="",this.updateInfoText()},SpaceText.prototype.onMouseRollOverInfoText=function(t){this.startDate.setHighlighted(!0),this.endDate.setHighlighted(!0)},SpaceText.prototype.normalizePrice=function(t){return Math.round(1e3*t)%10==0?t.toFixed(2):t.toFixed(3)},SpaceText.prototype.onKeyDown=function(t){switch(t.charCode){case 27:this.resetInfoText();break;case 13:this.processChangedDateFields()}},SpaceText.prototype.registerDateTextFieldListeners=function(t){"true"===e.Const.ENABLE_CUSTOM_DATE_ENTRY&&(t.addEventListener(MouseEvents.ROLL_OVER,flash.display.Stage.bind(this.onMouseRollOverInfoText,this)),t.addEventListener(MouseEvents.ROLL_OUT,flash.display.Stage.bind(this.onMouseRollOutInfoText,this)),t.addEventListener(MouseEvents.CLICK,flash.display.Stage.bind(this.onMouseClickDateField,this)),t.addEventListener(KeyboardEvents.KEY_DOWN,flash.display.Stage.bind(this.onKeyDown,this)))},SpaceText.prototype.positionInfoText=function(t){void 0===t&&(t=!0);var i=this.startDate.visible?Number(this.startDate.width+3):0,n=this.endDate.visible?Number(this.endDate.width+3):0,a=this.infoText.width+2;switch(e.Const.INFO_TEXT_ALIGN){case"left":this.startDate.x=SpaceText.LEFT_PADDING,this.infoText.x=this.startDate.x+i,this.endDate.x=this.infoText.x+a,this.changeText.x=this.endDate.x+n;break;case"right":this.changeText.x=e.Const.MOVIE_WIDTH-this.changeText.width-SpaceText.RIGHT_PADDING,this.endDate.x=this.changeText.x-n,this.infoText.x=this.endDate.x-a,this.startDate.x=this.infoText.x-i}if(t){var r=e.Const.SPACE_HEIGHT/2-SpaceText.TEXT_HEIGHT/2+e.Const.INFO_TEXT_TOP_PADDING;this.infoText.y=r,this.changeText.y=r,this.startDate.y=r,this.endDate.y=r}},SpaceText.prototype.onMouseRollOutInfoText=function(t){this.dateEntryState!==SpaceText.EDIT_DATES&&(this.startDate.setHighlighted(!1),this.endDate.setHighlighted(!1))},SpaceText.prototype.positionComparisonInfoDots=function(){var t=NaN;"right"===e.Const.INFO_TEXT_ALIGN?t=this.stage.stageWidth:"left"===e.Const.INFO_TEXT_ALIGN&&(t=SpaceText.LEFT_PADDING+SpaceText.INFO_DOT_PADDING);for(var i=0,n=this.infoDots;i<n.length;i++){var a=n[i];a.y=e.Const.SPACE_HEIGHT-SpaceText.TEXT_HEIGHT/2+3+e.Const.INFO_TEXT_TOP_PADDING,"right"===e.Const.INFO_TEXT_ALIGN?(a.x=t-a.width,t-=a.width-3):"left"===e.Const.INFO_TEXT_ALIGN&&(a.x=t,t+=a.width+3)}},SpaceText.prototype.getSinglePointDateFormat=function(i){var n="MMM dd, yyyy";return e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale())&&(n="yyyyMd"),i.dayMinute!==e.Const.MARKET_CLOSE_MINUTE&&(n+=" HH:mm"),n},SpaceText.prototype.updateInfoText=function(){if(this.dateEntryState!==SpaceText.EDIT_DATES){if(""===this.datesText){if(!this.startDate.date||!this.endDate.date)return;if(this.infoText.text="-",this.startDate.visible=!0,this.endDate.visible=!0,this.startDate.displayDateInLocalizedFormat(),this.endDate.displayDateInLocalizedFormat(),this.returnText.length>0){var t=this.negativeTextFormat;-1!==this.returnText.indexOf("+")&&(t=this.positiveTextFormat),this.changeText.getTextFormat()!==t&&(this.changeText.defaultTextFormat=t)}this.changeText.text=this.returnText}else{this.infoText.text=this.datesText;for(var e=0,i=this.datesTextFormats;e<i.length;e++){var n=i[e];this.infoText.setTextFormat(n.format,n.start,n.end)}this.changeText.text="",this.startDate.visible=!1,this.endDate.visible=!1}this.positionInfoText(!1)}},SpaceText.prototype.isDateFieldClicked=function(t){return t.target===this.startDate.element||t.target===this.endDate.element},SpaceText.prototype.setComparisonInfo=function(t){var i=t[SpaceText.POINTS_STR];this.returnText="",this.updateInfoText(),this.clearComparisonInfo();for(var n=i.length-1;n>=0;n--){var a=new e.InfoDot;this.addChild(a),a.setInfo(i[n]),this.infoDots.push(a)}this.positionComparisonInfoDots()},SpaceText.prototype.onMouseClickDateField=function(t){this.dateEntryState!==SpaceText.EDIT_DATES&&(this.setDateEntryState(SpaceText.EDIT_DATES),this.startDate.type=flash.text.TextFieldType.INPUT,this.startDate.displayDateInParseableFormat(),this.endDate.type=flash.text.TextFieldType.INPUT,this.endDate.displayDateInParseableFormat(),t.target.setSelectionRange(0,10),this.positionInfoText())},SpaceText.prototype.setContextualStaticInfo=function(t){t[SpaceText.SETTER_STR]&&(t[SpaceText.POINTS_STR]?(this.returnText="",this.setTimePeriod(t[SpaceText.SETTER_STR].viewPoint),this.setComparisonInfo(t)):(this.setTimePeriod(t[SpaceText.SETTER_STR].viewPoint),this.setReturnInfo(t[SpaceText.SETTER_STR].viewPoint)))},SpaceText.prototype.needToAnimate=function(){return!!this.endDate.parsedDate&&((0!==e.Utils.compareUtcDates(this.endDate.date,this.endDate.parsedDate)||0!==e.Utils.compareUtcDates(this.startDate.date,notnull(this.startDate.parsedDate)))&&e.Utils.compareUtcDates(notnull(this.startDate.parsedDate),this.endDate.parsedDate)<=0)},SpaceText.prototype.resetInfoText=function(){this.dateEntryState!==SpaceText.DISPLAY_DATES&&(this.setDateEntryState(SpaceText.DISPLAY_DATES),this.updateInfoText())},SpaceText.prototype.getReturnText=function(t,e,i){if(!t||!e)return"";var n="",a=e.close-t.close,r=Math.round(a/t.close*1e4)/100;return a>0&&(n+="+"),n+=(a=i&&i.tickerName&&0===i.tickerName.indexOf("CURRENCY:")?Math.round(1e5*a)/1e5:Math.round(100*a)/100)+" ("+r+"%)"},SpaceText.prototype.setTimePeriod=function(t){var e=t.getFirstDataUnit(),i=t.getLastDataUnit();if(e&&i){if(i.time<e.time){var n=i;i=e,e=n}this.datesText="",this.datesTextFormats=[],this.startDate.date=e.exchangeDateInUTC,this.endDate.date=i.exchangeDateInUTC,this.updateInfoText()}},SpaceText.prototype.newDateTextField=function(t,i,n){var a=new e.DateTextField;return a.autoSize=flash.text.TextFieldAutoSize.LEFT,a.backgroundColor=e.Const.DATE_HIGHLIGHTED_BACKGROUND_COLOR,a.border=Boolean(e.Const.ENABLE_CUSTOM_DATE_ENTRY),a.defaultTextFormat=this.blackText,a.focusRect=a,a.mouseEnabled=Boolean(e.Const.ENABLE_CUSTOM_DATE_ENTRY),a.selectable=Boolean(e.Const.ENABLE_CUSTOM_DATE_ENTRY),a.tabEnabled=Boolean(e.Const.ENABLE_CUSTOM_DATE_ENTRY),a.tabIndex=n,a.x=t,a.y=i,a},SpaceText.OHLC_INFO_FLAG_STR="ohlcInfo",SpaceText.POINT_STR="point",SpaceText.PRICE_TEXT=" "+e.Message.getMsg(e.Messages.PRICE)+": ",SpaceText.OPEN_TEXT=" "+e.Message.getMsg(e.Messages.OPEN)+": ",SpaceText.SETTER_STR="setter",SpaceText.LOW_TEXT=" "+e.Message.getMsg(e.Messages.LOW)+": ",SpaceText.VOL_TEXT=" "+e.Message.getMsg(e.Messages.VOLUME_SHORT)+": ",SpaceText.OHLC_BASE_PRICE_STR="basePrice",SpaceText.VOLUME_STR="volume",SpaceText.HIGH_TEXT=" "+e.Message.getMsg(e.Messages.HIGH)+": ",SpaceText.CLOSE_TEXT=" "+e.Message.getMsg(e.Messages.CLOSE)+": ",SpaceText.POINTS_STR="points",SpaceText.EXTRA_TEXT_STR="extraText",SpaceText.DISPLAY_DATES=0,SpaceText.INFO_DOT_PADDING=7,SpaceText.TEXT_HEIGHT=15,SpaceText.RIGHT_PADDING=5,SpaceText.EDIT_DATES=1,SpaceText.LEFT_PADDING=5,SpaceText}(flash.display.Sprite);e.SpaceText=i}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function SparklineDateLinesLayer(){var i=null!==e&&e.apply(this,arguments)||this;return i.tickPosition=t.TickPositions.TOP,i}return __extends(SparklineDateLinesLayer,e),SparklineDateLinesLayer.prototype.drawQuarterStarts=function(t){var e=this.dataSource.data;if(e.units&&0!==e.firsts.length)for(var i=this.viewPoint,n=i.maxx,a=i.maxy,r=i.minx,o=r+1,s=t.graphics,l=e.firsts.length-1;o>r&&l>=0;l--){var h=e.units[e.firsts[l]];h.exchangeDateInUTC.getUTCMonth()%3==0&&(o=i.getXPos(n,r,h),s.lineStyle(0,SparklineDateLinesLayer.DATE_LINES_COLOR,1),s.moveTo(o,a),s.lineTo(o,a-4))}},SparklineDateLinesLayer.prototype.drawYearStarts=function(e){var i=this.dataSource.data;if(i.units&&0!==i.years.length){var n=1;this.getOneYearWidth()<SparklineDateLinesLayer.MIN_YEAR_WIDTH&&(n=5);var a=e.graphics;a.lineStyle(0,SparklineDateLinesLayer.DATE_LINES_COLOR,1);var r,o=i.years.length-1,s=this.viewPoint,l=s.maxx,h=s.minx,c=s.maxy,u=s.miny,d=0;do{var g=i.units[i.years[o]];r=s.getXPos(l,h,g);var p=g.exchangeDateInUTC;if(p.getUTCFullYear()%n==0){a.moveTo(r,u),a.lineTo(r,c);var v=r+t.ViewPoint.TEXT_HORIZONTAL_OFFSET,y=c-15,f=void 0;d>=e.numChildren?((f=new flash.text.TextField).autoSize="left",f.selectable=!1,e.addChild(f)):f=e.getChildAt(d),d++,f.x=v,f.y=y,f.defaultTextFormat=s.dateTextFormat,f.text=""+p.getUTCFullYear();var T=f.width,I=f.height;a.lineStyle(0,0,0),a.moveTo(v+2,y+2),a.beginFill(16777215,80),a.lineTo(v+2,y+I-2),a.lineTo(v+T-2,y+I-2),a.lineTo(v+T-2,y+2),a.endFill(),a.lineStyle(0,SparklineDateLinesLayer.DATE_LINES_COLOR,1)}else a.moveTo(r,c-SparklineDateLinesLayer.SHORT_YEAR_LINE_HEIGHT),a.lineTo(r,c);o--}while(r>this.viewPoint.minx&&o>=0);for(;e.numChildren>d;)e.removeChildAt(d)}},SparklineDateLinesLayer.prototype.drawVerticalLines=function(){this.textCanvas.graphics.clear(),t.Utils.removeAllChildren(this.textCanvas),this.drawYearStarts(this.textCanvas),this.getOneYearWidth()>SparklineDateLinesLayer.MIN_YEAR_WIDTH&&this.drawQuarterStarts(this.textCanvas)},SparklineDateLinesLayer.prototype.getOneYearWidth=function(){var t=this.dataSource.data;if(t.years.length>1){var e=t.units,i=t.years.length-1,n=e[t.years[i]].relativeMinutes-e[t.years[i-1]].relativeMinutes;return this.viewPoint.getIntervalLength(n)}return 250*t.marketDayLength},SparklineDateLinesLayer.prototype.renderLayer=function(t){this.drawVerticalLines()},SparklineDateLinesLayer.MIN_YEAR_WIDTH=50,SparklineDateLinesLayer.DATE_LINES_COLOR=13426124,SparklineDateLinesLayer.SHORT_YEAR_LINE_HEIGHT=5,SparklineDateLinesLayer}(t.AbstractLayer);t.SparklineDateLinesLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function SparklineLayer(i,n){var a=e.call(this,i,n)||this;return a.borderColor=11184810,a.lineColor=t.Const.LINE_CHART_LINE_COLOR,a}return __extends(SparklineLayer,e),SparklineLayer.prototype.getYPos=function(t,e,i){var n=Number(this.maxPriceLog-this.minPriceLog);return 0===n&&(n=.01),t-2-(this.LogPreserveSign(i.close)-this.minPriceLog)*(t-e-5)/n},SparklineLayer.prototype.drawBackground=function(t){var e=this.viewPoint;if(this.hasBackground){var i=this.graphics;t&&i.beginFill(this.bgColor,1);var n=notnull(this.getDataSeries()),a=e.getMinuteXPos(n.getFirstRelativeMinute()),r=e.getMinuteXPos(n.getLastRelativeMinute());a<e.my_minx&&(a=e.my_minx),r>e.my_maxx&&(r=e.my_maxx),i.lineStyle(0,this.borderColor,1),i.drawRect(a,e.my_miny-1,r-a-1,e.my_maxy-e.my_miny),t&&i.endFill()}},SparklineLayer.prototype.drawLine=function(e,i,n,a,r){for(var o=notnull(this.getDataSeries()),s=o.units,l=this.getSkipInterval(r,o.units),h=r.length-1;h>=0&&r[h]>n;)h-=l;h=Math.min(h+l,r.length-1);var c=a.maxy,u=a.miny,d=a.maxx,g=a.minx,p=a.getXPos(d,g,s[n]),v=this.getYPos(c,u,s[n]),y=e.graphics;for(y.moveTo(p,a.maxy),y.lineStyle(0,0,0),y.lineTo(p,v),y.lineStyle(t.Const.LINE_CHART_LINE_THICKNESS,this.lineColor,t.Const.LINE_CHART_LINE_VISIBILITY);h>=0&&r[h]>=i;)y.lineTo(a.getXPos(d,g,s[r[h]]),this.getYPos(c,u,s[r[h]])),h-=l;h>=0&&y.lineTo(a.getXPos(d,g,s[r[h]]),this.getYPos(c,u,s[r[h]]));var f=a.getXPos(d,g,s[i]);return y.lineTo(f,this.getYPos(c,u,s[i])),f},SparklineLayer.prototype.renderLayer=function(t){var e=this.viewPoint,i=notnull(this.getDataSeries());if(0!==i.units.length){var n=i.fridays;e.sparkCount<=20*i.marketDayLength&&(n=i.days);var a=this.graphics;a.clear(),this.drawBackground(!0),a.beginFill(this.fillColor,1);var r=i.getRelativeMinuteIndex(e.getSparkLastMinute()+e.sparkButtonMinutes)+1,o=i.getRelativeMinuteIndex(e.getSparkFirstMinute()-e.sparkButtonMinutes);r=Math.min(r,i.units.length-1),o=Math.max(o,0),this.getMaxRange(o,r,n);var s=this.drawLine(this,o,r,e,n);a.lineStyle(0,0,0);var l=new flash.display.Point(s,e.my_maxy);a.lineTo(l.x,l.y),a.endFill(),this.drawBackground(!1)}},SparklineLayer.prototype.checkMinMax=function(t){var e=this.LogPreserveSign(t);e<this.minPriceLog?this.minPriceLog=e:e>this.maxPriceLog&&(this.maxPriceLog=e)},SparklineLayer.prototype.LogPreserveSign=function(t){return t>0?Math.log(t):t<0?-Math.log(-t):0},SparklineLayer.prototype.getMaxRange=function(t,e,i){var n=notnull(this.getDataSeries()).units;this.minPriceLog=Number.POSITIVE_INFINITY,this.maxPriceLog=Number.NEGATIVE_INFINITY;for(var a=i.length-1;a>=0&&i[a]>e;)a--;for(a=Math.min(a+1,i.length-1);a>=0&&i[a]>=t;)this.checkMinMax(n[i[a]].close),a--;this.checkMinMax(n[e].close),this.checkMinMax(n[t].close)},SparklineLayer.prototype.getSkipInterval=function(t,e){if(t.length<2||e.length<2)return 1;var i=t.length-1,n=e[t[i]].relativeMinutes-e[t[i-1]].relativeMinutes,a=this.viewPoint.getIntervalLength(n);if(0===a)return 1;for(var r=1;r*a<this.viewPoint.POINTS_DISTANCE;)r=Number(2*r);return r},SparklineLayer}(t.AbstractLayer);t.SparklineLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){return function SkipInterval(t,e){this.skip=t,this.interval=e}}();t.SkipInterval=e;var i=function(){return function EventCallback(t,e){this.func=t,this.param=e}}();t.EventCallback=i;var n=function(t){function IViewPoint(e){var i=t.call(this)||this;return i.displayManager=e,i.minutesOffset=0,i}return __extends(IViewPoint,t),IViewPoint}(flash.display.Sprite);t.IViewPoint=n;var a=function(i){function ViewPoint(t){var e=i.call(this,t)||this;return e.topCanvas=new flash.display.Sprite("topCanvas"),e.lastNotifyMinute=0,e.firstNotifyMinute=0,e.unitsPerUnit=3,e.descriptiveLayers=[],e.drawingLayers=[],e.POINTS_DISTANCE=1.5,e.V_OFFSET=2,e.medPriceY=0,e.bottomTextHeight=0,e.bg=new flash.display.Sprite("bg"),e.addChild(e.bg),e.textCanvas=new flash.display.Sprite("textCanvas"),e.addChild(e.textCanvas),e.addChild(e.topCanvas),e.dateTextFormat=new flash.text.TextFormat("Verdana",9,0),e.hourTextFormat=new flash.text.TextFormat("Verdana",9,0),e.priceTextFormat=new flash.text.TextFormat("Verdana",10,0),e.priceTextFormat.align=flash.text.TextFormatAlign.RIGHT,e.medPriceY=(e.maxy-e.miny)/2,e.maxPriceRangeViewSize=e.maxy-e.miny-ViewPoint.MIN_EDGE_DISTANCE-ViewPoint.MAX_EDGE_DISTANCE,e.lastMinute=0,e}return __extends(ViewPoint,i),ViewPoint.sessionVisible=function(t,e,i){var n=i.lastMinute,a=i.lastMinute-i.count;return!!(t&&t.relativeMinutes>=a&&t.relativeMinutes<=n)||(!!(e&&e.relativeMinutes>=a&&e.relativeMinutes<=n)||t.relativeMinutes<=a&&e.relativeMinutes>=n)},ViewPoint.prototype.getIntervalLength=function(t){return t*(this.maxx-this.minx)/this.count},ViewPoint.prototype.getBaseDataSource=function(){if(this.myController){var t=this.myController.mainManager.layersManager;if(t)return t.getFirstDataSource()}return null},ViewPoint.prototype.clearTextCanvas=function(){t.Utils.removeAllChildren(this.textCanvas)},ViewPoint.prototype.adjustBarChartContext=function(e,i){var n=e.count,a=e.lastMinute,r=(this.getMarketDayLength()+1)*t.Const.INTERVAL_PERIODS[i].maxdays,o=(this.getMarketDayLength()+1)*t.Const.INTERVAL_PERIODS[i].mindays;n>r?n=r:n<o&&(n=o);var s=this.getBaseDataSource();if(s){var l=t.Const.getDetailLevelInterval(i),h=s.data.getPointsInIntervalArray(l);if(h&&h.length>0){var c=a-Math.max(s.firstOpenRelativeMinutes,h[0].relativeMinutes);c<o?(n=o,a+=o-c):n>c&&(n=c)}}return n!==e.count?this.getNewContext(a,n):e},ViewPoint.prototype.trySnapping=function(){if(Boolean(t.MainManager.paramsObj.snapping)&&this.getBaseDataSource()){var e=this.getSnapLevel(),i=this.getClosestPoint(this.getLastMinute(),e);this.getIntervalLength(Math.abs(i.relativeMinutes-this.getLastMinute()))<15&&(this.minutesOffset+=i.relativeMinutes-this.getLastMinute())}},ViewPoint.prototype.getIntervalForLength=function(t,e){return e*t.count/(this.maxx-this.minx)},ViewPoint.prototype.removeAllLayers=function(){for(var t=0,e=this.drawingLayers;t<e.length;t++){var i=e[t];this.removeChild(i)}for(var n=0,a=this.descriptiveLayers;n<a.length;n++){i=a[n];this.removeChild(i)}this.drawingLayers=[],this.descriptiveLayers=[]},ViewPoint.prototype.getQuoteType=function(){return this.myController?this.myController.mainManager.getQuoteType():t.QuoteTypes.COMPANY},ViewPoint.prototype.getSnapLevel=function(){var e=notnull(this.getBaseDataSource()).data,i=this.minutePix*e.marketDayLength;return i>40?t.Snaps.SNAP_DAY:i>15?t.Snaps.SNAP_WEEK:20*i>40?t.Snaps.SNAP_MONTH:t.Snaps.SNAP_YEAR},ViewPoint.addTextField=function(t,e,i,n,a,r,o,s,l){var h=new flash.text.TextField;return h.x=i,h.y=n,h.width=a,h.height=r,s.align=o,h.defaultTextFormat=s,h.selectable=!1,"center"===o&&(h.x=i+a/2,h.width=0,h.autoSize=flash.text.TextFieldAutoSize.CENTER),l&&(h.autoSize=l),h.text=e,t.addChild(h),h},ViewPoint.prototype.removeLayer=function(t,e){var i=this.getLayerIndex(t,this.drawingLayers,e);-1!==i&&(this.removeChild(this.drawingLayers[i]),this.drawingLayers.splice(i,1)),-1!==(i=this.getLayerIndex(t,this.descriptiveLayers,e))&&(this.removeChild(this.descriptiveLayers[i]),this.descriptiveLayers.splice(i,1))},ViewPoint.prototype.getXPos=function(t){return this.getMinuteXPos(t.relativeMinutes)},ViewPoint.prototype.generateEvent=function(e,i,n,a){void 0===n&&(n=t.ChartEventPriorities.OPTIONAL);var r=t.EventFactory.getEvent(e,i.quoteName,n);r.callbacks=a;var o=this.displayManager.mainManager.dataManager;o.expectEvent(r),o.eventHandler(r)},ViewPoint.prototype.addLayer=function(e,i,n){var a;if(""===e)return null;try{a=getDefinitionByName("com.google.finance."+e)}catch(t){return console.log("com.google.finance."+e+" was not found"),null}var r=new a(this,i);return r.textCanvas=this.textCanvas,r.layerType=e,r.layerId=n,r instanceof t.AbstractDrawingLayer?this.drawingLayers.push(r):this.descriptiveLayers.push(r),this.addChild(r),t.Utils.displayObjectToTop(this.textCanvas,this),t.Utils.displayObjectToTop(this.topCanvas,this),r},ViewPoint.prototype.highlightPoint=function(t,e){for(var i=0,n=this.drawingLayers;i<n.length;i++){n[i].highlightPoint(this.layersContext,t,e)}},ViewPoint.prototype.getNewestMinute=function(){for(var t=0,e=0,i=this.drawingLayers;e<i.length;e++){var n=i[e].getNewestMinute();t<n&&(t=n)}return t},ViewPoint.prototype.getLastMinute=function(){return this.lastMinute+this.minutesOffset},ViewPoint.prototype.checkEvents=function(e,i){void 0===e&&(e=t.Intervals.INVALID);var n=!1,a=this.getBaseDataSource();if(a){var r=a.data.days.length-1,o=t.DataSource.getMinuteMetaIndex(this.lastMinute-this.count,a.data.days,a.data.units),s=t.DataSource.getMinuteMetaIndex(this.lastMinute,a.data.days,a.data.units);r-s<=t.Const.INTRADAY_DAYS&&s-o<=t.Const.INTRADAY_DAYS&&this.generateEventForAllSources(t.ChartDetailTypes.GET_5D_DATA);var l=r-o;if(t.Const.INDICATOR_ENABLED&&!this.displayManager.isDifferentMarketSessionComparison()){n=!this.myController||this.myController.currentIntervalLevel===t.Intervals.INVALID;var h=this.displayManager.hasOhlcRequiredIndicator()||!n?t.ChartEventPriorities.OHLC_REQUIRED:t.ChartEventPriorities.OPTIONAL;switch(e!==t.Intervals.INVALID?e:this.getDetailLevelForTechnicalStyle()){case t.Intervals.INTRADAY:if(this.generateEventForAllSources(t.ChartDetailTypes.GET_5D_DATA,h,i),(Boolean(t.MainManager.paramsObj.forceDisplayExtendedHours)||Boolean(t.MainManager.paramsObj.displayExtendedHours))&&this.generateEventForAllSources(t.ChartDetailTypes.GET_AH_DATA,h),this.getFirstMinute()===this.getOldestBaseMinute()){this.generateEventForAllSources(t.ChartDetailTypes.GET_1Y_DATA,h);break}break;case t.Intervals.FIVE_MINUTES:if(this.generateEventForAllSources(t.ChartDetailTypes.GET_1Y_DATA,h),this.generateEventForAllSources(t.ChartDetailTypes.GET_10D_DATA,h,i),n&&(Boolean(t.MainManager.paramsObj.forceDisplayExtendedHours)||Boolean(t.MainManager.paramsObj.displayExtendedHours))){this.generateEventForAllSources(t.ChartDetailTypes.GET_AH_DATA,h);break}break;case t.Intervals.HALF_HOUR:if(this.generateEventForAllSources(t.ChartDetailTypes.GET_1Y_DATA,h),this.generateEventForAllSources(t.ChartDetailTypes.GET_30D_DATA,h,i),n&&(Boolean(t.MainManager.paramsObj.forceDisplayExtendedHours)||Boolean(t.MainManager.paramsObj.displayExtendedHours))){this.generateEventForAllSources(t.ChartDetailTypes.GET_AH_DATA,h);break}break;case t.Intervals.DAILY:this.generateEventForAllSources(t.ChartDetailTypes.GET_1Y_DATA,h,i);break;case t.Intervals.WEEKLY:this.generateEventForAllSources(t.ChartDetailTypes.GET_5Y_DATA,h,i)}}else this.displayManager.isDifferentMarketSessionComparison()&&this.generateEventForAllSources(t.ChartDetailTypes.GET_5Y_DATA),this.generateEventForAllSources(t.ChartDetailTypes.GET_1Y_DATA);l>=t.Const.DAILY_DAYS&&this.generateEventForAllSources(t.ChartDetailTypes.GET_40Y_DATA)}},ViewPoint.prototype.getDetailLevelForDifferentMarketSessionComparison=function(e,i){return void 0===e&&(e=NaN),void 0===i&&(i=NaN),isNaN(e)&&(e=this.count),isNaN(i)&&(i=this.getLastMinute()),e-i<=t.Const.DAILY_DAYS?t.Intervals.DAILY:t.Intervals.WEEKLY},ViewPoint.prototype.getLayers=function(){return[].concat(this.drawingLayers,this.descriptiveLayers)},ViewPoint.prototype.clearAllChildrenFromTopCanvas=function(){for(;this.topCanvas.numChildren>0;)this.topCanvas.removeChildAt(0)},ViewPoint.prototype.getClosestPoint=function(e,i){var n,a=notnull(this.getBaseDataSource()).data;switch(i){default:throw new Error;case t.Snaps.SNAP_DAY:n=a.days;break;case t.Snaps.SNAP_WEEK:n=a.fridays;break;case t.Snaps.SNAP_MONTH:n=a.firsts;break;case t.Snaps.SNAP_YEAR:n=a.years}var r,o=t.DataSource.getMinuteMetaIndex(e,n,a.units);r=n===a.days?a.units[n[o]]:a.units[n[o]-1];var s=this.getIntervalLength(e-r.relativeMinutes);if(o<n.length-1){var l=void 0;return l=n===a.days?a.units[n[o+1]]:a.units[n[o+1]-1],this.getIntervalLength(l.relativeMinutes-e)<s?l:r}return r},ViewPoint.prototype.getOldestBaseMinute=function(){var t=this.getBaseDataSource();return t?t.data.getFirstRelativeMinute():0},ViewPoint.prototype.isAnimating=function(){return!!this.zoomingFinalState},ViewPoint.prototype.zoomInMinutes_Handler=function(e,i){var n;void 0===i&&(i=!1),(n=t.Const.INDICATOR_ENABLED&&this.myController&&this.myController.currentIntervalLevel!==t.Intervals.INVALID?this.adjustBarChartContext(e,this.myController.currentIntervalLevel):this.adjustLineChartContext(e))&&(this.setNewCount(Math.floor(n.count),i),this.lastMinute=n.lastMinute,this.update(n),this.checkEvents())},ViewPoint.prototype.generateEventForAllSources=function(e,i,n){void 0===i&&(i=t.ChartEventPriorities.OPTIONAL);for(var a=0,r=this.drawingLayers;a<r.length;a++){var o=r[a];this.generateEvent(e,o.dataSource,i,n)}},ViewPoint.prototype.zoomIn_Handler=function(t,e){var i=1*(e-t)*this.count/(this.maxx-this.minx),n=Math.abs(this.getOldestBaseMinute());i=Math.min(i,n);var a=this.lastMinute-this.count*(this.maxx-e)/(this.maxx-this.minx),r=this.getNewContext(a,i);this.zoomInMinutes_Handler(r)},ViewPoint.prototype.getOldestMinute=function(){for(var t=0,e=0,i=this.drawingLayers;e<i.length;e++){var n=i[e].getOldestMinute();t>n&&(t=Number(n))}return t},ViewPoint.prototype.zoomingAnimation_ticker=function(e,i,n){for(var a=e.zoomingInitialState,r=notnull(e.zoomingFinalState),o=t.Utils.cloneObject(a),s=0,l=Object.keys(a);s<l.length;s++){var h=l[s];isNaN(a[h])||isNaN(r[h])||(o[h]=a[h]+(r[h]-a[h])*(1-i))}e.zoomInMinutes_Handler(o),0===i&&(e.HTMLnotify(n),e.zoomingFinalState=null),this.displayManager.showContextualStaticInfo()},ViewPoint.prototype.renderLayers=function(){for(var t=0,e=this.drawingLayers;t<e.length;t++){e[t].renderLayer(this.layersContext)}for(var i=0,n=this.descriptiveLayers;i<n.length;i++){n[i].renderLayer(this.layersContext)}},ViewPoint.prototype.getLastDataUnit=function(e){var i=null,n=null;if(e)i=e;else if(!(i=(n=this.getBaseDataSource())?n.data:null))return null;if(this.getLastMinute()===this.getNewestMinute()){var a=i.units,r=new t.DataUnit(-1,-1,-1,-1);return r.exchangeDateInUTC=a[a.length-1].exchangeDateInUTC,r.close=a[a.length-1].close,r.time=(new Date).getTime(),r.relativeMinutes=0,r.time<a[a.length-1].time&&(r.time=a[a.length-1].time),r}return n?n.getVisibleDataUnitForMinute(this.getLastMinute()):i.units[i.getRelativeMinuteIndex(this.getLastMinute())]},ViewPoint.prototype.getDetailLevel=function(e,i,n){if(void 0===e&&(e=NaN),void 0===i&&(i=NaN),this.displayManager.isDifferentMarketSessionComparison())return this.getDetailLevelForDifferentMarketSessionComparison(e,i);var a=this.minutePix,r=this.getLastMinute(),o=this.getBaseDataSource(),s=this.count;if(isNaN(e)||(a=(this.maxx-this.minx)/e,s=e),isNaN(a)||!o)return t.Intervals.INVALID;isNaN(i)||(r=i),n&&(o=n);var l=o.data;if(!l)return t.Intervals.INVALID;var h=o.data.allSessionsLength()+1,c=h;o.afterHoursData&&(c+=o.afterHoursData.allSessionsLength()+o.afterHoursData.dataSessions.length());var u=l.getRelativeMinuteIndex(r),d=l.units[u].time;return s<=t.Const.INTRADAY_DAYS*c?l.intervalDataContainsTime(d,t.Const.INTRADAY_INTERVAL)||l.intervalDataPreceedsTime(d,t.Const.INTRADAY_INTERVAL)?t.Intervals.INTRADAY:l.intervalDataContainsTime(d,t.Const.DAILY_INTERVAL,t.Const.INTRADAY_INTERVAL)?t.Intervals.DAILY:t.Intervals.WEEKLY:s<=t.Const.DAILY_DAYS*h&&(l.intervalDataContainsTime(d,t.Const.INTRADAY_INTERVAL,t.Const.DAILY_INTERVAL)||l.intervalDataPreceedsTime(d,t.Const.DAILY_INTERVAL))?t.Intervals.DAILY:t.Intervals.WEEKLY},ViewPoint.prototype.getFirstDataUnit=function(){var t=this.getBaseDataSource();return t?t.getClosestDataUnitAfterMinute(this.getFirstMinute()):null},ViewPoint.prototype.getDisplayManager=function(){return this.displayManager},ViewPoint.prototype.getDetailLevelForTechnicalStyle=function(e,i){if(void 0===e&&(e=NaN),void 0===i&&(i=NaN),this.displayManager.isDifferentMarketSessionComparison())return this.getDetailLevelForDifferentMarketSessionComparison(e,i);if(this.myController&&this.myController.currentIntervalLevel!==t.Intervals.INVALID)return this.myController.currentIntervalLevel;var n=isNaN(i)?this.getLastMinute():i,a=isNaN(e)?this.count:e,r=this.getQuoteType(),o=this.getBaseDataSource();if(r===t.QuoteTypes.COMPANY)if(o){var s=o.data.getPointsInIntervalArray(t.Const.INTRADAY_INTERVAL);if(s&&s.length>0&&Math.abs(n-a)<=Math.abs(s[0].relativeMinutes)+1)return t.Intervals.INTRADAY;var l=o.data.getPointsInIntervalArray(t.Const.FIVE_MINUTE_INTERVAL);if(l&&l.length>0&&Math.abs(n-a)<=Math.abs(l[0].relativeMinutes)+1)return t.Intervals.FIVE_MINUTES}else if(t.Const.DEFAULT_CHART_STYLE_NAME!==t.Const.LINE_CHART)return t.Const.DEFAULT_D;var h=Math.abs(n-a)/(this.getMarketDayLength()+1)+1,c=o?o.data:null;return!(h<=t.Const.FIVE_MINUTE_DAYS&&r===t.QuoteTypes.COMPANY)||c&&c.hasNoPointsInIntervalArray(t.Const.FIVE_MINUTE_INTERVAL)?!(h<=t.Const.HALF_HOUR_DAYS&&r===t.QuoteTypes.COMPANY)||c&&c.hasNoPointsInIntervalArray(t.Const.HALF_HOUR_INTERVAL)?!(h<=t.Const.DAILY_DAYS)||c&&c.hasNoPointsInIntervalArray(t.Const.DAILY_INTERVAL)?t.Intervals.WEEKLY:t.Intervals.DAILY:t.Intervals.HALF_HOUR:t.Intervals.FIVE_MINUTES},ViewPoint.prototype.getMarketDayLength=function(){var e=this.getBaseDataSource();return e?e.data.marketDayLength:t.Const.MARKET_DAY_LENGTH},ViewPoint.prototype.setController=function(e){e.addControlListener(this);var i=new t.Bounds(this.minx,this.miny,this.maxx,this.maxy);e.addBounds(i),this.myController=e},ViewPoint.prototype.checkAfterHoursVisibility=function(e,i){if(this.displayManager.layersManager.getStyle()===t.LayersManager.SINGLE&&"true"===t.MainManager.paramsObj.displayExtendedHours)if(t.Const.INDICATOR_ENABLED){var n=this.getDetailLevelForTechnicalStyle(e);(a=this.getDetailLevelForTechnicalStyle(i))>=t.Intervals.DAILY&&n<t.Intervals.DAILY?this.displayManager.toggleAllAfterHoursSessions(!1):n>=t.Intervals.DAILY&&a<t.Intervals.DAILY&&this.displayManager.toggleAllAfterHoursSessions(!0)}else{var a;n=this.getDetailLevel(e);(a=this.getDetailLevel(i))>t.Intervals.INTRADAY&&n===t.Intervals.INTRADAY?this.displayManager.toggleAllAfterHoursSessions(!1):n>t.Intervals.INTRADAY&&a===t.Intervals.INTRADAY&&this.displayManager.toggleAllAfterHoursSessions(!0)}},ViewPoint.prototype.getLayer=function(t,e){var i=this.getLayerIndex(t,this.drawingLayers,e);return-1!==i?this.drawingLayers[i]:-1!==(i=this.getLayerIndex(t,this.descriptiveLayers,e))?this.descriptiveLayers[i]:null},ViewPoint.prototype.getFirstMinute=function(){return this.lastMinute+this.minutesOffset-this.count},ViewPoint.prototype.moveChartBy_Handler=function(e){for(var i=Math.floor(this.lastMinute-Number(e/this.POINTS_DISTANCE)*this.unitsPerUnit),n=Math.ceil(i-this.count),a=0,r=this.drawingLayers;a<r.length;a++){var o=r[a].dataSource;n<o.data.getFirstRelativeMinute()&&t.Const.getZoomLevel(this.count,o.data.marketDayLength)>=t.ScaleTypes.SCALE_5D&&this.generateEvent(t.ChartDetailTypes.GET_1Y_DATA,o)}var s=Math.abs(this.getOldestBaseMinute());if(!(this.count>s)){var l=Number(this.getOldestBaseMinute());if(t.Const.INDICATOR_ENABLED&&this.myController&&this.myController.currentIntervalLevel!==t.Intervals.INVALID){var h=this.getBaseDataSource();if(h){var c=h.data.getPointsInIntervalArray(t.Const.getDetailLevelInterval(this.myController.currentIntervalLevel));l=Number(c&&0!==c.length?Math.max(c[0].relativeMinutes,h.firstOpenRelativeMinutes):0)}else l=0}var u=this.lastMinute+this.minutesOffset;if(n<l)return this.minutesOffset=l+this.count-this.lastMinute,this.checkAfterHoursVisibilityWhenChartMoved(u),void this.update();var d=this.getNewestMinute();i<=d?this.minutesOffset=-Math.floor(Number(e/this.POINTS_DISTANCE)*this.unitsPerUnit):i>d&&(this.minutesOffset=d-this.lastMinute),this.checkAfterHoursVisibilityWhenChartMoved(u),this.trySnapping(),this.update()}},ViewPoint.prototype.zoomChart_Handler=function(e,i){void 0===i&&(i=NaN);var n=Math.floor(this.count/40);isNaN(i)||(n*=i),n=Math.max(n,ViewPoint.MIN_ZOOM_CHART_AMOUNT);var a=this.POINTS_DISTANCE*n/this.unitsPerUnit;switch(e){case t.Directions.BACKWARD:this.zoomIn_Handler(this.minx-a,this.maxx);break;case t.Directions.FORWARD:this.zoomIn_Handler(this.minx+a,this.maxx)}},ViewPoint.prototype.commitOffset_Handler=function(){this.lastMinute+=this.minutesOffset,this.minutesOffset=0,this.update(),this.checkEvents()},ViewPoint.prototype.getLastNotVisibleDataUnit=function(){var t=notnull(this.getBaseDataSource()).data;return t?t.units[t.getRelativeMinuteIndex(this.getFirstMinute())]:null},ViewPoint.prototype.HTMLnotify=function(t){void 0===t&&(t=!1);var e=this.getLastMinute()-this.lastNotifyMinute,i=this.minutePix*e,n=this.getFirstMinute()-this.firstNotifyMinute,a=this.minutePix*n;(Math.abs(a)>20||Math.abs(i)>20)&&(this.displayManager.HTMLnotify(this.name,t),this.lastNotifyMinute=this.getLastMinute(),this.firstNotifyMinute=this.getFirstMinute())},ViewPoint.prototype.adjustLineChartContext=function(t){var e=t.count,i=t.lastMinute,n=this.getMinDisplayMinutes(this.getBaseDataSource());if(e<n&&(e=n,this.count===e))return null;var a=Math.abs(i-this.getOldestBaseMinute());if(e=Math.min(e,a),this.POINTS_DISTANCE*e/(this.maxx-this.minx)<.3&&!this.displayManager.isDifferentMarketSessionComparison())return null;var r=this.getNewestMinute();return i>=r&&(i=r),e!==t.count||i!==t.lastMinute?this.getNewContext(i,e):t},ViewPoint.prototype.update=function(t){this.stage&&0!==this.stage.stageWidth&&(t?this.layersContext=t:this.forcedLayersContext?this.layersContext=this.forcedLayersContext:this.precomputeContexts(),this.clearTextCanvas(),this.renderLayers())},ViewPoint.prototype.addLabel=function(t){this.myLabel=new flash.text.TextField,this.myLabel.text="Volume (millions)",this.myLabel.x=this.minx+5,this.myLabel.y=this.miny+5,this.addChild(this.myLabel)},ViewPoint.prototype.setNewCount=function(t,e){void 0===e&&(e=!1),isNaN(t)||(!0!==e&&this.checkAfterHoursVisibility(this.count,t),this.count=t,this.unitsPerUnit=this.POINTS_DISTANCE*this.count/(this.maxx-this.minx),this.minutePix=(this.maxx-this.minx)/this.count)},ViewPoint.prototype.getSkipInterval=function(i,n){void 0===i&&(i=NaN),void 0===n&&(n=NaN);var a,r=this.minutePix,o=t.Const.INTRADAY_INTERVAL/60,s=1;switch(isNaN(i)?a=Number(this.getDetailLevel()):(r=(this.maxx-this.minx)/i,a=Number(this.getDetailLevel(i,n))),a){case t.Intervals.INTRADAY:for(;r*s*o<this.POINTS_DISTANCE;)s=Number(2*s);return new e(s,s*t.Const.INTRADAY_INTERVAL);case t.Intervals.DAILY:return new e(1,t.Const.DAILY_INTERVAL);case t.Intervals.WEEKLY:for(var l=5*r*this.getMarketDayLength();s*l<this.POINTS_DISTANCE;)s=Number(2*s);return new e(s,s*t.Const.WEEKLY_INTERVAL);default:return new e(0,-1)}},ViewPoint.prototype.newFinalAnimationState=function(t){var e=Math.max(t.count,this.getMinDisplayMinutes(this.getBaseDataSource()));this.zoomingFinalState=this.getNewContext(t.lastMinute,e)},ViewPoint.prototype.checkAfterHoursVisibilityWhenChartMoved=function(e){if(t.Const.INDICATOR_ENABLED&&this.displayManager.layersManager.getStyle()===t.LayersManager.SINGLE&&"true"===t.MainManager.paramsObj.displayExtendedHours){var i=this.getDetailLevelForTechnicalStyle(this.count,e),n=this.getDetailLevelForTechnicalStyle();n>=t.Intervals.DAILY&&i<t.Intervals.DAILY?this.displayManager.toggleAllAfterHoursSessions(!1):i>=t.Intervals.DAILY&&n<t.Intervals.DAILY&&this.displayManager.toggleAllAfterHoursSessions(!0)}},ViewPoint.prototype.addChildToTopCanvas=function(t){this.topCanvas.addChild(t)},ViewPoint.prototype.updateObjectLayers=function(){for(var e=0,i=this.descriptiveLayers;e<i.length;e++){var n=i[e];(n instanceof t.PinPointsLayer||n instanceof t.IntervalBasedPinPointsLayer||n instanceof t.IndependentObjectsLayer||n instanceof t.IntervalBasedIndependentObjectsLayer)&&n.renderLayer(this.layersContext)}},ViewPoint.prototype.drawBorders=function(){var t=this.bg.graphics;t.clear(),t.beginFill(16777215,1),t.drawRect(this.minx,this.miny,this.maxx-this.minx,this.maxy-this.miny),t.endFill(),t.lineStyle(0,ViewPoint.BORDER_DARK_COLOR,1),t.moveTo(this.minx-1,this.miny),t.lineTo(this.maxx,this.miny),t.lineTo(this.maxx,this.maxy),t.lineStyle(0,ViewPoint.BORDER_LIGHT_COLOR,1),t.lineTo(this.minx-1,this.maxy),t.lineStyle(0,ViewPoint.BORDER_DARK_COLOR,1),t.lineTo(this.minx-1,this.miny)},ViewPoint.prototype.clearPointInformation=function(){for(var t=0,e=this.drawingLayers;t<e.length;t++){e[t].clearHighlight()}},ViewPoint.prototype.getNewContext=function(e,i){var n=new r;n.lastMinute=e,n.count=Math.round(i),n.verticalScaling=t.MainManager.paramsObj.verticalScaling;for(var a=0,o=this.drawingLayers;a<o.length;a++){n=o[a].getContext(n)}return n},ViewPoint.prototype.getMinuteXPos=function(t){return this.maxx-(this.getLastMinute()-t)*this.minutePix},ViewPoint.prototype.getNumberOfDays=function(){return Math.round(this.count/t.Const.MARKET_DAY_LENGTH)},ViewPoint.prototype.newLastMinute_Handler=function(t){var e=this.getOldestBaseMinute();t-this.count<e&&(t=Number(e+this.count)),t>0&&(t=0),this.lastMinute=t,this.update()},ViewPoint.prototype.getLayerIndex=function(t,e,i){for(var n=0;n<e.length;n++){var a=e[n];if(a.layerId===t&&(!i||a.dataSource===i))return n}return-1},ViewPoint.prototype.precomputeContexts=function(){if(this.layersContext=this.getNewContext(this.getLastMinute(),this.count),this.zoomingFinalState){var t=this.zoomingFinalState.lastMinute,e=this.zoomingFinalState.count;this.zoomingFinalState=this.getNewContext(t,e)}},ViewPoint.prototype.getMinDisplayMinutes=function(e){var i=t.Const.MARKET_DAY_LENGTH;return e&&!isNaN(e.data.marketDayLength)&&(i=e.data.marketDayLength+1),t.Const.INDICATOR_ENABLED&&this.myController&&this.myController.currentIntervalLevel!==t.Intervals.INVALID?t.Const.INTERVAL_PERIODS[this.myController.currentIntervalLevel].mindays*i:this.displayManager.isDifferentMarketSessionComparison()?t.Const.DIF_MKT_COMPARISON_MIN_DISPLAY_DAYS:t.Const.MIN_DISPLAY_DAYS*i},ViewPoint.prototype.zoomingAnimation_init=function(e){this.zoomingInitialState=t.Utils.cloneObject(this.layersContext),this.newFinalAnimationState(e)},ViewPoint.prototype.getMinuteOfX=function(t){return this.getLastMinute()-(this.maxx-t)*this.count/(this.maxx-this.minx)},ViewPoint.prototype.setNewSize=function(e){if(this.minx!==e.minx||this.miny!==e.miny||this.maxx!==e.maxx||this.maxy!==e.maxy){if(this.myController){var i=new t.Bounds(this.minx,this.miny,this.maxx,this.maxy);this.myController.replaceBounds(i,e)}this.minx=e.minx,this.miny=e.miny,this.maxx=e.maxx,this.maxy=e.maxy,this.drawBorders(),this.myLabel&&(this.myLabel.x=this.minx+5,this.myLabel.y=this.miny+5),this.medPriceY=(this.maxy-this.miny)/2,this.maxPriceRangeViewSize=this.maxy-this.miny-ViewPoint.MIN_EDGE_DISTANCE-ViewPoint.MAX_EDGE_DISTANCE;var n=(this.maxx-this.minx)*this.unitsPerUnit/this.POINTS_DISTANCE;if(t.Const.INDICATOR_ENABLED&&this.myController&&this.myController.currentIntervalLevel!==t.Intervals.INVALID){var a=new r;a.count=n,a.lastMinute=this.lastMinute,a=this.adjustBarChartContext(a,this.myController.currentIntervalLevel),this.lastMinute=a.lastMinute,this.count=a.count,this.unitsPerUnit=this.count*this.POINTS_DISTANCE/(this.maxx-this.minx)}else this.count=Math.min(n,Math.abs(this.lastMinute-this.getOldestBaseMinute()));this.minutePix=(this.maxx-this.minx)/this.count,this.precomputeContexts(),this.update()}},ViewPoint.MIN_DISTANCE_BETWEEN_V_LINES=100,ViewPoint.GRID_TEXT_VERTICAL_OFFSET=3,ViewPoint.TICK_SIZE_SMALL=3,ViewPoint.TICK_SIZE_BIG=5,ViewPoint.TICK_SIZE_NONE=0,ViewPoint.BORDER_LIGHT_COLOR=14540253,ViewPoint.TEXT_VERTICAL_OFFSET=0,ViewPoint.BORDER_DARK_COLOR=13421772,ViewPoint.TEXT_FIELD_WIDTH=200,ViewPoint.MIN_DISTANCE_BETWEEN_H_LINES=60,ViewPoint.TEXT_HORIZONTAL_OFFSET=2,ViewPoint.TEXT_FIELD_HEIGHT=16,ViewPoint.MAX_EDGE_DISTANCE=25,ViewPoint.MIN_DISTANCE_BETWEEN_LOG_H_LINES=12,ViewPoint.MIN_EDGE_DISTANCE=20,ViewPoint.MIN_ZOOM_CHART_AMOUNT=6,ViewPoint}(n);t.ViewPoint=a;var r=function(){return function Context(){}}();t.Context=r}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function SparklineViewPoint(i,n){var a=e.call(this,n)||this;a.dataManager=i,a.displayManager=n,a.POINTS_DISTANCE=2,a.leftScrollButton=new flash.display.SimpleButton("leftScrollButton"),a.ScrollbarButtonRight=t.SparklineViewPoint_ScrollbarButtonRight,a.layers=[],a.passiveLayers=[],a.rightScrollButton=new flash.display.SimpleButton("rightScrollButton"),a.scrollBg=new flash.display.Sprite("scrollBg"),a.ScrollbarButtonLeft=t.SparklineViewPoint_ScrollbarButtonLeft,a.bg=new flash.display.Sprite("bg"),a.sparkMinutesOffset=0,a.priceTextFormat=new flash.text.TextFormat("_sans",10,6710886),a.dateTextFormat=new flash.text.TextFormat("Verdana",10,7303023),a.topBorder=0,a.addChild(a.bg),a.textCanvas=new flash.display.Sprite("textCanvas"),a.addChild(a.textCanvas),a.dateTextFormat.bold=!1,a.priceTextFormat.align="right";var r=new a.ScrollbarButtonLeft;a.leftScrollButton.downState=r,a.leftScrollButton.overState=r,a.leftScrollButton.upState=r,a.leftScrollButton.hitTestState=r,a.leftScrollButton.useHandCursor=!0,a.addChild(a.leftScrollButton);var o=new a.ScrollbarButtonRight;return a.rightScrollButton.downState=o,a.rightScrollButton.overState=o,a.rightScrollButton.upState=o,a.rightScrollButton.hitTestState=o,a.rightScrollButton.useHandCursor=!0,a.addChild(a.rightScrollButton),a.bg.addChild(a.scrollBg),a.positionElements(),a.leftScrollButton.addEventListener(MouseEvents.MOUSE_DOWN,flash.display.Stage.bind(a.onMouseDown,a)),a.rightScrollButton.addEventListener(MouseEvents.MOUSE_DOWN,flash.display.Stage.bind(a.onMouseDown,a)),a.leftScrollButton.addEventListener(MouseEvents.MOUSE_UP,flash.display.Stage.bind(a.onMouseUp,a)),a.rightScrollButton.addEventListener(MouseEvents.MOUSE_UP,flash.display.Stage.bind(a.onMouseUp,a)),a.initDisplayCountThresholds(),t.MainManager.paramsObj.sparklineType===t.Const.STATIC||t.MainManager.paramsObj.sparklineType===t.Const.DYNAMIC?a.sparklineType=t.MainManager.paramsObj.sparklineType:a.sparklineType=t.Const.STATIC,a}return __extends(SparklineViewPoint,e),SparklineViewPoint.prototype.getIntervalLength=function(t){return t*(this.maxx-this.minx)/this.sparkCount},SparklineViewPoint.prototype.redraw=function(){this.adjustWindowToSparkline(),this.resetCanvas(),this.renderLayers(),this.moveMask(),this.renderPassiveLayers()},SparklineViewPoint.prototype.removeAllLayers=function(){for(var t=0,e=this.layers;t<e.length;t++){var i=e[t];this.removeChild(i)}this.layers=[]},SparklineViewPoint.prototype.setNewSize=function(e){this.my_minx=e.minx,this.my_miny=e.miny,this.my_maxx=e.maxx,this.my_maxy=e.maxy,this.drawBorders(),this.positionElements(),this.sparkline&&(this.sparkline.fillColor=t.Const.SPARK_ACTIVE_FILL_COLOR,this.sparkline.lineColor=t.Const.SPARK_ACTIVE_LINE_COLOR,this.sparkline.renderLayer()),this.graySparkline&&(this.graySparkline.fillColor=t.Const.SPARK_INACTIVE_FILL_COLOR,this.graySparkline.lineColor=t.Const.SPARK_INACTIVE_LINE_COLOR,this.graySparkline.renderLayer()),this.windowLayer&&(this.windowLayer.updateFixedElements(),this.update())},SparklineViewPoint.prototype.getWidth=function(){return this.maxx-this.minx},SparklineViewPoint.prototype.generateEvent=function(e,i){var n=t.EventFactory.getEvent(e,i.quoteName,t.ChartEventPriorities.OPTIONAL);this.dataManager.expectEvent(n),this.dataManager.eventHandler(n)},SparklineViewPoint.prototype.addLayer=function(e,i,n){if(""===e)return null;this.addDataSource(i);var a=new(getDefinitionByName("com.google.finance."+e))(this,i);if(a.name=n,a.layerId=n,a instanceof t.WindowLayer){if(this.windowLayer&&this.contains(this.windowLayer)){this.removeChild(this.windowLayer);var r=this.layers.indexOf(this.windowLayer);-1!==r&&this.layers.splice(r,1)}this.windowLayer=a}return this.addChild(a),this.layers.push(a),a},SparklineViewPoint.prototype.commitSparklineOffset_Handler=function(){this.sparkLastMinute+=this.sparkMinutesOffset,this.sparkMinutesOffset=0},SparklineViewPoint.prototype.adjustWindowToSparkline=function(){var t=this.getLastMinute(),e=this.getFirstMinute(),i=this.getSparkLastMinute(),n=this.getSparkFirstMinute();if(t>i)this.myController.jumpTo(i,t-e);else if(e<n){var a=t-e;this.myController.jumpTo(n+a,a)}},SparklineViewPoint.prototype.getLayers=function(){return this.layers},SparklineViewPoint.prototype.highlightPoint=function(t,e){},SparklineViewPoint.prototype.getSparkFirstMinute=function(){return this.getSparkLastMinute()-this.sparkCount},SparklineViewPoint.prototype.precomputeContexts=function(){},SparklineViewPoint.prototype.positionElements=function(){this.leftScrollButton.x=-1,this.leftScrollButton.y=this.maxy-1,this.rightScrollButton.x=this.maxx-1,this.rightScrollButton.y=this.maxy-1,this.scrollBg.x=this.minx,this.scrollBg.y=this.maxy-1,this.scrollBg.width=this.maxx-this.minx},SparklineViewPoint.prototype.replaceSparklineDataSource=function(t){this.sparkline.dataSource=t,this.graySparkline.dataSource=t},SparklineViewPoint.prototype.zoomIn_Handler=function(t,e){this.renderLayers(),this.moveMask()},SparklineViewPoint.prototype.getYScaling=function(){return{maxPriceRange:0}},SparklineViewPoint.prototype.getXPos=function(t,e,i){var n=this.getSparkLastMinute(),a=i.relativeMinutes;return Math.round(t-(n-a)*(t-e)/this.sparkCount)},SparklineViewPoint.prototype.zoomInMinutes_Handler=function(t,e){void 0===e&&(e=!1),this.checkResizeSparkline(t.count)},SparklineViewPoint.prototype.renderPassiveLayers=function(){for(var t=0,e=this.passiveLayers;t<e.length;t++){e[t].renderLayer()}},SparklineViewPoint.prototype.isAnimating=function(){return!1},SparklineViewPoint.prototype.toggleHandles=function(t){this.windowLayer&&this.windowLayer.toggleHandles(t)},SparklineViewPoint.prototype.getLastMinute=function(){return this.displayManager.getMainViewPoint().getLastMinute()},SparklineViewPoint.prototype.onMouseUp=function(t){this.myController.mouseUpAction()},SparklineViewPoint.prototype.moveMask=function(){if(this.windowMask){var t=this.getMinuteXPos(this.getLastMinute()),e=this.getMinuteXPos(this.getFirstMinute());t-e<=4&&(e=t-4),this.windowMask.x=e,this.windowMask.y=this.my_miny-1,this.windowMask.width=t-e}},SparklineViewPoint.prototype.createSparklineMask=function(){return this.windowMask=new flash.display.Sprite("windowMask"),this.windowMask.graphics.beginFill(0),this.windowMask.graphics.drawRect(0,0,10,this.my_maxy-this.my_miny+1),this.windowMask.y=this.my_miny-1,this.addChildAt(this.windowMask,3),this.windowMask},SparklineViewPoint.prototype.getMinutesForLength=function(t){return t*this.sparkCount/(this.maxx-this.minx)},Object.defineProperty(SparklineViewPoint.prototype,"miny",{get:function(){return this.my_miny},enumerable:!0,configurable:!0}),SparklineViewPoint.prototype.getOldestMinute=function(){return this.dataSource.data.getFirstRelativeMinute()},SparklineViewPoint.prototype.getMedPrice=function(){return{medPrice:0}},Object.defineProperty(SparklineViewPoint.prototype,"minx",{get:function(){return this.my_minx+14},enumerable:!0,configurable:!0}),SparklineViewPoint.prototype.getFirstDataUnit=function(){return notnull(this.displayManager.getMainViewPoint().getFirstDataUnit())},SparklineViewPoint.prototype.zoomingAnimation_ticker=function(t,e,i){t.checkResizeSparkline(),t.renderLayers(),t.moveMask()},SparklineViewPoint.prototype.renderLayers=function(){for(var t=0,e=this.layers;t<e.length;t++){e[t].renderLayer()}},SparklineViewPoint.prototype.getLastDataUnit=function(){return notnull(this.displayManager.getMainViewPoint().getLastDataUnit())},SparklineViewPoint.prototype.getLeftX=function(){return this.windowLayer?this.windowLayer.getLeftX():0},SparklineViewPoint.prototype.getHandleRightX=function(){return this.windowLayer?this.windowLayer.getHandleRightX():0},SparklineViewPoint.prototype.resetCanvas=function(){this.textCanvas.graphics.clear(),t.Utils.removeAllChildren(this.textCanvas)},Object.defineProperty(SparklineViewPoint.prototype,"maxy",{get:function(){return this.my_maxy-14},enumerable:!0,configurable:!0}),SparklineViewPoint.prototype.commitOffset_Handler=function(){this.renderLayers(),this.moveMask()},SparklineViewPoint.prototype.setController=function(e){e.addControlListener(this,t.TickPositions.BOTTOM),this.myController=e},SparklineViewPoint.prototype.getFirstMinute=function(){return this.displayManager.getMainViewPoint().getFirstMinute()},SparklineViewPoint.prototype.moveChartBy_Handler=function(t){this.adjustSparklineToWindow(),this.renderLayers(),this.moveMask()},SparklineViewPoint.prototype.getRightX=function(){return this.windowLayer?this.windowLayer.getRightX():0},SparklineViewPoint.prototype.getHandleLeftX=function(){return this.windowLayer?this.windowLayer.getHandleLeftX():0},SparklineViewPoint.prototype.HTMLnotify=function(t){void 0===t&&(t=!1)},Object.defineProperty(SparklineViewPoint.prototype,"maxx",{get:function(){return this.my_maxx-14},enumerable:!0,configurable:!0}),SparklineViewPoint.prototype.getLastNotVisibleDataUnit=function(){return notnull(this.displayManager.getMainViewPoint().getLastNotVisibleDataUnit())},SparklineViewPoint.prototype.zoomChart_Handler=function(t,e){void 0===e&&(e=NaN),this.renderLayers(),this.moveMask()},SparklineViewPoint.prototype.newFinalAnimationState=function(t){},SparklineViewPoint.prototype.onMouseDown=function(e){switch(e.currentTarget){case this.leftScrollButton.element:this.myController.mouseDownAction(t.ControllerComponents.LEFT_BUTTON);break;case this.rightScrollButton.element:this.myController.mouseDownAction(t.ControllerComponents.RIGHT_BUTTON)}},SparklineViewPoint.prototype.update=function(){if(0!==this.stage.stageWidth&&this.dataSource&&this.dataSource.data&&0!==this.dataSource.data.points.length){var e=this.dataSource.data.points,i=this.dataSource.data.getFirstRelativeMinute();this.dataSource&&0!==e.length&&(this.sparkCount!==Math.abs(i)&&this.sparklineType===t.Const.STATIC&&(this.sparkCount=Math.abs(i)),this.checkResizeSparkline(),this.resetCanvas(),this.renderPassiveLayers(),this.renderLayers(),this.moveMask())}},SparklineViewPoint.prototype.sparklinePagingPossible=function(t){var e=this.getSparkLastMinute()<0,i=this.getSparkFirstMinute()>this.getOldestMinute();return t<0&&i||t>0&&e},SparklineViewPoint.prototype.checkResizeSparkline=function(e){if(void 0===e&&(e=NaN),this.sparklineType!==t.Const.STATIC){var i=this.getLastMinute()-this.getFirstMinute();if(isNaN(e)||(i=e),this.dataSource&&this.dataSource.data){for(var n=this.dataSource.data.marketDayLength,a=0;a<this.displayThresholds.length-1&&i>this.displayThresholds[a].chartDays*n;)a++;var r=this.displayThresholds[a].sparkDays*n,o=Math.abs(this.dataSource.data.getFirstRelativeMinute());(r=Math.min(r,o))===this.sparkCount||isNaN(r)||(this.sparkCount=r,this.sparkButtonMinutes=(this.leftScrollButton.width-2)*this.sparkCount/(this.maxx-this.minx),this.sparkLastMinute-this.sparkCount<this.dataSource.data.getFirstRelativeMinute()&&(this.sparkLastMinute=0),a===this.displayThresholds.length-1&&this.generateEvent(t.ChartDetailTypes.GET_40Y_DATA,this.dataSource),this.redraw()),this.adjustSparklineToWindow()}}},SparklineViewPoint.prototype.setNewCount=function(t){this.checkResizeSparkline(t)},SparklineViewPoint.prototype.drawBorders=function(){var t=this.bg.graphics;t.clear(),t.beginFill(16777215),t.drawRect(this.my_minx,this.my_miny-this.topBorder,this.my_maxx-this.my_minx,this.my_maxy-(this.my_miny-this.topBorder)),t.endFill(),this.textCanvas.graphics.clear()},SparklineViewPoint.prototype.getMinuteXPos=function(t){return Math.round(this.maxx-(this.getSparkLastMinute()-t)*(this.maxx-this.minx)/this.sparkCount)},SparklineViewPoint.prototype.getSparkLastMinute=function(){return this.sparkLastMinute+this.sparkMinutesOffset},SparklineViewPoint.prototype.initDisplayCountThresholds=function(){var e=!1;if(t.MainManager.paramsObj.displayThresholds){this.displayThresholds=t.Utils.decodeObjects(t.MainManager.paramsObj.displayThresholds),e=!0;for(var i=0,n=this.displayThresholds;i<n.length;i++){var a=n[i];(isNaN(a.chartDays)||isNaN(a.sparkDays))&&(e=!1)}}e||(this.displayThresholds=[{chartDays:230,sparkDays:520},{chartDays:Number.POSITIVE_INFINITY,sparkDays:Number.POSITIVE_INFINITY}])},SparklineViewPoint.prototype.addDataSource=function(e){if(!this.dataSource){this.sparkMinutesOffset=0,this.sparklineType===t.Const.DYNAMIC?this.sparkCount=e.data.marketDayLength*this.displayThresholds[0].sparkDays:this.sparkCount=Math.abs(e.data.getFirstRelativeMinute()),this.sparkButtonMinutes=(this.leftScrollButton.width-2)*this.sparkCount/(this.my_maxx-this.my_minx),this.sparkLastMinute=0,this.graySparkline=new t.SparklineLayer(this,e),this.graySparkline.layerId="GraySparkline",this.graySparkline.fillColor=t.Const.SPARK_INACTIVE_FILL_COLOR,this.graySparkline.lineColor=t.Const.SPARK_INACTIVE_LINE_COLOR,this.addChildAt(this.graySparkline,1),this.graySparkline.hasBackground=!0,this.graySparkline.bgColor=16777215,this.graySparkline.borderColor=14540253,this.passiveLayers.push(this.graySparkline),this.sparkline=new t.SparklineLayer(this,e),this.sparkline.layerId="Sparkline",this.sparkline.fillColor=t.Const.SPARK_ACTIVE_FILL_COLOR,this.sparkline.lineColor=t.Const.SPARK_ACTIVE_LINE_COLOR,this.addChildAt(this.sparkline,2),this.sparkline.hasBackground=!0,this.sparkline.bgColor=16777215,this.sparkline.borderColor=16777215,this.passiveLayers.push(this.sparkline),this.windowMask=this.createSparklineMask();var i=new t.SparklineDateLinesLayer(this,e);i.textCanvas=this.textCanvas,this.addChild(i),this.passiveLayers.push(i)}this.rightScrollButton.enabled=!0,this.leftScrollButton.enabled=!0,this.dataSource=e,this.update()},SparklineViewPoint.prototype.clearPointInformation=function(){},SparklineViewPoint.prototype.moveSparklineBy_Handler=function(e){if(!this.dataSource||0===this.dataSource.data.points.length)return 0;if(this.sparklineType===t.Const.STATIC)return e;var i=e*this.sparkCount/(this.maxx-this.minx),n=this.sparkLastMinute+i-this.sparkCount,a=i;this.sparkLastMinute+i>0?i=-this.sparkLastMinute:n<this.getOldestMinute()&&(i=this.getOldestMinute()+this.sparkCount-this.sparkLastMinute,this.generateEvent(t.ChartDetailTypes.GET_40Y_DATA,this.dataSource));var r=this.displayManager.layersManager.getFirstDataSource();return this.myController.currentIntervalLevel!==t.Intervals.INVALID&&r&&(n=this.sparkLastMinute+i-this.sparkCount)>this.getOldestMinute()&&n<r.firstOpenRelativeMinutes&&(i=r.firstOpenRelativeMinutes+this.sparkCount-this.sparkLastMinute),i!==this.sparkMinutesOffset&&(this.sparkMinutesOffset=i,this.redraw()),0===a?0:e*(i/a)},SparklineViewPoint.prototype.adjustSparklineToWindow=function(){var t=this.getLastMinute(),e=this.getFirstMinute(),i=this.getSparkLastMinute(),n=this.getSparkFirstMinute();if(t>i&&t<=0)this.sparkLastMinute+=t-i;else{if(!(e<n))return;this.sparkLastMinute+=e-n}this.resetCanvas(),this.renderPassiveLayers(),this.renderLayers(),this.moveMask()},SparklineViewPoint.prototype.getMinuteOfX=function(t){return this.getSparkLastMinute()-(this.maxx-t)*this.sparkCount/(this.maxx-this.minx)},SparklineViewPoint.prototype.zoomingAnimation_init=function(t){},SparklineViewPoint.prototype.getNewContext=function(e,i){var n=new t.Context;return n.lastMinute=e,n.count=i,n},SparklineViewPoint.TEXT_FIELD_HEIGHT=50,SparklineViewPoint.TEXT_VERTICAL_OFFSET=-1,SparklineViewPoint.TEXT_HORIZONTAL_OFFSET=5,SparklineViewPoint.TEXT_FIELD_WIDTH=200,SparklineViewPoint}(t.IViewPoint);t.SparklineViewPoint=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function SparklineViewPoint_ScrollbarButtonLeft(){return null!==t&&t.apply(this,arguments)||this}return __extends(SparklineViewPoint_ScrollbarButtonLeft,t),SparklineViewPoint_ScrollbarButtonLeft}(flash.display.Bitmap);t.SparklineViewPoint_ScrollbarButtonLeft=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function SparklineViewPoint_ScrollbarButtonRight(){return null!==t&&t.apply(this,arguments)||this}return __extends(SparklineViewPoint_ScrollbarButtonRight,t),SparklineViewPoint_ScrollbarButtonRight}(flash.display.Bitmap);t.SparklineViewPoint_ScrollbarButtonRight=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function Split(e,i,n,a,r,o,s,l,h){var c=t.call(this,e,i,n,a,r,o,s)||this;return c.oldShares=l,c.newShares=h,c}return __extends(Split,t),Split}(t.StockAssociatedObject);t.Split=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function StockDividend(e,i,n,a,r,o,s,l,h){var c=t.call(this,e,i,n,a,r,o,s)||this;return c.ticker=l,c.adjustmentFactor=h,c}return __extends(StockDividend,t),StockDividend}(t.StockAssociatedObject);t.StockDividend=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function StockDividendMovie_DividendArrowSidewaysClass(){return null!==t&&t.apply(this,arguments)||this}return __extends(StockDividendMovie_DividendArrowSidewaysClass,t),StockDividendMovie_DividendArrowSidewaysClass}(flash.display.Bitmap);t.StockDividendMovie_DividendArrowSidewaysClass=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function StockDividendMovie_DividendArrowOnOverClass(){return null!==t&&t.apply(this,arguments)||this}return __extends(StockDividendMovie_DividendArrowOnOverClass,t),StockDividendMovie_DividendArrowOnOverClass}(flash.display.Bitmap);t.StockDividendMovie_DividendArrowOnOverClass=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function StockDividendMovie_DividendArrowClass(){return null!==t&&t.apply(this,arguments)||this}return __extends(StockDividendMovie_DividendArrowClass,t),StockDividendMovie_DividendArrowClass}(flash.display.Bitmap);t.StockDividendMovie_DividendArrowClass=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function StockDividendMovie_DividendArrowSidewaysOverClass(){return null!==t&&t.apply(this,arguments)||this}return __extends(StockDividendMovie_DividendArrowSidewaysOverClass,t),StockDividendMovie_DividendArrowSidewaysOverClass}(flash.display.Bitmap);t.StockDividendMovie_DividendArrowSidewaysOverClass=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(e){var i=function(i){function StockDividendMovie(){return null!==i&&i.apply(this,arguments)||this}return __extends(StockDividendMovie,i),StockDividendMovie.prototype.getTextColor=function(){return 26333},StockDividendMovie.prototype.initArrows=function(){this.arrow=new StockDividendMovie.DividendArrowClass,this.arrowOnOver=new StockDividendMovie.DividendArrowOnOverClass,this.arrowSideways=new StockDividendMovie.DividendArrowSidewaysClass,this.arrowSidewaysOver=new StockDividendMovie.DividendArrowSidewaysOverClass},StockDividendMovie.prototype.getDetailedText=function(){return(this.associatedStockDividend.ticker?e.Message.getMsg(e.Messages.STOCK_DIVIDEND_TEXT_WITH_TICKER,this.associatedStockDividend.ticker):e.Message.getMsg(e.Messages.STOCK_DIVIDEND_TEXT)).concat("\n",e.Message.getMsg(e.Messages.ADJUSTMENT_FACTOR_TEXT,this.associatedStockDividend.adjustmentFactor))},StockDividendMovie.prototype.setObject=function(t){this.associatedStockDividend=t,this.showText()},StockDividendMovie.prototype.positionSidewaysArrow=function(){this.currentVisibleButton.x=-1,this.text.autoSize=flash.text.TextFieldAutoSize.RIGHT,this.text.x=0},StockDividendMovie.prototype.getDateText=function(){var i=this.associatedStockDividend.exchangeDateInUTC;return e.Const.isZhLocale(t.i18n.locale.DateTimeLocale.getLocale())?t.i18n.locale.DateTimeLocale.standardFormatDateTime(t.i18n.locale.DateTimeFormats.LONG_DATE_FORMAT,i,!0):t.i18n.locale.DateTimeLocale.standardFormatDateTime(t.i18n.locale.DateTimeFormats.MEDIUM_DATE_FORMAT,i,!0)},StockDividendMovie.prototype.getShortText=function(t){return void 0===t&&(t=!1),""},StockDividendMovie.DividendArrowSidewaysClass=e.StockDividendMovie_DividendArrowSidewaysClass,StockDividendMovie.DividendArrowOnOverClass=e.StockDividendMovie_DividendArrowOnOverClass,StockDividendMovie.DividendArrowClass=e.StockDividendMovie_DividendArrowClass,StockDividendMovie.DividendArrowSidewaysOverClass=e.StockDividendMovie_DividendArrowSidewaysOverClass,StockDividendMovie}(e.SplitMovie);e.StockDividendMovie=i}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function ToolTipMovie(){var i=e.call(this)||this;return i.content=new flash.text.TextField,i.content.defaultTextFormat=new flash.text.TextFormat("Arial",11),i.content.selectable=!1,i.content.addEventListener(MouseEvents.MOUSE_OVER,function(e){t.MainManager.mouseCursor.setCursor(t.MouseCursors.CLASSIC),t.MainManager.mouseCursor.lockOnDisplayObject(i.content)}),i.content.addEventListener(MouseEvents.MOUSE_OUT,function(e){t.MainManager.mouseCursor.unlock()}),i}return __extends(ToolTipMovie,e),ToolTipMovie.prototype.renderBackground=function(){this.graphics.lineStyle(1,6710886,1),this.graphics.beginFill(16777215,1),this.graphics.drawRect(this.content.x-1,this.content.y-1,this.content.width+2,this.content.height+2),this.graphics.endFill()},ToolTipMovie.prototype.renderContent=function(t,e,i){this.content.wordWrap=!1,this.content.autoSize=flash.text.TextFieldAutoSize.LEFT,this.content.htmlText=i,this.addChild(this.content),this.content.x=t-this.content.width,this.content.y=e},ToolTipMovie.prototype.renderMovie=function(t,e,i){this.renderContent(t,e,i),this.renderBackground()},ToolTipMovie.prototype.clearMovie=function(){this.contains(this.content)&&this.removeChild(this.content),this.graphics.clear()},ToolTipMovie}(flash.display.Sprite);t.ToolTipMovie=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){function Utils(){}return Utils.compareDataUnits=function(t,e){return t.exchangeDateInUTC.getTime()-e.exchangeDateInUTC.getTime()},Utils.getLocalTimezoneOffset=function(){return isNaN(Utils.localTzOffset)&&(Utils.localTzOffset=(new Date).getTimezoneOffset()),Utils.localTzOffset},Utils.getDateInTimezone=function(t,e){return Utils.newDateInTimezone(t,e).getUTCDate()},Utils.adjustExchangeNameOfArray=function(t,e){for(var i=0,n=t;i<n.length;i++){var a=n[i];a&&a[e]&&0===a[e].indexOf("NASD:")&&(a[e]=Utils.adjustNasdToNasdaq(a[e]))}},Utils.decodeObjects=function(e){if(!e)return[];for(var i=[],n=0,a=(e=decodeURIComponent(e)).split(t.MainManager.paramsObj.objectSeparator);n<a.length;n++){for(var r={},o=0,s=a[n].split(t.MainManager.paramsObj.fieldSeparator);o<s.length;o++){var l=s[o].split(":"),h=l[1];isNaN(h)?"true"===h?h=!0:"false"===h?h=!1:"null"===h&&(h=null):h=Number(h),r[l[0]]=h}i.push(r)}return i},Utils.getTickerParts=function(t){var e=t.split(":"),i=e.shift(),n=e.join(":");return""===n&&(n=i,i=""),{exchange:i,symbol:n}},Utils.binarySearch=function(t,e,i,n){if(!t||0===t.length)return-1;if(i.call(n,t[0],e)>0)return-1;if(i.call(n,t[t.length-1],e)<=0)return t.length-1;for(var a=0,r=t.length-1;a<r-1;){var o=Math.round((a+r)/2),s=i.call(n,t[o],e);if(s<0)a=o;else{if(!(s>0))return o;r=o}}return a},Utils.assocArrayLength=function(t){for(var e=0,i=0,n=Object.keys(t);i<n.length;i++){n[i];e++}return e},Utils.newDateInTimezone=function(t,e){return new Date(t.getTime()+60*e*1e3)},Utils.compareUtcDates=function(t,e){return t.getUTCFullYear()!==e.getUTCFullYear()?t.getUTCFullYear()-e.getUTCFullYear():t.getUTCMonth()!==e.getUTCMonth()?t.getUTCMonth()-e.getUTCMonth():t.getUTCDate()!==e.getUTCDate()?t.getUTCDate()-e.getUTCDate():0},Utils.logTransform=function(e){return Math.log(e<t.Const.LOG_SCALE?Number((t.Const.LOG_SCALE-1)/t.Const.LOG_SCALE*e+1):e)/t.Const.LOG_SCALE_LOG},Utils.getEndOfUTCDayTime=function(t){return(t=new Date(t.getTime())).setUTCHours(23,59,0,0),t.getTime()},Utils.getSymbolFromTicker=function(t){return Utils.getTickerParts(t).symbol},Utils.getLastRealPointIndex=function(t){if(!t||0===t.length)return-1;for(var e=t.length-1;e>=0&&t[e].fake;)e--;return e},Utils.getExchangeFromTicker=function(t){return Utils.getTickerParts(t).exchange},Utils.numberToString=function(t,e,i){for(var n=Math.pow(10,e),a=(t=Math.round(t*n))%n,r=Math.floor(t/n)+".";n>1;)n/=10,r+=Math.floor(a/n),a%=n;for(var o=0;o<i-r.length;o++)r="0"+r;return r},Utils.utcDateToString=function(t){return t.getUTCFullYear()+"."+(t.getUTCMonth()+1)+"."+t.getUTCDate()+"/"+t.getUTCHours()+":"+t.getUTCMinutes()},Utils.createLabel=function(t,e,i){var n=new flash.text.TextField;return t.addChild(n),n.autoSize=flash.text.TextFieldAutoSize.LEFT,n.defaultTextFormat=i,n.selectable=!1,n.text=e,n},Utils.extendedMin=function(t,e){return t>=0||t<=0?e>=0||e<=0?Math.min(t,e):t:e},Utils.findValueInArray=function(t,e){if(!e||!t)return-1;for(var i=0;i<e.length;i++)if(t===e[i])return i;return-1},Utils.getWeekdaysDifference=function(e,i,n){for(var a=0,r=0;r<t.Const.DAY_PER_WEEK;r++)Utils.IsWeekday(r,n)&&a++;var o=(i.getTime()-e.getTime())/t.Const.MS_PER_DAY,s=Math.floor(o/t.Const.DAY_PER_WEEK)*a;if(o%t.Const.DAY_PER_WEEK==0)return s;for(var l=0,h=e.getDay(),c=0;c<t.Const.DAY_PER_WEEK&&h!==i.getDay();c++)Utils.IsWeekday(h,n)&&l++,h=(h+1)%t.Const.DAY_PER_WEEK;return!Utils.IsWeekday(e.getDay(),n)&&Utils.IsWeekday(i.getDay(),n)&&l++,s+l},Utils.numberToMinTwoChars=function(t){return t<10?"0"+t:t.toString()},Utils.getLogScaledValue=function(e,i){return i===t.Const.LOG_VSCALE||i===t.Const.NEW_LOG_VSCALE?Utils.logTransform(e):e},Utils.removeAllChildren=function(t){for(;t.numChildren>0;)t.removeChildAt(t.numChildren-1)},Utils.compareNumbers=function(t,e){return t<e?-1:t>e?1:0},Utils.checkUndefined=function(t,e){return void 0===t?e:t},Utils.adjustNasdToNasdaq=function(t){return 0===t.indexOf("NASD:")?"NASDAQ:"+t.substr(5):t},Utils.extendedMax=function(t,e){return t>=0||t<=0?e>=0||e<=0?Math.max(t,e):t:e},Utils.isSubset=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++){var a=n[i];if(t[a]!==e[a])return!1}return!0},Utils.printObjectMembers=function(t,e){console.log(t);for(var i=0,n=Object.keys(e);i<n.length;i++){var a=n[i];console.log("  obj."+a+" = "+e[a])}},Utils.hourToString=function(t,e){var i="";if(0===e)i=t>12?(t-=12)+" pm":12===t?"12 pm":t+" am";else{var n=""+t,a=""+e;t<10&&(n="0"+t),e<10&&(a="0"+e),i=n+":"+a}return i},Utils.appendObjectMembersAsStrings=function(t,e){for(var i=t+":",n=0,a=Object.keys(e);n<a.length;n++){var r=a[n];i+="  obj."+r+"="+e[r]}return i},Utils.displayObjectToTop=function(t,e){var i=0,n=t,a=e;try{return i=a.getChildIndex(n),void a.swapChildrenAt(i,a.numChildren-1)}catch(t){return}},Utils.getLastDayOfWeek=function(e){for(var i=t.Const.DAY_PER_WEEK-1;i>=0;i--)if(Utils.IsWeekday(i,e))return i;return t.Const.DEFAULT_LAST_MARKET_WEEKDAY},Utils.cloneObject=function(t){for(var e={},i=0,n=Object.keys(t);i<n.length;i++){var a=n[i];e[a]=t[a]}return e},Utils.IsWeekday=function(t,e){return!!(64>>t&e)},Utils.hasDifferentDividendCurrency=function(t,e){for(var i=0,n=e;i<n.length;i++){var a=n[i];if("dividend"===a._type&&a._amount_currency){if(t&&t!==a._amount_currency)return!0;t=a._amount_currency}}return!1},Utils}();t.Utils=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(){function VolumeCalculator(){}return VolumeCalculator.computeWeekly=function(e,i,n){for(var a=n/t.Const.WEEKLY_INTERVAL,r=e.fridays.length-1;r>=0;r-=a){var o=Number(r),s=0;for(i.fridays.push(i.points.length);o>r-a&&o>=0;)s=Number(s+e.units[e.fridays[o]].volumes[t.Const.WEEKLY_INTERVAL]),o--;o<0&&(o=0),i.points.push(new t.indicator.VolumeIndicatorPoint(s,e.units[e.fridays[r]].relativeMinutes,e.points[e.fridays[r]].point,e.units[e.fridays[o]].time))}},VolumeCalculator.computeDaily=function(e,i,n){for(var a=t.Const.DAILY_INTERVAL,r=n/t.Const.DAILY_INTERVAL,o=e.days.length-1;o>=0;o-=r){var s=Number(o),l=0;for(i.days.push(i.points.length);s>o-r&&s>=0;)l=Number(l+Number(e.units[e.days[s]].volumes[a])),s--;s<0&&(s=0),i.points.push(new t.indicator.VolumeIndicatorPoint(l,e.units[e.days[o]].relativeMinutes,e.points[e.days[o]].point,e.units[e.days[s]].time))}},VolumeCalculator.computeInterval=function(e,i,n){if(!i.hasInterval(e)){var a=new t.DataSeries;if(!(e<t.Const.INTRADAY_INTERVAL)){e<t.Const.DAILY_INTERVAL?VolumeCalculator.computeIntraday(n,a,e):e<t.Const.WEEKLY_INTERVAL?VolumeCalculator.computeDaily(n,a,e):VolumeCalculator.computeWeekly(n,a,e),a.points.reverse(),a.days.reverse(),a.fridays.reverse();for(var r=0;r<a.days.length;r++)a.days[r]=a.points.length-1-a.days[r],a.fridays[r]=a.points.length-1-a.fridays[r];i.setDataSeries(e,a)}}},VolumeCalculator.computeIntraday=function(e,i,n){for(var a=t.Const.INTRADAY_INTERVAL,r=n/t.Const.INTRADAY_INTERVAL,o=e.intradayRegions.length-1;o>=0;o--){var s=e.intradayRegions[o].end,l=e.intradayRegions[o].start;i.days.push(i.points.length);for(var h=s;h>=l;){for(var c=0,u=h;u>h-r&&u>=l;u--)c=Number(c+e.units[u].volumes[a]);i.points.push(new t.indicator.VolumeIndicatorPoint(c,e.units[h].relativeMinutes,e.points[h].point,e.units[h].time)),h-=r}}},VolumeCalculator}();t.VolumeCalculator=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function VolumeScaleLayer(t,i){var n=e.call(this,t,i)||this;return n.volumeLabel=new flash.text.TextField,n.volumeLabel.defaultTextFormat=new flash.text.TextFormat("Verdana",9,10066329),n.volumeLabel.autoSize=flash.text.TextFieldAutoSize.LEFT,n.volumeLabel.selectable=!1,n.addChild(n.volumeLabel),n.initTextFields(t),n}return __extends(VolumeScaleLayer,e),VolumeScaleLayer.prototype.drawVolumeLines=function(e){var i=1e3,n=this.viewPoint;e&&e.maxVolume/1e6>.5?(this.volumeLabel.text=t.Message.getMsg(t.Messages.VOLUME_LONG)+" ("+t.Message.getMsg(t.Messages.MILLION_SHORT)+" / ",i=1e6):(this.volumeLabel.text=t.Message.getMsg(t.Messages.VOLUME_LONG)+" ("+t.Message.getMsg(t.Messages.THOUSAND_SHORT)+" / ",i=1e3);var a=t.Const.INDICATOR_ENABLED?n.getDetailLevelForTechnicalStyle():n.getDetailLevel(),r=t.Const.INDICATOR_ENABLED?1:n.getSkipInterval().skip;switch(a){case t.Intervals.INTRADAY:this.volumeLabel.appendText(r*(t.Const.INTRADAY_INTERVAL/60)+t.Message.getMsg(t.Messages.MINUTES_SHORT)+")");break;case t.Intervals.FIVE_MINUTES:this.volumeLabel.appendText(r*(t.Const.FIVE_MINUTE_INTERVAL/60)+t.Message.getMsg(t.Messages.MINUTES_SHORT)+")");break;case t.Intervals.HALF_HOUR:this.volumeLabel.appendText(r*(t.Const.HALF_HOUR_INTERVAL/60)+t.Message.getMsg(t.Messages.MINUTES_SHORT)+")");break;case t.Intervals.DAILY:this.volumeLabel.appendText(r+t.Message.getMsg(t.Messages.DAY_SHORT)+")");break;case t.Intervals.WEEKLY:this.volumeLabel.appendText(r+t.Message.getMsg(t.Messages.WEEK_SHORT)+")")}var o=this.graphics;if(o.clear(),!e.maxVolume)return this.topScaleTextField.text="",void(this.midScaleTextField.text="");o.lineStyle(0,6710886,1);var s=t.Const.INDICATOR_ENABLED?Number(n.miny+t.Const.BOTTOM_VIEWPOINT_HEADER_HEIGHT):n.miny;t.Const.INDICATOR_ENABLED?(o.moveTo(n.maxx,s+1),o.lineTo(n.maxx-5,s+1)):(o.moveTo(n.maxx,s+3),o.lineTo(n.maxx-5,s+3)),o.moveTo(n.maxx,(s+n.maxy)/2),o.lineTo(n.maxx-5,(s+n.maxy)/2),this.topScaleTextField.x=n.maxx-t.ViewPoint.TEXT_FIELD_WIDTH-4,this.topScaleTextField.y=s+t.ViewPoint.TEXT_VERTICAL_OFFSET-4,this.midScaleTextField.x=n.maxx-t.ViewPoint.TEXT_FIELD_WIDTH-4,this.midScaleTextField.y=(s+n.maxy)/2-t.ViewPoint.TEXT_FIELD_HEIGHT/2-1,this.topScaleTextField.text=String(Math.floor(e.maxVolume)/i),this.midScaleTextField.text=String(Math.floor(e.maxVolume/2)/i)},VolumeScaleLayer.prototype.positionVolumeLabel=function(){this.volumeLabel.x=this.viewPoint.minx+VolumeScaleLayer.LABEL_PADDING,this.volumeLabel.y=this.viewPoint.miny+VolumeScaleLayer.LABEL_PADDING},VolumeScaleLayer.prototype.renderLayer=function(t){this.drawVolumeLines(t),this.positionVolumeLabel()},VolumeScaleLayer.prototype.initTextFields=function(e){this.topScaleTextField=new flash.text.TextField,this.topScaleTextField.width=t.ViewPoint.TEXT_FIELD_WIDTH,this.topScaleTextField.height=t.ViewPoint.TEXT_FIELD_HEIGHT,this.topScaleTextField.defaultTextFormat=e.priceTextFormat,this.topScaleTextField.selectable=!1,this.addChild(this.topScaleTextField),this.midScaleTextField=new flash.text.TextField,this.midScaleTextField.width=t.ViewPoint.TEXT_FIELD_WIDTH,this.midScaleTextField.height=t.ViewPoint.TEXT_FIELD_HEIGHT,this.midScaleTextField.defaultTextFormat=e.priceTextFormat,this.midScaleTextField.selectable=!1,this.addChild(this.midScaleTextField)},VolumeScaleLayer.LABEL_PADDING=2,VolumeScaleLayer}(t.AbstractLayer);t.VolumeScaleLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function WindowLayer_SparkHandle(){var e=t.call(this)||this;return e._width=11,e._height=18,e}return __extends(WindowLayer_SparkHandle,t),WindowLayer_SparkHandle}(flash.display.Bitmap);t.WindowLayer_SparkHandle=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function WindowLayer_ScrollBarBg(){return null!==t&&t.apply(this,arguments)||this}return __extends(WindowLayer_ScrollBarBg,t),WindowLayer_ScrollBarBg}(flash.display.Bitmap);t.WindowLayer_ScrollBarBg=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(t){function WindowLayer_SparkHandleActive(){var e=t.call(this)||this;return e._width=11,e._height=18,e}return __extends(WindowLayer_SparkHandleActive,t),WindowLayer_SparkHandleActive}(flash.display.Bitmap);t.WindowLayer_SparkHandleActive=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e=function(e){function WindowLayer(i,n){var a=e.call(this,i,n)||this;a.currentHandlesVisibility=!0,a.sliderBg=new flash.display.Sprite("sliderBg"),a.scrollSlider=new t.ScrollSlider("scrollSlider"),a.leftHandleXOffset=0,a.rightHandleXOffset=0;var r=new WindowLayer.ScrollBarBg;r.y=i.maxy-1,r.x=i.minx,r.width=i.maxx-i.minx,a.sliderBg.addChild(r),a.addChild(a.sliderBg),a.sliderBg.addEventListener(MouseEvents.CLICK,function(){i.myController.mouseDownAction(t.ControllerComponents.SCROLL_BG)}),a.addChild(a.scrollSlider),a.scrollSlider.y=i.maxy-1,a.scrollSlider.x=i.minx,a.rightHandle=new t.DraggableHandle(WindowLayer.SparkHandle,WindowLayer.SparkHandleActive),a.rightHandle.y=Math.floor((i.maxy+i.miny)/2-a.rightHandle.height/2),a.rightHandle.x=i.minx,a.addChild(a.rightHandle),a.leftHandle=new t.DraggableHandle(WindowLayer.SparkHandle,WindowLayer.SparkHandleActive),a.leftHandle.y=Math.floor((i.maxy+i.miny)/2-a.leftHandle.height/2),a.leftHandle.x=i.minx,a.addChild(a.leftHandle),a.scrollSlider.addEventListener(MouseEvents.MOUSE_DOWN,function(){i.myController.mouseDownAction(t.ControllerComponents.SCROLL_BAR)});var o=i.myController;return a.leftHandle.addEventListener(MouseEvents.ROLL_OVER,function(){t.MainManager.mouseCursor.setCursor(t.MouseCursors.H_ARROWS)}),a.leftHandle.addEventListener(MouseEvents.ROLL_OUT,function(){o.getState()!==t.ControllerStates.DRAGGING_LEFT_HANDLE&&t.MainManager.mouseCursor.setCursor(t.MouseCursors.CLASSIC)}),a.leftHandle.addEventListener(MouseEvents.MOUSE_DOWN,function(){i.myController.mouseDownAction(t.ControllerComponents.LEFT_HANDLE)}),a.rightHandle.addEventListener(MouseEvents.ROLL_OVER,function(){t.MainManager.mouseCursor.setCursor(t.MouseCursors.H_ARROWS)}),a.rightHandle.addEventListener(MouseEvents.ROLL_OUT,function(){o.getState()!==t.ControllerStates.DRAGGING_RIGHT_HANDLE&&t.MainManager.mouseCursor.setCursor(t.MouseCursors.CLASSIC)}),a.rightHandle.addEventListener(MouseEvents.MOUSE_DOWN,function(){i.myController.mouseDownAction(t.ControllerComponents.RIGHT_HANDLE)}),a.toggleHandles(!1),a}return __extends(WindowLayer,e),WindowLayer.prototype.getLastDataUnit=function(){var t=this.getHandleRightX(),e=this.viewPoint.dataSource.data,i=this.viewPoint.getMinuteOfX(t);return e.units[e.getRelativeMinuteIndex(i)]},WindowLayer.prototype.updateFixedElements=function(){var t=this.sliderBg.getChildAt(0);t.y=this.viewPoint.maxy-1,t.width=this.viewPoint.maxx-this.viewPoint.minx,this.scrollSlider.y=this.viewPoint.maxy-1,this.rightHandle.y=Math.floor((this.viewPoint.maxy+this.viewPoint.miny)/2-this.rightHandle.height/2),this.leftHandle.y=Math.floor((this.viewPoint.maxy+this.viewPoint.miny)/2-this.leftHandle.height/2)},WindowLayer.prototype.getHandleRightX=function(){return this.rightHandle.x+this.rightHandle.width/2},WindowLayer.prototype.checkHandlePosition=function(t){t.x<this.viewPoint.minx-t.width/2&&(t.x=this.viewPoint.minx-t.width/2),t.x>this.viewPoint.maxx-t.width/2&&(t.x=this.viewPoint.maxx-t.width/2)},WindowLayer.prototype.renderLayer=function(t){if(0!==this.stage.stageWidth&&this.dataSource&&!this.dataSource.isEmpty()){var e=this.dataSource.data,i=this.viewPoint;this.graphics.clear();var n=Number(e.getRelativeMinuteIndex(i.getFirstMinute())-1);n<0&&(n=0),this.rightX=i.getMinuteXPos(i.getLastMinute()),this.leftX=i.getMinuteXPos(i.getFirstMinute());var a=this.rightX,r=this.leftX;a>i.maxx&&(a=i.maxx),a<i.minx+WindowLayer.MIN_WINDOW_WIDTH-1&&(a=i.minx+WindowLayer.MIN_WINDOW_WIDTH-1),a-r<=WindowLayer.MIN_WINDOW_WIDTH&&((a=(r+a)/2)>i.maxx-(this.rightHandle.width-2)/2+2&&(a=i.maxx-(this.rightHandle.width-2)/2+2),r=a),this.rightHandle.x=a-this.rightHandle.width/2-this.rightHandleXOffset,this.checkHandlePosition(this.rightHandle),this.leftHandle.x=r-this.leftHandle.width/2-this.leftHandleXOffset,this.checkHandlePosition(this.leftHandle),this.scrollSlider.x=Math.round(r)-2,this.scrollSlider.setWidth(Math.round(a-r)+2),this.scrollSlider.width+2>a-r&&(this.scrollSlider.x=(a+r)/2-this.scrollSlider.width/2),this.scrollSlider.x+this.scrollSlider.width>this.viewPoint.maxx&&(this.scrollSlider.x=this.viewPoint.maxx-this.scrollSlider.width),this.scrollSlider.x<this.viewPoint.minx&&(this.scrollSlider.x=this.viewPoint.minx)}},WindowLayer.prototype.getHandleLeftX=function(){return this.leftHandle.x+this.leftHandle.width/2},WindowLayer.prototype.toggleHandles=function(t){if(t!==this.currentHandlesVisibility)if(this.currentHandlesVisibility=t,!0===t)this.addChild(this.leftHandle),this.addChild(this.rightHandle);else try{return this.removeChild(this.leftHandle),void this.removeChild(this.rightHandle)}catch(t){return}},WindowLayer.prototype.getFirstDataUnit=function(){var t=this.getHandleLeftX(),e=this.viewPoint.dataSource.data,i=this.viewPoint.getMinuteOfX(t);return e.units[e.getRelativeMinuteIndex(i)+1]},WindowLayer.prototype.handleReleased=function(t){var e=NaN,i=this.rightHandle.x+this.rightHandle.width/2,n=this.leftHandle.x+this.leftHandle.width/2;i===n&&(n=i-WindowLayer.MIN_WINDOW_WIDTH);var a=this.viewPoint,r=a.sparkCount*Math.abs(i-n)/(a.maxx-a.minx);switch(t){case this.leftHandle:e=n<i?Number(a.getLastMinute()):Number(a.getLastMinute()+r);break;case this.rightHandle:e=n<i?Number(a.getFirstMinute()+r):Number(a.getFirstMinute())}e>0&&(e=0),a.myController.clearCurrentZoom(),a.myController.animateTo(e,r),t.x=this.initialX,this.leftHandleXOffset=0,this.rightHandleXOffset=0},WindowLayer.prototype.getRightX=function(){return this.rightX},WindowLayer.prototype.getLeftX=function(){return this.leftX},WindowLayer.SparkHandle=t.WindowLayer_SparkHandle,WindowLayer.ScrollBarBg=t.WindowLayer_ScrollBarBg,WindowLayer.SparkHandleActive=t.WindowLayer_SparkHandleActive,WindowLayer.MIN_WINDOW_WIDTH=6,WindowLayer}(t.AbstractDrawingLayer);t.WindowLayer=e}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(e){var i=function(i){function IndicatorLayer(t,e){var n=i.call(this,t,e)||this;n.localYOffset=0,n._enabled=!1,n.localMedianValue=0,n.localYScale=0,n.dashSize=7,n.highlightCanvas=new flash.display.Sprite("highlightCanvas"),n.addChild(n.highlightCanvas),n.textOutCanvas=new flash.display.Sprite("textOutCanvas"),n.addChild(n.textOutCanvas),n.medianLineCanvas=new flash.display.Sprite("medianLineCanvas"),n.addChild(n.medianLineCanvas),n.isNameTextRequired()&&(n.indicatorNameText=new flash.text.TextField,n.indicatorNameText.selectable=!1,n.indicatorNameText.textColor=IndicatorLayer.NAME_TEXT_COLOR,n.indicatorNameText.defaultTextFormat=new flash.text.TextFormat(IndicatorLayer.INDICATOR_TEXT_FONT,IndicatorLayer.INDICATOR_TEXT_FONT_SIZE,IndicatorLayer.NAME_TEXT_COLOR),n.indicatorNameText.width=IndicatorLayer.INDICATOR_TEXT_WIDTH,n.indicatorNameText.height=IndicatorLayer.INDICATOR_TEXT_HEIGHT,n.textOutCanvas.addChild(n.indicatorNameText)),n.indicatorValueTextArray=[];for(var a=0;a<IndicatorLayer.COLORS.length;a++){var r=new flash.text.TextField;r.selectable=!1,r.textColor=n.getColor(a),r.defaultTextFormat=new flash.text.TextFormat(IndicatorLayer.INDICATOR_TEXT_FONT,IndicatorLayer.INDICATOR_TEXT_FONT_SIZE,r.textColor),r.width=IndicatorLayer.INDICATOR_TEXT_WIDTH,r.height=IndicatorLayer.INDICATOR_TEXT_HEIGHT,n.textOutCanvas.addChild(r),n.indicatorValueTextArray.push(r)}return n}return __extends(IndicatorLayer,i),IndicatorLayer.getParameterNames=function(){return IndicatorLayer.INDICATOR_LAYER_PARAMETER_NAMES},IndicatorLayer.prototype.getIntervalText=function(e){switch(e){case t.Intervals.INTRADAY:return"2m";case t.Intervals.FIVE_MINUTES:return"5m";case t.Intervals.HALF_HOUR:return"30m";case t.Intervals.DAILY:return"1d";case t.Intervals.WEEKLY:return"1w";default:return""}},IndicatorLayer.prototype.getIndicatorName=function(){return this.indicatorName},IndicatorLayer.prototype.renderHistogramLine=function(i,n,a,r,o,s,l,h){for(var c=Number.MAX_VALUE,u=this.getYPos(s,new e.IndicatorPoint(0,null)),d=this.graphics,g=r;g>=a;g--)if(!isNaN(i[n].points[g].getValue())){var p=i[n].points[g].getPoint();l===t.Intervals.WEEKLY&&h!==t.Const.LINE_CHART&&(c=this.getWeeklyBarXPos(p,c));var v=isNaN(p.weeklyXPos)?o.getXPos(p):p.weeklyXPos,y=this.getYPos(s,i[n].points[g]);d.lineStyle(1,this.getColor(n,i[n].points[g].getValue())),d.moveTo(v,u),d.lineTo(v,y)}},IndicatorLayer.prototype.renderSingleLine=function(e,i,n,a,r,o,s,l){var h=Number.MAX_VALUE,c=e[i].points[a].getPoint();s===t.Intervals.WEEKLY&&l!==t.Const.LINE_CHART&&(h=this.getWeeklyBarXPos(c,h));var u=this.graphics;u.lineStyle(1,this.indicatorValueTextArray[i].textColor),u.moveTo(isNaN(c.weeklyXPos)?r.getXPos(c):Number(c.weeklyXPos),this.getYPos(o,e[i].points[a]));for(var d=a-1;d>=n;){if(!isNaN(e[i].points[d].getValue())){c=e[i].points[d].getPoint(),s===t.Intervals.WEEKLY&&l!==t.Const.LINE_CHART&&(h=this.getWeeklyBarXPos(c,h));var g=isNaN(c.weeklyXPos)?r.getXPos(c):c.weeklyXPos,p=this.getYPos(o,e[i].points[d]);p<r.miny?u.moveTo(g,r.miny):p>r.maxy?u.moveTo(g,r.maxy):u.lineTo(g,p)}d--}},IndicatorLayer.prototype.renderHistogramLineFromBottom=function(e,i,n,a,r,o,s,l){var h=Number.MAX_VALUE,c=this.graphics;c.lineStyle(1,this.indicatorValueTextArray[i].textColor);for(var u=a;u>=n;){if(!isNaN(e[i].points[u].getValue())){var d=e[i].points[u].getPoint();s===t.Intervals.WEEKLY&&l!==t.Const.LINE_CHART&&(h=this.getWeeklyBarXPos(d,h));var g=isNaN(d.weeklyXPos)?r.getXPos(d):d.weeklyXPos,p=this.getYPos(o,e[i].points[u]);c.moveTo(g,this.viewPoint.maxy),c.lineTo(g,p)}u--}},IndicatorLayer.prototype.getYPos=function(t,e){return 0},IndicatorLayer.prototype.drawMedianLine=function(t,e){void 0===t&&(t=-1),-1===t&&(t=IndicatorLayer.MEDIAN_LINE_COLOR),e||(e=this.medianLineCanvas);var i=this.localYOffset,n=this.viewPoint.minx,a=this.viewPoint.maxx,r=0,o=e.graphics;o.lineStyle(1,t);do{o.moveTo(n+r*this.dashSize,i),o.lineTo(n+(r+1)*this.dashSize,i),r=Number(r+2)}while(n+r*this.dashSize<a)},IndicatorLayer.prototype.drawAHighlightDot=function(t,e,i){var n=this.highlightCanvas.graphics;n.lineStyle(5,i,1),n.moveTo(t,e-.2),n.lineTo(t,e+.2)},Object.defineProperty(IndicatorLayer.prototype,"enabled",{set:function(t){this._enabled=t===IndicatorLayer.TRUE_STR},enumerable:!0,configurable:!0}),IndicatorLayer.prototype.getColor=function(t,e){return void 0===e&&(e=NaN),IndicatorLayer.COLORS[t%IndicatorLayer.COLORS.length]},IndicatorLayer.prototype.getDataSeries=function(t){return null},IndicatorLayer.prototype.highlightPoint=function(t,i,n){if(this._enabled){this.clearHighlight();var a=this.viewPoint,r=a.getDetailLevelForTechnicalStyle(),o=this.getIntervalText(r),s=this.getDataSeriesArray(r);if(s){var l=this.findPointIndex(i);if(-1!==l){for(var h=0;h<s.length;h++){var c=s[h].points[l];if(c){var u=c.getPoint(),d=c.getValue();if(!isNaN(d)){var g=isNaN(u.weeklyXPos)?a.getXPos(u):u.weeklyXPos,p=void 0;switch(this.getLineStyle(h)){case e.IndicatorLineStyle.SIMPLE_LINE:(p=this.getYPos(t,c))<a.maxy&&p>a.miny&&this.drawAHighlightDot(g,p,this.indicatorValueTextArray[h].textColor),d=Math.round(100*d)/100,this.indicatorValueTextArray[h].text=this.getIndicatorValueText(h,d,o,t);break;case e.IndicatorLineStyle.HISTOGRAM_LINE:var v=this.getYPos(t,new e.IndicatorPoint(0,null));p=this.getYPos(t,c),this.drawAHighlightLine(g,v,g,p,this.getColor(h,c.getValue())),d=Math.round(100*d)/100,this.indicatorValueTextArray[h].text=this.getIndicatorValueText(h,d,o,t);break;case e.IndicatorLineStyle.HISTOGRAM_LINE_FROM_BOTTOM:p=this.getYPos(t,c),this.drawAHighlightLine(g,a.maxy,g,p,this.indicatorValueTextArray[h].textColor),d=Math.round(100*d)/100,this.indicatorValueTextArray[h].text=this.getIndicatorValueText(h,d,o,t);break;case e.IndicatorLineStyle.NONE:}}}}for(var y=s.length;y<this.indicatorValueTextArray.length;)this.indicatorValueTextArray[y].text="",y++}}}},IndicatorLayer.prototype.doCopyLastIndicatorPoint=function(t,i){for(var n=new e.IndicatorPoint(NaN,t),a=0;a<i.length;a++){var r=i[a].points.length;r>0?i[a].points.push(new e.IndicatorPoint(i[a].points[r-1].getValue(),t)):i[a].points.push(n),a++}},IndicatorLayer.prototype.findPointIndex=function(e){var i=this.viewPoint,n=this.originalDataSeries,a=i.getDetailLevelForTechnicalStyle(),r=t.Const.getDetailLevelInterval(a),o=n.getPointsInIntervalArray(r);if(!o)return-1;var s=i.getMinuteOfX(e),l=n.getRelativeMinuteIndex(s,o);if(l===o.length-2&&Math.abs(s-o[l].relativeMinutes)>Math.abs(s-o[l+1].relativeMinutes)&&l++,a===t.Intervals.WEEKLY)for(;l+1<o.length&&o[l+1].weeklyXPos<=e;)l++;for(;l>0&&(o[l].fake||o[l].duplicate);)l--;return l},IndicatorLayer.prototype.drawAHighlightLine=function(t,e,i,n,a){var r=this.highlightCanvas.graphics;r.lineStyle(2,a),r.moveTo(t,e),r.lineTo(i,n)},IndicatorLayer.prototype.copyLastIndicatorPoint=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.doCopyLastIndicatorPoint(t,e)},IndicatorLayer.prototype.setIndicator=function(e,i){this.indicatorName=e,void 0===this.dataSource.indicators[e]&&(this.dataSource.indicators[e]=new t.Indicator),this.indicator=this.dataSource.indicators[e],this.originalDataSeries=i,this.setIndicatorInstanceArray(t.Const.INDICATOR_PARAMETERS[e])},IndicatorLayer.prototype.getIndicatorNameText=function(t){return""},IndicatorLayer.prototype.shouldSkip=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];if(t.duplicate){for(var a=new e.IndicatorPoint(NaN,t),r=0,o=i;r<o.length;r++){o[r].points.push(a)}return!0}return!!t.fake&&(this.doCopyLastIndicatorPoint(t,i),!0)},IndicatorLayer.prototype.computeIntervalIndicator=function(t){},IndicatorLayer.prototype.renderLayer=function(i){if(this.placeIndicatorNameAndValueTexts(),this._enabled){this.graphics.clear();var n=this.viewPoint,a=n.getDetailLevelForTechnicalStyle(),r=t.Const.getDetailLevelInterval(a),o=this.originalDataSeries,s=o.getPointsInIntervalArray(r);if(s){var l=this.getDataSeriesArray(a);if(l){var h=this.getIntervalText(a);this.indicatorNameText&&(this.indicatorNameText.text=this.getIndicatorNameText(h)),this.calculateLocalScaleMeters(i);var c=o.getRelativeMinuteIndex(n.getLastMinute(),s);c<s.length-1&&c++;var u=this.getLastRealPointIndex(s);c>u&&(c=u);var d=o.getRelativeMinuteIndex(n.getFirstMinute(),s)-1;d<0&&(d=0);for(var g=this.viewPoint.getDisplayManager().getEnabledChartLayer(),p=0;p<l.length;p++){var v=l[p].points,y=c;y>v.length-1&&(y=v.length-1);for(var f=d,T=v.length;f<T&&isNaN(v[f].getValue());)f++;for(;y>=0&&isNaN(v[y].getValue());)y--;if(f>y)this.indicatorValueTextArray[p].text=this.getIndicatorValueText(p,0,h,i);else switch(this.getLineStyle(p)){case e.IndicatorLineStyle.SIMPLE_LINE:this.renderSingleLine(l,p,f,y,n,i,a,g);break;case e.IndicatorLineStyle.HISTOGRAM_LINE:this.renderHistogramLine(l,p,f,y,n,i,a,g);break;case e.IndicatorLineStyle.HISTOGRAM_LINE_FROM_BOTTOM:this.renderHistogramLineFromBottom(l,p,f,y,n,i,a,g);break;case e.IndicatorLineStyle.NONE:}}}}else{this.indicatorNameText&&(this.indicatorNameText.text="");for(var I=0;I<this.indicatorValueTextArray.length;)this.indicatorValueTextArray[I].text="",I++}}},IndicatorLayer.prototype.isNameTextRequired=function(){return!0},IndicatorLayer.prototype.getDataSeriesArray=function(e,i){var n=0,a=t.Const.getDetailLevelInterval(e),r=this.originalDataSeries.getPointsInIntervalArray(a);if(!r||0===r.length)return null;if(!this.indicator.hasInterval(a)){if(this.isOhlcDataRequired())for(n=0;n<r.length;){if(isNaN(r[n].high)||isNaN(r[n].low)||isNaN(r[n].open))return null;n++}this.computeIntervalIndicator(a)}return this.indicator.getDataSeriesArray(a)},IndicatorLayer.prototype.isOhlcDataRequired=function(){return!1},IndicatorLayer.prototype.getIndicatorValueText=function(t,e,i,n){return""},IndicatorLayer.prototype.getLineStyle=function(t){return e.IndicatorLineStyle.NONE},IndicatorLayer.prototype.clearHighlight=function(){this.highlightCanvas.graphics.clear()},IndicatorLayer.prototype.setIndicatorInstanceArray=function(t){},IndicatorLayer.prototype.placeIndicatorNameAndValueTexts=function(){this.indicatorNameText&&(this.indicatorNameText.y=this.viewPoint.miny+IndicatorLayer.TEXT_TOP_MARGIN,this.indicatorNameText.x=this.viewPoint.minx+IndicatorLayer.TEXT_LEFT_MARGIN);for(var t=0;t<this.indicatorValueTextArray.length;t++)this.indicatorValueTextArray[t].y=this.viewPoint.miny+IndicatorLayer.TEXT_TOP_MARGIN,this.indicatorValueTextArray[t].x=this.viewPoint.minx+IndicatorLayer.TEXT_LEFT_MARGIN+(this.indicatorNameText?t+1:t)*IndicatorLayer.INDICATOR_TEXT_WIDTH},IndicatorLayer.prototype.setEnabled=function(t){void 0===t&&(t=!0),this._enabled=t,this.visible=t,this.highlightCanvas.visible=t,this.textOutCanvas.visible=t,this.medianLineCanvas.visible=t},IndicatorLayer.TRUE_STR="true",IndicatorLayer.FALSE_STR="false",IndicatorLayer.TEXT_LEFT_MARGIN=2,IndicatorLayer.TEXT_TOP_MARGIN=2,IndicatorLayer.INDICATOR_TEXT_FONT="Verdana",IndicatorLayer.INDICATOR_TEXT_FONT_SIZE=9,IndicatorLayer.INDICATOR_TEXT_WIDTH=118,IndicatorLayer.INDICATOR_TEXT_HEIGHT=16,IndicatorLayer.NAME_TEXT_COLOR=10066329,IndicatorLayer.MEDIAN_LINE_COLOR=11141120,IndicatorLayer.COLORS=[26316,13382400,3381555,16711935],IndicatorLayer.INDICATOR_LAYER_PARAMETER_NAMES=[],IndicatorLayer}(t.AbstractDrawingLayer);e.IndicatorLayer=i}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(e){var i=function(i){function IndependentIndicatorLayer(t,e){var n=i.call(this,t,e)||this;n.levelTextArray=[];var a=new flash.text.TextFormat("Verdana",9);a.align="right";for(var r=0;r<IndependentIndicatorLayer.LEVEL_CNT;r++){var o=new flash.text.TextField;o.width=IndependentIndicatorLayer.LEVEL_TEXT_WIDTH,o.defaultTextFormat=a,o.text="",o.selectable=!1,o.x=t.maxx-IndependentIndicatorLayer.LEVEL_TEXT_WIDTH,o.y=t.miny+(t.maxy-t.miny-15)*(IndependentIndicatorLayer.LEVEL_CNT-1-r)/(IndependentIndicatorLayer.LEVEL_CNT-1),n.textOutCanvas.addChild(o),n.levelTextArray.push(o)}return n}return __extends(IndependentIndicatorLayer,i),IndependentIndicatorLayer.prototype.getYPos=function(t,e){return this.localYOffset-(e.getValue()-this.localMedianValue)*this.localYScale},IndependentIndicatorLayer.prototype.renderLayer=function(t){i.prototype.renderLayer.call(this,t),this.drawHorizontalLine(this.viewPoint.miny+IndependentIndicatorLayer.NAME_TEXT_BLOCK_HEIGHT),this.updateLevelTexts(t.maxValue,t.minValue)},IndependentIndicatorLayer.prototype.getContext=function(i,n){if(void 0===n&&(n=!1),!this._enabled)return i;var a=this.viewPoint.getDetailLevelForTechnicalStyle(i.lastMinute,i.count),r=t.Const.getDetailLevelInterval(a),o=this.originalDataSeries,s=o.getPointsInIntervalArray(r);if(!s)return i;var l=this.getDataSeriesArray(a,i);if(!l)return i;var h=Number.NEGATIVE_INFINITY,c=Number.POSITIVE_INFINITY,u=o.getRelativeMinuteIndex(i.lastMinute,s);u<s.length-1&&u++;var d=o.getRelativeMinuteIndex(i.lastMinute-i.count,s)-1;d<0&&(d=0);for(var g=0;g<l.length;g++)if(this.getLineStyle(g)!==e.IndicatorLineStyle.NONE)for(var p=0,v=l[g].points;p<v.length;p++){var y=v[p];if(y){var f=y.getValue();isNaN(f)||(h=Math.max(h,f),c=Math.min(c,f))}}return h!==Number.NEGATIVE_INFINITY&&c!==Number.POSITIVE_INFINITY&&(i.maxValue=t.Utils.extendedMax(h,i.maxValue),i.minValue=t.Utils.extendedMin(c,i.minValue)),i},IndependentIndicatorLayer.prototype.updateLevelTexts=function(t,e){for(var i=0;i<this.levelTextArray.length;i++){var n=e+(t-e)*i/(this.levelTextArray.length-1);n=Math.round(100*n)/100,this.levelTextArray[i].text=isNaN(n)?"":""+n,this.levelTextArray[i].x=this.viewPoint.maxx-IndependentIndicatorLayer.LEVEL_TEXT_WIDTH,this.levelTextArray[i].y=this.viewPoint.miny+IndependentIndicatorLayer.NAME_TEXT_BLOCK_HEIGHT+(this.viewPoint.maxy-this.viewPoint.miny-15-IndependentIndicatorLayer.NAME_TEXT_BLOCK_HEIGHT)*(this.levelTextArray.length-1-i)/(this.levelTextArray.length-1)}},IndependentIndicatorLayer.prototype.drawHorizontalLine=function(e){var i=this.graphics;i.lineStyle(0,t.Const.HORIZONTAL_GRID_COLOR,1),i.moveTo(this.viewPoint.minx+1,e),i.lineTo(this.viewPoint.maxx-1,e)},IndependentIndicatorLayer.prototype.calculateLocalScaleMeters=function(t){var e=this.viewPoint;this.localYOffset=e.miny+e.medPriceY+IndependentIndicatorLayer.NAME_TEXT_BLOCK_HEIGHT/2,this.localYScale=(e.maxy-e.miny-IndependentIndicatorLayer.NAME_TEXT_BLOCK_HEIGHT-2*IndependentIndicatorLayer.MARGIN_HEIGHT)/(t.maxValue-t.minValue),this.localMedianValue=(t.maxValue+t.minValue)/2},IndependentIndicatorLayer.LEVEL_CNT=3,IndependentIndicatorLayer.NAME_TEXT_BLOCK_HEIGHT=20,IndependentIndicatorLayer.MARGIN_HEIGHT=2,IndependentIndicatorLayer.LEVEL_TEXT_WIDTH=70,IndependentIndicatorLayer}(e.IndicatorLayer);e.IndependentIndicatorLayer=i}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(e){var i=function(i){function AbstractStochasticIndicatorLayer(){var t=null!==i&&i.apply(this,arguments)||this;return t.dPeriod=3,t.kPeriod=14,t}return __extends(AbstractStochasticIndicatorLayer,i),AbstractStochasticIndicatorLayer.getParameterNames=function(){return AbstractStochasticIndicatorLayer.PARAMETER_NAMES},AbstractStochasticIndicatorLayer.prototype.isOhlcDataRequired=function(){return!0},AbstractStochasticIndicatorLayer.prototype.getIndicatorValueText=function(e,i,n,a){switch(e){case 0:return t.Message.getMsg(t.Messages.K_STOCHASTIC,i);case 1:return t.Message.getMsg(t.Messages.D_STOCHASTIC,i);default:return""}},AbstractStochasticIndicatorLayer.prototype.getLineStyle=function(t){return t>=0&&t<2?e.IndicatorLineStyle.SIMPLE_LINE:e.IndicatorLineStyle.NONE},AbstractStochasticIndicatorLayer.prototype.setIndicatorInstanceArray=function(t){t&&1===t.length&&(this.indicator.clear(),this.kPeriod=t[0].kPeriod,this.dPeriod=t[0].dPeriod)},AbstractStochasticIndicatorLayer.PARAMETER_NAMES=["kPeriod","dPeriod"],AbstractStochasticIndicatorLayer}(e.IndependentIndicatorLayer);e.AbstractStochasticIndicatorLayer=i}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(e){var i=function(i){function BIASIndicatorLayer(){var t=null!==i&&i.apply(this,arguments)||this;return t.period=20,t}return __extends(BIASIndicatorLayer,i),BIASIndicatorLayer.getParameterNames=function(){return BIASIndicatorLayer.PARAMETER_NAMES},BIASIndicatorLayer.prototype.getIndicatorValueText=function(e,i,n,a){return 0===e?t.Message.getMsg(t.Messages.BIAS_BIAS,i):""},BIASIndicatorLayer.prototype.getLineStyle=function(t){return 0===t?e.IndicatorLineStyle.SIMPLE_LINE:e.IndicatorLineStyle.NONE},BIASIndicatorLayer.prototype.getIndicatorNameText=function(e){return t.Message.getMsg(t.Messages.BIAS_INTERVAL,this.period,e)},BIASIndicatorLayer.prototype.computeIntervalIndicator=function(i){if(!this.indicator.hasInterval(i)){var n=this.originalDataSeries.getPointsInIntervalArray(i);if(n){for(var a=new t.DataSeries,r=0,o=0,s=[],l=0,h=n;l<h.length;l++){var c=h[l];if(!this.shouldSkip(c,a)){r=Number(r+c.close),s.push(c.close);var u=void 0;s.length<this.period?u=NaN:(o=Number(r/this.period),u=(c.close-o)/o*100,r=Number(r-s.shift())),a.points.push(new e.IndicatorPoint(u,c))}}this.indicator.setDataSeries(i,a,0)}}},BIASIndicatorLayer.prototype.setIndicatorInstanceArray=function(t){t&&1===t.length&&(this.indicator.clear(),this.period=t[0].period)},BIASIndicatorLayer.PARAMETER_NAMES=["period"],BIASIndicatorLayer}(e.IndependentIndicatorLayer);e.BIASIndicatorLayer=i}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function DependentIndicatorLayer(){return null!==t&&t.apply(this,arguments)||this}return __extends(DependentIndicatorLayer,t),DependentIndicatorLayer.prototype.getYPos=function(t,e){return this.localYOffset-(e.getLogValue(t.verticalScaling)-this.localMedianValue)*this.localYScale},DependentIndicatorLayer.prototype.getContext=function(t,e){return void 0===e&&(e=!1),t},DependentIndicatorLayer.prototype.calculateLocalScaleMeters=function(t){var e=this.viewPoint;this.localYOffset=e.miny+e.medPriceY+e.V_OFFSET,this.localYScale=e.maxPriceRangeViewSize/t.maxPriceRange,this.localMedianValue=t.medPrice},DependentIndicatorLayer}(t.IndicatorLayer);t.DependentIndicatorLayer=e}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(e){var i=function(i){function BollingerBandsIndicatorLayer(){var t=null!==i&&i.apply(this,arguments)||this;return t.multiplier=2,t.period=20,t}return __extends(BollingerBandsIndicatorLayer,i),BollingerBandsIndicatorLayer.getParameterNames=function(){return BollingerBandsIndicatorLayer.PARAMETER_NAMES},BollingerBandsIndicatorLayer.prototype.getIndicatorNameText=function(e){return t.Message.getMsg(t.Messages.BOLL_INTERVAL,this.period,e)},BollingerBandsIndicatorLayer.prototype.getIndicatorValueText=function(e,i,n,a){switch(e){case 0:return t.Message.getMsg(t.Messages.MID_BOLL,i);case 1:return t.Message.getMsg(t.Messages.LOWER_BOLL,i);case 2:return t.Message.getMsg(t.Messages.UPPER_BOLL,i);default:return""}},BollingerBandsIndicatorLayer.prototype.getLineStyle=function(t){return t>=0&&t<3?e.IndicatorLineStyle.SIMPLE_LINE:e.IndicatorLineStyle.NONE},BollingerBandsIndicatorLayer.prototype.computeIntervalIndicator=function(i){if(!this.indicator.hasInterval(i)){var n=this.originalDataSeries.getPointsInIntervalArray(i);if(n){for(var a=0,r=new t.DataSeries,o=new t.DataSeries,s=new t.DataSeries,l=[],h=0,c=n;h<c.length;h++){var u=c[h];if(!this.shouldSkip(u,r,o,s))if(a=Number(a+u.close),l.push(u.close),l.length<this.period){var d=new e.IndicatorPoint(NaN,u);r.points.push(d),o.points.push(d),s.points.push(d)}else{for(var g=a/this.period,p=0,v=0;v<this.period;v++)p=Number(p+(l[v]-g)*(l[v]-g));p=Number(Math.sqrt(p/this.period));var y=g+this.multiplier*p,f=g-this.multiplier*p;r.points.push(new e.IndicatorPoint(g,u)),o.points.push(new e.IndicatorPoint(y,u)),s.points.push(new e.IndicatorPoint(f,u)),a=Number(a-l.shift())}}this.indicator.setDataSeries(i,r,0),this.indicator.setDataSeries(i,s,1),this.indicator.setDataSeries(i,o,2)}}},BollingerBandsIndicatorLayer.prototype.setIndicatorInstanceArray=function(t){t&&1===t.length&&(this.indicator.clear(),this.period=t[0].period)},BollingerBandsIndicatorLayer.PARAMETER_NAMES=["period"],BollingerBandsIndicatorLayer}(e.DependentIndicatorLayer);e.BollingerBandsIndicatorLayer=i}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(e){var i=function(i){function CCIIndicatorLayer(){var t=null!==i&&i.apply(this,arguments)||this;return t.period=20,t}return __extends(CCIIndicatorLayer,i),CCIIndicatorLayer.getParameterNames=function(){return CCIIndicatorLayer.PARAMETER_NAMES},CCIIndicatorLayer.prototype.getIndicatorValueText=function(e,i,n,a){return 0===e?t.Message.getMsg(t.Messages.CCI_CCI,i):""},CCIIndicatorLayer.prototype.getLineStyle=function(t){return 0===t?e.IndicatorLineStyle.SIMPLE_LINE:e.IndicatorLineStyle.NONE},CCIIndicatorLayer.prototype.getIndicatorNameText=function(e){return t.Message.getMsg(t.Messages.CCI_INTERVAL,this.period,e)},CCIIndicatorLayer.prototype.computeIntervalIndicator=function(i){if(!this.indicator.hasInterval(i)){var n=this.originalDataSeries.getPointsInIntervalArray(i);if(n){for(var a=new t.DataSeries,r=0,o=[],s=0,l=n;s<l.length;s++){var h=l[s];if(!this.shouldSkip(h,a)){var c=(h.close+h.high+h.low)/3;if(o.push(c),r=Number(r+c),o.length<this.period)a.points.push(new e.IndicatorPoint(NaN,h));else{for(var u=r/this.period,d=0,g=0;g<this.period;g++)d=Number(d+Math.abs(o[g]-u));0!==(d=Number(d/this.period))?a.points.push(new e.IndicatorPoint((c-u)/(.015*d),h)):a.points.push(new e.IndicatorPoint(0,h)),r=Number(r-o.shift())}}}this.indicator.setDataSeries(i,a,0)}}},CCIIndicatorLayer.prototype.isOhlcDataRequired=function(){return!0},CCIIndicatorLayer.prototype.setIndicatorInstanceArray=function(t){t&&1===t.length&&(this.indicator.clear(),this.period=t[0].period)},CCIIndicatorLayer.PARAMETER_NAMES=["period"],CCIIndicatorLayer}(e.IndependentIndicatorLayer);e.CCIIndicatorLayer=i}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e,i;e=t.indicator||(t.indicator={}),i=function(i){function SMAIndicatorLayer(){var t=null!==i&&i.apply(this,arguments)||this;return t.periods=[20],t}return __extends(SMAIndicatorLayer,i),SMAIndicatorLayer.getParameterNames=function(){return SMAIndicatorLayer.PARAMETER_NAMES},SMAIndicatorLayer.prototype.isNameTextRequired=function(){return!1},SMAIndicatorLayer.prototype.getIndicatorValueText=function(e,i,n,a){return e>=0&&e<this.periods.length?t.Message.getMsg(t.Messages.SMA_INTERVAL,this.periods[e],n,i):""},SMAIndicatorLayer.prototype.getLineStyle=function(t){return t>=0&&t<this.periods.length?e.IndicatorLineStyle.SIMPLE_LINE:e.IndicatorLineStyle.NONE},SMAIndicatorLayer.prototype.computeIntervalIndicator=function(i){if(!this.indicator.hasInterval(i))for(var n=this.originalDataSeries.getPointsInIntervalArray(i),a=0;a<this.periods.length;a++){for(var r=new t.DataSeries,o=0,s=[],l=0,h=n;l<h.length;l++){var c=h[l];if(!this.shouldSkip(c,r)){o=Number(o+c.close),s.push(c.close);var u=void 0;s.length<this.periods[a]?u=new e.IndicatorPoint(NaN,c):(u=new e.IndicatorPoint(o/this.periods[a],c),o=Number(o-s.shift())),r.points.push(u)}}this.indicator.setDataSeries(i,r,a)}},SMAIndicatorLayer.prototype.getColor=function(t,e){return void 0===e&&(e=NaN),i.prototype.getColor.call(this,t+1)},SMAIndicatorLayer.prototype.setIndicatorInstanceArray=function(t){if(t&&0!==t.length){this.indicator.clear(),this.periods=[];for(var e=0,i=t;e<i.length;e++){var n=i[e];this.periods.push(n.period)}}},SMAIndicatorLayer.PARAMETER_NAMES=["period"],SMAIndicatorLayer}(e.DependentIndicatorLayer),e.SMAIndicatorLayer=i}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(e){var i=function(i){function EMAIndicatorLayer(){return null!==i&&i.apply(this,arguments)||this}return __extends(EMAIndicatorLayer,i),EMAIndicatorLayer.getParameterNames=function(){return e.SMAIndicatorLayer.getParameterNames()},EMAIndicatorLayer.prototype.computeIntervalIndicator=function(i){if(!this.indicator.hasInterval(i))for(var n=this.originalDataSeries.getPointsInIntervalArray(i),a=0;a<this.periods.length;a++){for(var r=new t.DataSeries,o=NaN,s=2/(Number(this.periods[a])+1),l=0,h=0,c=0,u=n;c<u.length;c++){var d=u[c];if(!this.shouldSkip(d,r)){h++,l=Number(l+d.close);var g=void 0;h<this.periods[a]?g=new e.IndicatorPoint(NaN,d):h===this.periods[a]?(o=l/h,g=new e.IndicatorPoint(o,d)):(o=(d.close-o)*s+o,g=new e.IndicatorPoint(o,d)),r.points.push(g)}}this.indicator.setDataSeries(i,r,a)}},EMAIndicatorLayer.prototype.getIndicatorValueText=function(e,i,n,a){return e>=0&&e<this.periods.length?t.Message.getMsg(t.Messages.EMA_INTERVAL,this.periods[e],n,i):""},EMAIndicatorLayer}(e.SMAIndicatorLayer);e.EMAIndicatorLayer=i}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(e){var i=function(i){function FastStochasticIndicatorLayer(){return null!==i&&i.apply(this,arguments)||this}return __extends(FastStochasticIndicatorLayer,i),FastStochasticIndicatorLayer.getParameterNames=function(){return e.AbstractStochasticIndicatorLayer.getParameterNames()},FastStochasticIndicatorLayer.prototype.getIndicatorNameText=function(e){return t.Message.getMsg(t.Messages.FSTO_INTERVAL,this.kPeriod,this.dPeriod,e)},FastStochasticIndicatorLayer.prototype.computeIntervalIndicator=function(i){if(!this.indicator.hasInterval(i)){var n=this.originalDataSeries.getPointsInIntervalArray(i);if(n){for(var a=0,r=new t.DataSeries,o=new t.DataSeries,s=[],l=[],h=0,c=n;h<c.length;h++){var u=c[h];if(!this.shouldSkip(u,r,o))if(s.push(u),s.length<this.kPeriod){var d=new e.IndicatorPoint(NaN,u);r.points.push(d),o.points.push(d)}else{for(var g=Number.NEGATIVE_INFINITY,p=Number.POSITIVE_INFINITY,v=0;v<this.kPeriod;v++)g=t.Utils.extendedMax(g,s[v].high),p=t.Utils.extendedMin(p,s[v].low);if(g===p)this.copyLastIndicatorPoint(u,r,o);else{var y=(u.close-p)/(g-p)*100;r.points.push(new e.IndicatorPoint(y,u)),a=Number(a+y),l.push(y),l.length<this.dPeriod?this.copyLastIndicatorPoint(u,o):(o.points.push(new e.IndicatorPoint(a/this.dPeriod,u)),a=Number(a-l.shift()))}s.shift()}}this.indicator.setDataSeries(i,r,0),this.indicator.setDataSeries(i,o,1)}}},FastStochasticIndicatorLayer}(e.AbstractStochasticIndicatorLayer);e.FastStochasticIndicatorLayer=i}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(t){var e=function(){function IndicatorLineStyle(){}return IndicatorLineStyle.SIMPLE_LINE=1,IndicatorLineStyle.HISTOGRAM_LINE_FROM_BOTTOM=3,IndicatorLineStyle.NONE=0,IndicatorLineStyle.HISTOGRAM_LINE=2,IndicatorLineStyle}();t.IndicatorLineStyle=e}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(e){var i=function(){function IndicatorPoint(t,e){void 0===t&&(t=0),this.value=t,this.point=e}return IndicatorPoint.prototype.getValue=function(){return this.value},IndicatorPoint.prototype.getPoint=function(){return this.point},IndicatorPoint.prototype.getLogValue=function(e){return e===t.Const.LOG_VSCALE||e===t.Const.NEW_LOG_VSCALE?(isNaN(this.logValue)&&(this.logValue=t.Utils.logTransform(this.value)),this.logValue):this.value},IndicatorPoint}();e.IndicatorPoint=i;var n=function(t){function VolumeIndicatorPoint(e,i,n,a){return t.call(this,e,n)||this}return __extends(VolumeIndicatorPoint,t),Object.defineProperty(VolumeIndicatorPoint.prototype,"volume",{get:function(){return this.value},enumerable:!0,configurable:!0}),VolumeIndicatorPoint}(i);e.VolumeIndicatorPoint=n}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(e){var i=function(i){function KDJIndicatorLayer(){var t=null!==i&&i.apply(this,arguments)||this;return t.period=14,t.alphaNumber=.3333333333333333,t}return __extends(KDJIndicatorLayer,i),KDJIndicatorLayer.getParameterNames=function(){return KDJIndicatorLayer.PARAMETER_NAMES},KDJIndicatorLayer.prototype.getIndicatorValueText=function(e,i,n,a){switch(e){case 0:return t.Message.getMsg(t.Messages.K_KDJ,i);case 1:return t.Message.getMsg(t.Messages.D_KDJ,i);case 2:return t.Message.getMsg(t.Messages.J_KDJ,i);default:return""}},KDJIndicatorLayer.prototype.getLineStyle=function(t){return t>=0&&t<3?e.IndicatorLineStyle.SIMPLE_LINE:e.IndicatorLineStyle.NONE},KDJIndicatorLayer.prototype.getIndicatorNameText=function(e){return t.Message.getMsg(t.Messages.KDJ_INTERVAL,this.period,e)},KDJIndicatorLayer.prototype.computeIntervalIndicator=function(i){if(!this.indicator.hasInterval(i)){var n=this.originalDataSeries.getPointsInIntervalArray(i);if(n){for(var a=NaN,r=NaN,o=NaN,s=new t.DataSeries,l=new t.DataSeries,h=new t.DataSeries,c=[],u=0,d=n;u<d.length;u++){var g=d[u];if(!this.shouldSkip(g,s,l,h))if(c.push(g),c.length<this.period){var p=new e.IndicatorPoint(NaN,g);s.points.push(p),l.points.push(p),h.points.push(p)}else{for(var v=Number.NEGATIVE_INFINITY,y=Number.POSITIVE_INFINITY,f=0;f<this.period;f++)v=t.Utils.extendedMax(v,c[f].high),y=t.Utils.extendedMin(y,c[f].low);var T=(g.close-y)/(v-y)*100;if(isNaN(a)){p=new e.IndicatorPoint(T,g);a=T,r=T,o=T,s.points.push(p),l.points.push(p),h.points.push(p)}else v===y?this.copyLastIndicatorPoint(g,s,l,h):(o=3*(r=(a=T*this.alphaNumber+a*(1-this.alphaNumber))*this.alphaNumber+r*(1-this.alphaNumber))-2*a,s.points.push(new e.IndicatorPoint(a,g)),l.points.push(new e.IndicatorPoint(r,g)),h.points.push(new e.IndicatorPoint(o,g)));c.shift()}}this.indicator.setDataSeries(i,s,0),this.indicator.setDataSeries(i,l,1),this.indicator.setDataSeries(i,h,2)}}},KDJIndicatorLayer.prototype.isOhlcDataRequired=function(){return!0},KDJIndicatorLayer.prototype.setIndicatorInstanceArray=function(t){t&&1===t.length&&(this.indicator.clear(),this.period=t[0].period)},KDJIndicatorLayer.PARAMETER_NAMES=["period"],KDJIndicatorLayer}(e.IndependentIndicatorLayer);e.KDJIndicatorLayer=i}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(e){var i=function(i){function MACDIndicatorLayer(){var t=null!==i&&i.apply(this,arguments)||this;return t.emaPeriod=9,t.longPeriod=26,t.shortPeriod=12,t}return __extends(MACDIndicatorLayer,i),MACDIndicatorLayer.getParameterNames=function(){return MACDIndicatorLayer.PARAMETER_NAMES},MACDIndicatorLayer.prototype.getIndicatorValueText=function(e,i,n,a){switch(e){case 0:return t.Message.getMsg(t.Const.APPLY_CHINESE_STYLE_MACD?t.Messages.DIFF_MACD:t.Messages.MACD_MACD,i);case 1:return t.Message.getMsg(t.Const.APPLY_CHINESE_STYLE_MACD?t.Messages.DEA_MACD:t.Messages.EMA_MACD,i);case 2:return t.Message.getMsg(t.Const.APPLY_CHINESE_STYLE_MACD?t.Messages.MACD_MACD:t.Messages.DIVERGENCE_MACD,i);default:return""}},MACDIndicatorLayer.prototype.getLineStyle=function(t){switch(t){case 0:case 1:return e.IndicatorLineStyle.SIMPLE_LINE;case 2:return e.IndicatorLineStyle.HISTOGRAM_LINE;default:return e.IndicatorLineStyle.NONE}},MACDIndicatorLayer.prototype.getColor=function(e,i){switch(void 0===i&&(i=NaN),e){case 0:return t.Const.COLOR_BLUE;case 1:return t.Const.APPLY_CHINESE_STYLE_MACD?t.Const.COLOR_YELLOW:t.Const.COLOR_RED;case 2:return t.Const.APPLY_CHINESE_STYLE_MACD&&i>0?t.Const.COLOR_RED:t.Const.COLOR_GREEN;default:return 0}},MACDIndicatorLayer.prototype.getIndicatorNameText=function(e){return t.Message.getMsg(t.Messages.MACD_INTERVAL,this.shortPeriod,this.longPeriod,this.emaPeriod,e)},MACDIndicatorLayer.prototype.computeIntervalIndicator=function(i){if(!this.indicator.hasInterval(i)){var n=this.originalDataSeries.getPointsInIntervalArray(i);if(n&&0!==n.length){var a=new t.DataSeries,r=new t.DataSeries,o=new t.DataSeries,s=n[0].close,l=s,h=s-l,c=h,u=new e.IndicatorPoint(0,n[0]);a.points.push(u),r.points.push(u),o.points.push(u);for(var d=1;d<n.length;d++){var g=n[d];if(!this.shouldSkip(g,a,r,o)){h=(s=(s*(this.shortPeriod-1)+2*g.close)/(this.shortPeriod+1))-(l=(l*(this.longPeriod-1)+2*g.close)/(this.longPeriod+1)),c=(c*(this.emaPeriod-1)+2*h)/(this.emaPeriod+1);var p=(t.Const.APPLY_CHINESE_STYLE_MACD?2:1)*(h-c);a.points.push(new e.IndicatorPoint(h,g)),r.points.push(new e.IndicatorPoint(c,g)),o.points.push(new e.IndicatorPoint(p,g))}}this.indicator.setDataSeries(i,a,0),this.indicator.setDataSeries(i,r,1),this.indicator.setDataSeries(i,o,2)}}},MACDIndicatorLayer.prototype.setIndicatorInstanceArray=function(t){t&&1===t.length&&(this.indicator.clear(),this.shortPeriod=t[0].shortPeriod,this.longPeriod=t[0].longPeriod,this.emaPeriod=t[0].emaPeriod)},MACDIndicatorLayer.prototype.getContext=function(e,n){return void 0===n&&(n=!1),(e=i.prototype.getContext.call(this,e,n)).maxValue=t.Utils.extendedMax(0,e.maxValue),e.minValue=t.Utils.extendedMin(0,e.minValue),e},MACDIndicatorLayer.PARAMETER_NAMES=["shortPeriod","longPeriod","emaPeriod"],MACDIndicatorLayer}(e.IndependentIndicatorLayer);e.MACDIndicatorLayer=i}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(e){var i=function(i){function RSIIndicatorLayer(){var t=null!==i&&i.apply(this,arguments)||this;return t.period=9,t}return __extends(RSIIndicatorLayer,i),RSIIndicatorLayer.getParameterNames=function(){return RSIIndicatorLayer.PARAMETER_NAMES},RSIIndicatorLayer.prototype.getIndicatorValueText=function(e,i,n,a){return 0===e?t.Message.getMsg(t.Messages.RSI_RSI,i):""},RSIIndicatorLayer.prototype.getLineStyle=function(t){return 0===t?e.IndicatorLineStyle.SIMPLE_LINE:e.IndicatorLineStyle.NONE},RSIIndicatorLayer.prototype.getIndicatorNameText=function(e){return t.Message.getMsg(t.Messages.RSI_INTERVAL,this.period,e)},RSIIndicatorLayer.prototype.computeIntervalIndicator=function(i){if(!this.indicator.hasInterval(i)){var n=this.originalDataSeries.getPointsInIntervalArray(i);if(n&&0!==n.length){var a=new t.DataSeries,r=0,o=0,s=[],l=n[0].close,h=new e.IndicatorPoint(NaN,n[0]);a.points.push(h);for(var c=1;c<n.length;c++){var u=n[c];if(!this.shouldSkip(u,a)){var d=u.close-l;if(l=u.close,s.push(d),d>0?r=Number(r+d):o=Number(o-d),s.length<this.period)a.points.push(new e.IndicatorPoint(NaN,u));else{if(r+o!==0){var g=r/(r+o)*100;a.points.push(new e.IndicatorPoint(g,u))}else this.copyLastIndicatorPoint(u,a);(d=Number(s.shift()))>0?r-=d:o+=d}}}this.indicator.setDataSeries(i,a,0)}}},RSIIndicatorLayer.prototype.setIndicatorInstanceArray=function(t){t&&1===t.length&&(this.indicator.clear(),this.period=t[0].period)},RSIIndicatorLayer.PARAMETER_NAMES=["period"],RSIIndicatorLayer}(e.IndependentIndicatorLayer);e.RSIIndicatorLayer=i}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(e){var i=function(i){function SlowStochasticIndicatorLayer(){return null!==i&&i.apply(this,arguments)||this}return __extends(SlowStochasticIndicatorLayer,i),SlowStochasticIndicatorLayer.getParameterNames=function(){return e.AbstractStochasticIndicatorLayer.getParameterNames()},SlowStochasticIndicatorLayer.prototype.getIndicatorNameText=function(e){return t.Message.getMsg(t.Messages.SSTO_INTERVAL,this.kPeriod,this.dPeriod,e)},SlowStochasticIndicatorLayer.prototype.computeIntervalIndicator=function(i){if(!this.indicator.hasInterval(i)){var n=this.originalDataSeries.getPointsInIntervalArray(i);if(n){for(var a=0,r=0,o=new t.DataSeries,s=new t.DataSeries,l=[],h=[],c=[],u=0,d=n;u<d.length;u++){var g=d[u];if(!this.shouldSkip(g,o,s))if(l.push(g),l.length<this.kPeriod){var p=new e.IndicatorPoint(NaN,g);o.points.push(p),s.points.push(p)}else{for(var v=Number.NEGATIVE_INFINITY,y=Number.POSITIVE_INFINITY,f=0;f<this.kPeriod;f++)v=t.Utils.extendedMax(v,l[f].high),y=t.Utils.extendedMin(y,l[f].low);if(v===y)this.copyLastIndicatorPoint(g,o,s);else{var T=(g.close-y)/(v-y)*100;if(a=Number(a+T),h.push(T),h.length<SlowStochasticIndicatorLayer.FAST_SLOW_RATIO){p=new e.IndicatorPoint(NaN,g);o.points.push(p),s.points.push(p)}else{var I=a/SlowStochasticIndicatorLayer.FAST_SLOW_RATIO;o.points.push(new e.IndicatorPoint(I,g)),r=Number(r+I),c.push(I),c.length<this.dPeriod?this.copyLastIndicatorPoint(g,s):(s.points.push(new e.IndicatorPoint(r/this.dPeriod,g)),r=Number(r-c.shift())),a=Number(a-h.shift())}}l.shift()}}this.indicator.setDataSeries(i,o,0),this.indicator.setDataSeries(i,s,1)}}},SlowStochasticIndicatorLayer.FAST_SLOW_RATIO=3,SlowStochasticIndicatorLayer}(e.AbstractStochasticIndicatorLayer);e.SlowStochasticIndicatorLayer=i}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(e){var i=function(e){function VolumeDependentIndicatorLayer(){return null!==e&&e.apply(this,arguments)||this}return __extends(VolumeDependentIndicatorLayer,e),VolumeDependentIndicatorLayer.prototype.getYPos=function(t,e){return this.viewPoint.maxy-e.getValue()*this.localYScale},VolumeDependentIndicatorLayer.prototype.getContext=function(t,e){return void 0===e&&(e=!1),t},VolumeDependentIndicatorLayer.prototype.calculateLocalScaleMeters=function(e){this.localYScale=(this.viewPoint.maxy-this.viewPoint.miny-t.Const.BOTTOM_VIEWPOINT_HEADER_HEIGHT)/e.maxVolume},VolumeDependentIndicatorLayer}(e.IndicatorLayer);e.VolumeDependentIndicatorLayer=i}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e,i;e=t.indicator||(t.indicator={}),i=function(i){function VMAIndicatorLayer(){var t=null!==i&&i.apply(this,arguments)||this;return t.periods=[20],t}return __extends(VMAIndicatorLayer,i),VMAIndicatorLayer.getParameterNames=function(){return VMAIndicatorLayer.PARAMETER_NAMES},VMAIndicatorLayer.prototype.isNameTextRequired=function(){return!0},VMAIndicatorLayer.prototype.getIndicatorValueText=function(e,i,n,a){var r=1e3;return a&&a.maxVolume/1e6>.5&&(r=1e6),e>=0&&e<this.periods.length?t.Message.getMsg(t.Messages.VMA_INTERVAL,this.periods[e],n,t.Utils.numberToString(i/r,2,4)):""},VMAIndicatorLayer.prototype.getLineStyle=function(t){return t>=0&&t<this.periods.length?e.IndicatorLineStyle.SIMPLE_LINE:e.IndicatorLineStyle.NONE},VMAIndicatorLayer.prototype.computeIntervalIndicator=function(i){if(!this.indicator.hasInterval(i))for(var n=this.originalDataSeries.getPointsInIntervalArray(i),a=0;a<this.periods.length;a++){for(var r=new t.DataSeries,o=0,s=[],l=0,h=n;l<h.length;l++){var c=h[l];if(!this.shouldSkip(c,r)){var u=c.volumes[i];if(0===u)this.copyLastIndicatorPoint(c,r);else{o=Number(o+u),s.push(u);var d=void 0;s.length<this.periods[a]?d=new e.IndicatorPoint(NaN,c):(d=new e.IndicatorPoint(o/this.periods[a],c),o=Number(o-s.shift())),r.points.push(d)}}}this.indicator.setDataSeries(i,r,a)}},VMAIndicatorLayer.prototype.getColor=function(e,n){if(void 0===n&&(n=NaN),!t.Const.VOLUME_PLUS_ENABLED)return i.prototype.getColor.call(this,e+1);switch(e){case 0:return t.Const.COLOR_BLUE;case 1:return t.Const.COLOR_YELLOW;case 2:return t.Const.COLOR_PINK;default:return 0}},VMAIndicatorLayer.prototype.setIndicatorInstanceArray=function(t){if(t&&0!==t.length){this.indicator.clear(),this.periods=[];for(var e=0,i=t;e<i.length;e++){var n=i[e];this.periods.push(n.period)}}},VMAIndicatorLayer.PARAMETER_NAMES=["period"],VMAIndicatorLayer}(e.VolumeDependentIndicatorLayer),e.VMAIndicatorLayer=i}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(e){var i=function(i){function WilliamsPercentRIndicatorLayer(){var t=null!==i&&i.apply(this,arguments)||this;return t.period=10,t}return __extends(WilliamsPercentRIndicatorLayer,i),WilliamsPercentRIndicatorLayer.getParameterNames=function(){return WilliamsPercentRIndicatorLayer.PARAMETER_NAMES},WilliamsPercentRIndicatorLayer.prototype.getIndicatorValueText=function(e,i,n,a){return 0===e?t.Message.getMsg(t.Messages.PR_WPR,i):""},WilliamsPercentRIndicatorLayer.prototype.getLineStyle=function(t){return 0===t?e.IndicatorLineStyle.SIMPLE_LINE:e.IndicatorLineStyle.NONE},WilliamsPercentRIndicatorLayer.prototype.getIndicatorNameText=function(e){return t.Message.getMsg(t.Messages.WPR_INTERVAL,this.period,e)},WilliamsPercentRIndicatorLayer.prototype.computeIntervalIndicator=function(i){if(!this.indicator.hasInterval(i)){var n=this.originalDataSeries.getPointsInIntervalArray(i);if(n){for(var a=new t.DataSeries,r=[],o=0,s=n;o<s.length;o++){var l=s[o];if(!this.shouldSkip(l,a))if(r.push(l),r.length<this.period)a.points.push(new e.IndicatorPoint(NaN,l));else{for(var h=Number.NEGATIVE_INFINITY,c=Number.POSITIVE_INFINITY,u=0;u<this.period;u++)h=t.Utils.extendedMax(h,r[u].high),c=t.Utils.extendedMin(c,r[u].low);if(h!==c){var d=(h-l.close)/(h-c)*100;a.points.push(new e.IndicatorPoint(d,l))}else this.copyLastIndicatorPoint(l,a);r.shift()}}this.indicator.setDataSeries(i,a,0)}}},WilliamsPercentRIndicatorLayer.prototype.isOhlcDataRequired=function(){return!0},WilliamsPercentRIndicatorLayer.prototype.setIndicatorInstanceArray=function(t){t&&1===t.length&&(this.indicator.clear(),this.period=t[0].period)},WilliamsPercentRIndicatorLayer.PARAMETER_NAMES=["period"],WilliamsPercentRIndicatorLayer}(e.IndependentIndicatorLayer);e.WilliamsPercentRIndicatorLayer=i}(t.indicator||(t.indicator={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function ButtonsGroup(){var e=t.call(this)||this;return e.spacing=ButtonsGroup.DEFAULT_SPACING,e.leftPadding=ButtonsGroup.DEFAULT_LEFT_PADDING,e.separator=ButtonsGroup.DEFAULT_SEPARATOR,e.resetButtonsGroup(),e}return __extends(ButtonsGroup,t),ButtonsGroup.prototype.getNextButtonPosition=function(){return{x:this.currentX,y:this.currentY}},ButtonsGroup.prototype.setSpacing=function(t,e){this.separator=t,this.spacing=e},ButtonsGroup.prototype.addButton=function(t,e,i,n){var a=this;void 0===i&&(i=NaN),void 0===n&&(n=NaN),this.buttons.length>0&&""!==this.separator&&(this.currentX+=this.putSeparator(this.currentX,this.currentY,this.separator).width);var r=this.attachButton(t,e,i,n);this.currentX+=r.width+this.spacing,this.buttons.push(r),r.addEventListener(MouseEvents.MOUSE_DOWN,function(t){a.buttonPress(t)})},ButtonsGroup.prototype.getButtonIndex=function(t){for(var e=this.buttons.length-1;e>=0&&this.buttons[e].name!==t;)e--;return e},ButtonsGroup.prototype.putSeparator=function(t,e,i){var n=new flash.text.TextField;return n.x=t-this.spacing/2,n.y=e,n.defaultTextFormat=this.separatorTextFormat,n.autoSize=flash.text.TextFieldAutoSize.LEFT,n.selectable=!1,n.text=i,this.addChild(n),n},ButtonsGroup.prototype.attachButton=function(t,e,i,n){void 0===i&&(i=NaN),void 0===n&&(n=NaN);var a=new flash.display.SimpleButton,r=this.getNextButtonPosition();a.x=r.x,a.y=r.y,a.useHandCursor=!0;var o=new flash.text.TextField,s=new flash.display.Sprite;return s.addChild(o),o.defaultTextFormat=e||this.buttonTextFormat,o.text=t,o.autoSize=flash.text.TextFieldAutoSize.LEFT,a.upState=s,a.downState=s,a.overState=s,a.hitTestState=s,a.name=t,this.addChild(a),a},ButtonsGroup.prototype.setLeftPadding=function(t){this.leftPadding=t,this.currentX=t},ButtonsGroup.prototype.resetButtonsGroup=function(){for(var t=this.buttons?this.buttons.length:0,e=0;e<t;e++)this.buttons[e].removeEventListener(MouseEvents.MOUSE_DOWN,this.buttonPress),this.removeChild(this.buttons[e]);this.buttons=[],this.listenerFunctions=[],this.listenerObjects=[],this.currentX=0,this.currentY=0},ButtonsGroup.prototype.buttonPress=function(t){var e=t.currentTarget.displayObject.upState.getChildAt(0);if(-1!==this.getButtonIndex(e.text))for(var i=0;i<this.listenerFunctions.length;i++)this.listenerFunctions[i].call(this.listenerObjects[i],e.text)},ButtonsGroup.prototype.setTextFormats=function(t,e,i){this.buttonTextFormat=t,this.selectedTextFormat=e,this.separatorTextFormat=i},ButtonsGroup.prototype.addListener=function(t,e){this.listenerFunctions.push(t),this.listenerObjects.push(e)},ButtonsGroup.prototype.addPlainText=function(t,e){void 0===e&&(e=NaN);var i=this.getNextButtonPosition(),n=this.putSeparator(i.x,i.y,t);isNaN(e)?this.currentX+=n.width:this.currentX+=e},ButtonsGroup.DEFAULT_SPACING=5,ButtonsGroup.DEFAULT_SEPARATOR="",ButtonsGroup.DEFAULT_LEFT_PADDING=0,ButtonsGroup}(flash.display.Sprite);t.ButtonsGroup=e}(t.ui||(t.ui={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function TextButtonsGroup(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentButton=-1,e}return __extends(TextButtonsGroup,t),TextButtonsGroup.prototype.buttonPress=function(e){t.prototype.buttonPress.call(this,e);var i=e.currentTarget.displayObject.upState.getChildAt(0);this.selectButton(i.text)},TextButtonsGroup.prototype.selectButton=function(t){var e=this.getButtonIndex(t);return this.selectButtonByIndex(e),e},TextButtonsGroup.prototype.selectButtonByIndex=function(t){(this.deselectButton(this.currentButton),t>=0&&t<this.buttons.length)&&(this.buttons[t].upState.getChildAt(0).setTextFormat(this.selectedTextFormat),this.currentButton=t)},TextButtonsGroup.prototype.clearSelection=function(){this.deselectButton(this.currentButton),this.currentButton=-1},TextButtonsGroup.prototype.deselectButton=function(t){-1!==t&&this.buttons[t].upState.getChildAt(0).setTextFormat(this.buttonTextFormat)},TextButtonsGroup}(t.ButtonsGroup);t.TextButtonsGroup=e}(t.ui||(t.ui={}))}(t.finance||(t.finance={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){var e,i;e=t.locale||(t.locale={}),i=function(){function DateTimeConstants(){}var t;return DateTimeConstants.register=function(t){return t(DateTimeConstants.DateTimeConstants_en,"en"),!0},DateTimeConstants.DateTimeConstants_en={ERAS:["BC","AD"],ERANAMES:["Before Christ","Anno Domini"],NARROWMONTHS:["J","F","M","A","M","J","J","A","S","O","N","D"],MONTHS:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTMONTHS:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],WEEKDAYS:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],SHORTWEEKDAYS:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],NARROWWEEKDAYS:["S","M","T","W","T","F","S"],SHORTQUARTERS:["Q1","Q2","Q3","Q4"],QUARTERS:["1st quarter","2nd quarter","3rd quarter","4th quarter"],AMPMS:["AM","PM"],DATEFORMATS:["EEEE, MMMM d, y","MMMM d, y","MMM d, y","M/d/yy"],TIMEFORMATS:["h:mm:ss a zzzz","h:mm:ss a z","h:mm:ss a","h:mm a"],FIRSTDAYOFWEEK:6,WEEKENDRANGE:[5,6],FIRSTWEEKCUTOFFDAY:2},DateTimeConstants._staticConstructor=((t=DateTimeConstants.DateTimeConstants_en).STANDALONENARROWMONTHS=DateTimeConstants.DateTimeConstants_en.NARROWMONTHS,t.STANDALONEMONTHS=DateTimeConstants.DateTimeConstants_en.MONTHS,t.STANDALONESHORTMONTHS=DateTimeConstants.DateTimeConstants_en.SHORTMONTHS,t.STANDALONEWEEKDAYS=DateTimeConstants.DateTimeConstants_en.WEEKDAYS,t.STANDALONESHORTWEEKDAYS=DateTimeConstants.DateTimeConstants_en.SHORTWEEKDAYS,t.STANDALONENARROWWEEKDAYS=DateTimeConstants.DateTimeConstants_en.NARROWWEEKDAYS,!0),DateTimeConstants}(),e.DateTimeConstants=i}(t.i18n||(t.i18n={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(t){var e;!function(t){t[t.QUOTED_STRING=0]="QUOTED_STRING",t[t.FIELD=1]="FIELD",t[t.LITERAL=2]="LITERAL"}(e||(e={}));var i=function(){return function PatternPart(t,e){this.text=t,this.type=e}}(),n=function(){function DateTimeFormat(e){void 0===e&&(e=!1),this.isUtc=e,this.tokensHash={},this.symbols=t.DateTimeLocale.getResource(t.DateTimeLocale.getLocale()),this.TOKENS="GyMkSEahKHcLQdmsvzZ",this.patternParts=[];for(var i=0;i<this.TOKENS.length;i++)this.tokensHash[this.TOKENS.substr(i,1)]=!0}return DateTimeFormat.prototype.applyPattern=function(t){for(var n=0,a=t.length;n<t.length;){for(var r=n;r<a&&!this.tokensHash[t.substr(r,1)];)r++;if(r!==n){var o=t.substring(n,r);this.patternParts.push(new i(o,e.LITERAL))}for(n=r;r<a&&this.tokensHash[t.substr(r,1)]&&t.charAt(r)===t.charAt(n);)r++;if(r!==n){var s=t.substring(n,r);this.patternParts.push(new i(s,e.FIELD))}n=r}},DateTimeFormat.prototype.formatField=function(t,e){var i=t.length;switch(t.charAt(0)){case"G":return this.formatEra(i,e);case"y":return this.formatYear(i,e);case"M":return this.formatMonth(i,e);case"k":return this.format24Hours(i,e);case"S":return this.formatFractionalSeconds(i,e);case"E":return this.formatDayOfWeek(i,e);case"a":return this.formatAmPm(i,e);case"h":return this.format1To12Hours(i,e);case"K":return this.format0To11Hours(i,e);case"H":return this.format0To23Hours(i,e);case"c":return this.formatStandaloneDay(i,e);case"L":return this.formatStandaloneMonth(i,e);case"Q":return this.formatQuarter(i,e);case"d":return this.formatDate(i,e);case"m":return this.formatMinutes(i,e);case"s":return this.formatSeconds(i,e);case"v":case"z":return this.formatGMT(i,e);case"Z":return this.formatTimeZoneRFC(i,e);default:return""}},DateTimeFormat.prototype.formatStandaloneMonth=function(t,e){var i=this.isUtc?e.getUTCMonth():e.getMonth();switch(t){case 5:return this.symbols.STANDALONENARROWMONTHS[i];case 4:return this.symbols.STANDALONEMONTHS[i];case 3:return this.symbols.STANDALONESHORTMONTHS[i];default:return this.padNumber(i+1,t)}},DateTimeFormat.prototype.applyStandardPattern=function(e){var i;if(e<t.DateTimeFormats.FULL_TIME_FORMAT)i=this.symbols.DATEFORMATS[e];else if(e<t.DateTimeFormats.FULL_DATETIME_FORMAT)i=this.symbols.TIMEFORMATS[e-4];else{if(!(e<=t.DateTimeFormats.SHORT_DATETIME_FORMAT))return void this.applyStandardPattern(t.DateTimeFormats.MEDIUM_DATETIME_FORMAT);i=this.symbols.DATEFORMATS[e-8]+" "+this.symbols.TIMEFORMATS[e-8]}this.applyPattern(i)},DateTimeFormat.prototype.formatMonth=function(t,e){var i=this.isUtc?e.getUTCMonth():e.getMonth();switch(t){case 5:return this.symbols.NARROWMONTHS[i];case 4:return this.symbols.MONTHS[i];case 3:return this.symbols.SHORTMONTHS[i];default:return this.padNumber(i+1,t)}},DateTimeFormat.prototype.formatDate=function(t,e){var i=this.isUtc?e.getUTCDate():e.getDate();return this.padNumber(i,t)},DateTimeFormat.prototype.formatSeconds=function(t,e){return this.padNumber(e.getSeconds(),t)},DateTimeFormat.prototype.formatYear=function(t,e){var i=this.isUtc?e.getUTCFullYear():e.getFullYear();return 2===t?this.padNumber(i%100,2):String(i)},DateTimeFormat.prototype.format24Hours=function(t,e){var i=this.isUtc?e.getUTCHours():e.getHours();return this.padNumber(i,t)},DateTimeFormat.prototype.formatGMT=function(t,e){var i=e.getTimezoneOffset(),n=[];return i>0?n.push("GMT-"):(i=-i,n.push("GMT+")),n.push(this.padNumber(i/60,2)),n.push(":"),n.push(this.padNumber(i%60,2)),n.join("")},DateTimeFormat.prototype.format1To12Hours=function(t,e){var i=this.isUtc?e.getUTCHours():e.getHours();return this.padNumber((i+11)%12+1,t)},DateTimeFormat.prototype.formatEra=function(t,e){var i=this.isUtc?e.getUTCFullYear()>0?1:0:e.getFullYear()>0?1:0;return t>=4?this.symbols.ERANAMES[i]:this.symbols.ERAS[i]},DateTimeFormat.prototype.formatTimeZoneRFC=function(t,e){if(t<4){var i=e.getTimezoneOffset(),n="-";return i<0&&(i=-i,n="+"),i=i/3*5+i%60,n+this.padNumber(i,4)}return this.formatGMT(t,e)},DateTimeFormat.prototype.format0To23Hours=function(t,e){var i=this.isUtc?e.getUTCHours():e.getHours();return this.padNumber(i,t)},DateTimeFormat.prototype.formatFractionalSeconds=function(t,e){var i=e.getTime()%1e3/1e3;return String(i)},DateTimeFormat.prototype.formatAmPm=function(t,e){var i=this.isUtc?e.getUTCHours():e.getHours();return this.symbols.AMPMS[i>=12&&i<24?1:0]},DateTimeFormat.prototype.formatMinutes=function(t,e){var i=this.isUtc?e.getUTCMinutes():e.getMinutes();return this.padNumber(i,t)},DateTimeFormat.prototype.format0To11Hours=function(t,e){var i=this.isUtc?e.getUTCHours():e.getHours();return this.padNumber(i%12,t)},DateTimeFormat.prototype.formatStandaloneDay=function(t,e){var i=this.isUtc?e.getUTCDay():e.getDay();switch(t){case 5:return this.symbols.STANDALONENARROWWEEKDAYS[i];case 4:return this.symbols.STANDALONEWEEKDAYS[i];case 3:return this.symbols.STANDALONESHORTWEEKDAYS[i];default:return this.padNumber(i,1)}},DateTimeFormat.prototype.formatQuarter=function(t,e){var i=this.isUtc?e.getUTCMonth():e.getMonth(),n=Math.floor(i/3);return t<4?this.symbols.SHORTQUARTERS[n]:this.symbols.QUARTERS[n]},DateTimeFormat.prototype.format=function(t){for(var i=[],n=0,a=this.patternParts;n<a.length;n++){var r=a[n],o=r.text;e.FIELD===r.type?i.push(this.formatField(o,t)):i.push(o)}return i.join("")},DateTimeFormat.prototype.padNumber=function(t,e){for(var i=Math.floor(t),n=String(i),a="",r=0;r<Math.max(0,e-n.length);r++)a+="0";return a+i},DateTimeFormat.prototype.formatDayOfWeek=function(t,e){var i=this.isUtc?e.getUTCDay():e.getDay();return t>=4?this.symbols.WEEKDAYS[i]:this.symbols.SHORTWEEKDAYS[i]},DateTimeFormat}();t.DateTimeFormat=n}(t.locale||(t.locale={}))}(t.i18n||(t.i18n={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){!function(t){!function(t){!function(t){t[t.FULL_DATE_FORMAT=0]="FULL_DATE_FORMAT",t[t.LONG_DATE_FORMAT=1]="LONG_DATE_FORMAT",t[t.MEDIUM_DATE_FORMAT=2]="MEDIUM_DATE_FORMAT",t[t.SHORT_DATE_FORMAT=3]="SHORT_DATE_FORMAT",t[t.FULL_TIME_FORMAT=4]="FULL_TIME_FORMAT",t[t.LONG_TIME_FORMAT=5]="LONG_TIME_FORMAT",t[t.MEDIUM_TIME_FORMAT=6]="MEDIUM_TIME_FORMAT",t[t.SHORT_TIME_FORMAT=7]="SHORT_TIME_FORMAT",t[t.FULL_DATETIME_FORMAT=8]="FULL_DATETIME_FORMAT",t[t.LONG_DATETIME_FORMAT=9]="LONG_DATETIME_FORMAT",t[t.MEDIUM_DATETIME_FORMAT=10]="MEDIUM_DATETIME_FORMAT",t[t.SHORT_DATETIME_FORMAT=11]="SHORT_DATETIME_FORMAT"}(t.DateTimeFormats||(t.DateTimeFormats={}));var e=function(){function DateTimeLocale(){}return DateTimeLocale.getStandardDateTimeFormatter=function(e,i){void 0===i&&(i=!1);var n=new t.DateTimeFormat(i);return n.applyStandardPattern(e),n},DateTimeLocale.getResource=function(t){return DateTimeLocale.constantsRepository[t||DateTimeLocale.getLocale()]},DateTimeLocale.getDateTimeFormatter=function(e,i){void 0===i&&(i=!1);var n=new t.DateTimeFormat(i);return n.applyPattern(e),n},DateTimeLocale.standardFormatDateTime=function(e,i,n){void 0===n&&(n=!1);var a=new t.DateTimeFormat(n);return a.applyStandardPattern(e),a.format(i)},DateTimeLocale.getLocale=function(){return DateTimeLocale.activeLocale||(DateTimeLocale.activeLocale="en"),DateTimeLocale.activeLocale},DateTimeLocale.formatDateTime=function(e,i,n){void 0===n&&(n=!1);var a=new t.DateTimeFormat(n);return a.applyPattern(e),a.format(i)},DateTimeLocale.registerResource=function(t,e){DateTimeLocale.constantsRepository[e]=t,DateTimeLocale.activeLocale||(DateTimeLocale.activeLocale=e)},DateTimeLocale.setLocale=function(t){DateTimeLocale.activeLocale=t},DateTimeLocale.DATE_TIME_CONSTANTS="DateTimeConstants",DateTimeLocale.constantsRepository={},DateTimeLocale}();t.DateTimeLocale=e,t.DateTimeConstants.register(e.registerResource)}(t.locale||(t.locale={}))}(t.i18n||(t.i18n={}))}(t.google||(t.google={}))}(com||(com={})),function(t){!function(t){var e=function(){function Graphics(t){this.element=t,this._fill=!1,this._path=!1,this._pending=!1,this._sized=!1,this._thickness=1,this._color=0,this._alpha=1,this._ops=[]}return Graphics.initialize=function(){Graphics._blitCanvas=document.createElement("canvas"),Graphics._blitContext=Graphics._blitCanvas.getContext("2d")},Graphics.cleanupPending=function(){for(var t=Graphics._pending,e=0,i=t;e<i.length;e++){var n=i[e];n._pending&&(n._pending=!1,n.endFill(),n.endStroke())}t.length=0},Object.defineProperty(Graphics.prototype,"width",{get:function(){return this._maxx||0},enumerable:!0,configurable:!0}),Object.defineProperty(Graphics.prototype,"height",{get:function(){return this._maxy||0},enumerable:!0,configurable:!0}),Graphics.prototype.ensureCanvas=function(){if(!this._context){var t=document.createElement("canvas");t.width=t.height=0,this.element.appendChild(t),this._context=t.getContext("2d")}},Graphics.prototype.ensure=function(t,e){if(!isNaN(t)&&!isNaN(e)){this.ensureCanvas();var i=this._context,n=i.canvas,a=this._thickness/2||0,r=Math.floor(t-a),o=Math.ceil(t+a),s=Math.floor(e-a),l=Math.ceil(e-a);if(!this._sized)return this._minx=r,this._maxx=o,this._miny=s,this._maxy=l,n.style.left=this._minx+"px",n.style.top=this._miny+"px",this._sized=!0,i.lineWidth=this._thickness,i.lineCap=this._thickness>4?"round":"butt",void(i.strokeStyle=cssColor(this._color,this._alpha));if(!(this._minx<=r&&this._maxx>=o&&this._miny<=s&&this._maxy>=l)){var h=this._minx,c=this._miny;this._minx>r&&(this._minx=Math.floor(r),n.style.left=this._minx+"px"),this._maxx<o&&(this._maxx=Math.ceil(o)),this._miny>s&&(this._miny=Math.floor(s),n.style.top=this._miny+"px"),this._maxy<l&&(this._maxy=Math.ceil(l));var u=this._maxx-this._minx,d=this._maxy-this._miny,g=n.width,p=n.height;if(0===g||0===p)n.width=u+5,n.height=d+5;else{Graphics._blitCanvas.width<g&&(Graphics._blitCanvas.width=g),Graphics._blitCanvas.height<p&&(Graphics._blitCanvas.height=p);var v=i.globalCompositeOperation;i.globalCompositeOperation="copy",Graphics._blitContext.globalCompositeOperation="copy",Graphics._blitContext.drawImage(n,0,0),i.globalCompositeOperation=v,n.width=u+5,n.height=d+5,i.drawImage(Graphics._blitCanvas,0,0,g,p,h-this._minx,c-this._miny,g,p)}i.lineWidth=this._thickness,i.lineCap=this._thickness>4?"round":"butt",i.strokeStyle=cssColor(this._color,this._alpha)}}},Graphics.prototype.moveTo=function(t,e){var i=this;this.ensure(t,e),this.beginStroke(),this._ops.push(function(){i._context.moveTo(t-i._minx,e-i._miny)}),this._x=t,this._y=e},Graphics.prototype.lineTo=function(t,e){var i=this;this.ensure(t,e),this.beginStroke(),this._ops.push(function(){i._context.lineTo(t-i._minx,e-i._miny)}),this._x=t,this._y=e},Graphics.prototype.beginFill=function(t,e){var i=this;void 0===e&&(e=1),this.endFill(),this.endStroke(),this.ensureCanvas(),this._ops.push(function(){i._context.fillStyle=cssColor(t,e),i._context.beginPath()}),this._fill=!0},Graphics.prototype.endFill=function(){this._fill&&(this._fill=!1,this.flushOps(),this._context.fill(),this.endStroke())},Graphics.prototype.lineStyle=function(t,e,i){var n=this;void 0===i&&(i=1),t<0&&(t=0),i>1&&(i=1),this._fill&&this._path&&console.log("second lineStyle during fill"),this.endStroke(),this.ensureCanvas(),this._thickness!==t&&(this._thickness=t,this._ops.push(function(){n._context.lineWidth=t,n._context.lineCap=t>4?"round":"butt"})),this._alpha===i&&this._color===e||(this._alpha=i,this._color=e,this._ops.push(function(){n._context.strokeStyle=cssColor(e,i)}))},Graphics.prototype.flushOps=function(){for(var t=0,e=this._ops;t<e.length;t++){(0,e[t])()}this._ops.length=0},Graphics.prototype.beginStroke=function(){var t=this;if(!this._path&&!this._fill){this._path=!0,this.ensureCanvas();var e=this._x,i=this._y;this._ops.push(function(){t._context.beginPath(),t._context.moveTo(e-t._minx,i-t._miny)}),this._pending||(this._pending=!0,Graphics._pending.push(this))}},Graphics.prototype.endStroke=function(){this._path&&(this.flushOps(),this._path=!1,this._context.stroke())},Graphics.prototype.clear=function(){this._context&&(this._fill=!1,this._path=!1,this._ops.length=0,this._context.clearRect(0,0,this._context.canvas.width,this._context.canvas.height))},Graphics.prototype.drawRect=function(t,e,i,n){var a=this;this.ensure(t,e),this.ensure(t+i,e+n),this._fill?this._ops.push(function(){a._context.fillRect(t-a._minx,e-a._miny,i,n)}):this._ops.push(function(){a._context.rect(t-a._minx,e-a._miny,i,n)})},Graphics.prototype.drawRoundRect=function(t,e,i,n,a,r){this.drawRect(t,e,i,n)},Graphics._pending=[],Graphics}();t.Graphics=e}(t.display||(t.display={}))}(flash||(flash={})),function(t){!function(t){var e=function(){return function LoaderInfo(){}}();t.LoaderInfo=e}(t.display||(t.display={}))}(flash||(flash={})),function(t){!function(t){var e=function(t){function SimpleButton(e){var i=document.createElement("div");return t.call(this,i,e)||this}return __extends(SimpleButton,t),Object.defineProperty(SimpleButton.prototype,"overState",{get:function(){return this._overState},set:function(t){this._overState&&(this._overState.element.classList.remove("overState"),this.removeChild(this._overState)),this._overState=t,t&&(this._overState.element.classList.add("overState"),this.addChild(this._overState))},enumerable:!0,configurable:!0}),Object.defineProperty(SimpleButton.prototype,"downState",{get:function(){return this._downState},set:function(t){this._downState&&(this._downState.element.classList.remove("downState"),this.removeChild(this._downState)),this._downState=t,t&&(this._downState.element.classList.add("downState"),this.addChild(this._downState))},enumerable:!0,configurable:!0}),Object.defineProperty(SimpleButton.prototype,"hitTestState",{get:function(){return this._hitTestState},set:function(t){this._hitTestState&&(this._hitTestState.element.classList.remove("hitTestState"),this.removeChild(this._hitTestState)),this._hitTestState=t,t&&(this._hitTestState.element.classList.add("hitTestState"),this.addChild(this._hitTestState))},enumerable:!0,configurable:!0}),Object.defineProperty(SimpleButton.prototype,"upState",{get:function(){return this._upState},set:function(t){this._upState&&(this._upState.element.classList.remove("upState"),this.removeChild(this._upState)),this._upState=t,t&&(this._upState.element.classList.add("upState"),this.addChild(this._upState))},enumerable:!0,configurable:!0}),Object.defineProperty(SimpleButton.prototype,"useHandCursor",{get:function(){return this.element.classList.contains("handCursor")},set:function(t){this.element.classList.toggle("handCursor",t)},enumerable:!0,configurable:!0}),SimpleButton}(t.DisplayObjectContainer);t.SimpleButton=e}(t.display||(t.display={}))}(flash||(flash={})),function(t){!function(t){var e=function(){function StageAlign(){}return StageAlign.TOP_LEFT="top-left",StageAlign}();t.StageAlign=e;var i=function(){function StageScaleMode(){}return StageScaleMode.NO_SCALE="no-scale",StageScaleMode}();t.StageScaleMode=i;var n=function(e){function Stage(i){var n=e.call(this,i)||this;return t.Graphics.initialize(),n.stage=n,n.mouseEnabled=!1,window.addEventListener("resize",function(){n.element.dispatchEvent(new Event("resize"))}),n}return __extends(Stage,e),Object.defineProperty(Stage.prototype,"width",{get:function(){return this.stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(Stage.prototype,"height",{get:function(){return this.stageHeight},enumerable:!0,configurable:!0}),Object.defineProperty(Stage.prototype,"stageWidth",{get:function(){return this.element.clientWidth},enumerable:!0,configurable:!0}),Object.defineProperty(Stage.prototype,"stageHeight",{get:function(){return this.element.clientHeight},enumerable:!0,configurable:!0}),Object.defineProperty(Stage.prototype,"mouseX",{get:function(){return this._mouseX},enumerable:!0,configurable:!0}),Object.defineProperty(Stage.prototype,"mouseY",{get:function(){return this._mouseY},enumerable:!0,configurable:!0}),Stage.prototype.setMouse=function(t,e){var i=offsetOf(this.element);this._mouseX=t-i.left,this._mouseY=e-i.top},Stage.bind=function(e,i){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var r=Array.prototype.slice.call(arguments,2),o=function(){};function fBound(){var n=e.apply(this instanceof o?this:i,r.concat(Array.prototype.slice.call(arguments)));return t.Graphics.cleanupPending(),n}return this.prototype&&(o.prototype=this.prototype),fBound.prototype=new o,fBound},Stage}(t.DisplayObjectContainer);t.Stage=n}(t.display||(t.display={}))}(flash||(flash={})),function(t){!function(e){var i=function(){return function EventDispatcher(){}}();e.EventDispatcher=i;var n=function(){function EventDispatcherImpl(){this._events={}}return EventDispatcherImpl.prototype.addEventListener=function(t,e,i,n,a){(this._events[t]||(this._events[t]=[])).push(e)},EventDispatcherImpl.prototype.fire=function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var a=this._events[e];if(a)for(var r=0,o=a;r<o.length;r++){o[r].apply(null,i)}t.display.Graphics.cleanupPending()},EventDispatcherImpl}();e.EventDispatcherImpl=n}(t.events||(t.events={}))}(flash||(flash={})),function(t){!function(t){var e=function(){function ExternalInterface(){}return ExternalInterface.call=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];console.log.apply(console,arguments)},ExternalInterface.available=!0,ExternalInterface}();t.ExternalInterface=e}(t.external||(t.external={}))}(flash||(flash={})),function(t){!function(e){var i=function(){return function URLRequest(t){this.url=t}}();e.URLRequest=i;var n=function(t){function URLLoader(){return null!==t&&t.apply(this,arguments)||this}return __extends(URLLoader,t),URLLoader.prototype.load=function(t){var e=this,i=new XMLHttpRequest;i.onreadystatechange=function(){switch(i.readyState){case XMLHttpRequest.DONE:e.data=i.response,200===i.status&&e.fire(Events.COMPLETE,i)}},i.onerror=function(t){e.fire(IOErrorEvents.IO_ERROR,t)},i.open("GET",t.url,!0),i.send()},URLLoader}(t.events.EventDispatcherImpl);e.URLLoader=n}(t.net||(t.net={}))}(flash||(flash={})),function(t){!function(e){var i=function(){return function TimerEvent(){}}();e.TimerEvent=i;var n=function(t){function Timer(e){var i=t.call(this)||this;return i.period=e,i}return __extends(Timer,t),Timer.prototype.start=function(){var t=this;this.handle||(this.handle=setInterval(function(){var e=new i;t.fire(TimerEvents.TIMER,e)},this.period))},Timer.prototype.stop=function(){this.handle&&(clearInterval(this.handle),delete this.handle)},Timer}(t.events.EventDispatcherImpl);e.Timer=n}(t.utils||(t.utils={}))}(flash||(flash={})),function(t){!function(t){var e=function(){function NameUtil(){}return NameUtil.displayObjectToString=function(t){var e=null;try{for(var i=t;i&&(!i.parent||!i.stage||i.parent!==i.stage);){var n=i.name;e=e?n+"."+e:n,i=i.parent}}catch(t){}return e},NameUtil}();t.NameUtil=e}(t.utils||(t.utils={}))}(mx||(mx={}));
//# sourceMappingURL=GoogleChart.js.map
